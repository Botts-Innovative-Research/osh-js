(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{137:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u})),n.d(t,"h",(function(){return h}));Math.pow(2,53);function i(e){return null!=e}function a(e){return i(e)&&null!==e}function r(e,t){if(void 0===t&&(t="letiable"),!i(e))throw t+" must be defined";return e}function o(e,t,n){if(void 0===n&&(n="letiable"),r(e,n),typeof e!==t)throw n+" must be of type "+t;return e}function s(e,t){return o(e,"string",t)}function c(e,t){if(function(e,t){o(e,"number",t)}(e,t),e<=0)throw t+" must be a positive number"}function l(e,t){return o(e,"object",t)}function d(e,t){if(void 0===t&&(t="letiable"),r(e,t),!Array.isArray(e))throw t+" must be an array";return e}function u(e,t){return o(e,"function",t)}function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},150:function(e,t,n){"use strict";var i=n(238),a=n(137),r=new(function(){function e(){this.eventMap={}}var t=e.prototype;return t.remove=function(e,t){e in this.eventMap&&(this.eventMap[e]=this.eventMap[e].filter((function(e){return e.id!==t})))},t.removeById=function(e){for(var t in this.eventMap)this.eventMap[t]=this.eventMap[t].filter((function(t){return t.id!==e}))},t.observe=function(e,t,n){void 0===n&&(n="any"),Object(a.g)(e)&&Object(a.g)(t)&&Object(a.g)(n)&&(e in this.eventMap||(this.eventMap[e]=[]),this.eventMap[e].push({fn:t,id:n}))},t.fire=function(e,t){if(Object(a.g)(e)&&e in this.eventMap)for(var n=this.eventMap[e],i=0;i<n.length;i++)n[i].fn(t)},e}()),o=function(){function e(){}return e.remove=function(e,t){void 0===t&&(t="any"),r.remove("osh:"+e,t)},e.removeById=function(e){void 0===e&&(e="any"),r.removeById(e)},e.registerView=function(e){e.registerCallback()},e.unregisterView=function(e){e.unregisterCallback()},e.fire=function(e,t){t.name=e,r.fire("osh:"+e,t)},e.observe=function(e,t,n){void 0===n&&(n="any"),r.observe("osh:"+e,t,n)},e.observeDiv=function(e,t,n){document.getElementById(e).addEventListener(t,n)},Object(i.a)(e,null,[{key:"EVENT",get:function(){return{SELECT_VIEW:"selectView",SHOW_VIEW:"showView",UAV_TAKEOFF:"uav:takeoff",UAV_GOTO:"uav:goto",UAV_LOOKAT:"uav:lookat",UAV_LAND:"uav:land",UAV_ORBIT:"uav:orbit",LOADING_START:"loading:start",LOADING_STOP:"loading:stop",ADD_VIEW_ITEM:"addViewItem",RESIZE:"resize",PTZ_SEND_REQUEST:"ptzSendRequest"}}}]),e}();t.a=o},157:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var i="data-synchronizer-",a="datasource-data-"},184:function(e,t,n){e.exports=function(){return new Worker(n.p+"80a548c2c2e2e933c21e.worker.js")}},190:function(e,t,n){"use strict";var i=n(244),a=n(137),r=n(150),o=(n(47),n(157)),s="disconnected",c="data",l="status",d=function(){function e(e,t,n){this.stylers=[],this.viewItems=[],this.names={},this.stylerToObj={},this.stylerIdToStyler={},this.lastRec={},this.selectedDataSources=[],this.dataSources=[],this.viewItemsBroadcastChannels={},this.entity=null,this.id="view-"+Object(a.h)(),this.entity=null,this.dataSourceId=-1,Object(a.g)(n)&&Object(a.g)(n.dataSourceId)&&(this.dataSourceId=n.dataSourceId),Object(a.g)(n)&&Object(a.g)(n.entity)&&(this.entity=n.entity),this.css="",this.cssSelected="",Object(a.g)(n)&&Object(a.g)(n.css)&&(this.css=n.css),Object(a.g)(n)&&Object(a.g)(n.cssSelected)&&(this.cssSelected=n.cssSelected),this.init(e,t,n)}var t=e.prototype;return t.init=function(e,t,n){this.elementDiv=document.createElement("div"),this.elementDiv.setAttribute("id",this.id),this.elementDiv.setAttribute("class",this.css+" osh-view"),this.divId=this.id;var i=document.getElementById(e);if(Object(a.g)(i)&&null!==i?(i.appendChild(this.elementDiv),this.container=i):(document.body.appendChild(this.elementDiv),this.hide(),this.container=document.body),this.beforeAddingItems(n),Object(a.g)(t))for(var r=0;r<t.length;r++)this.addViewItem(t[r]);Object(a.g)(n)&&Object(a.g)(n.show)&&(document.getElementById(this.divId).style.display=n.show?"block":"none"),this.handleEvents();var o=this;this.registerCallback(),new MutationObserver((function(e){e.forEach((function(e){"style"===e.attributeName&&o.onResize()}))})).observe(this.elementDiv,{attributes:!0}),new MutationObserver((function(e){Object(a.g)(document.getElementById(o.divId))||(this.disconnect(),o.destroy())})).observe(document.body,{childList:!0})},t.registerCallback=function(){if(Object(a.g)(this.dataSourceId)||Object(a.g)(this.entity)){var e=this;function t(t){new BroadcastChannel(o.a+t).onmessage=function(n){n.data.message&&"reset"===n.data.message?e.reset():n.data.type===c?e.setData(t,n.data.values):n.data.type===l&&n.data.status===s&&e.reset()}}if(null!==this.entity)for(var n,r=Object(i.a)(this.entity.getDataSources());!(n=r()).done;){t(n.value.id)}else t(this.dataSourceId)}},t.unregisterCallback=function(){r.a.removeById(this.divId)},t.hide=function(){this.elementDiv.style.display="none"},t.onResize=function(){},t.attachTo=function(e){Object(a.g)(this.elementDiv.parentNode)&&this.elementDiv.parentNode.removeChild(this.elementDiv),document.getElementById(e).appendChild(this.elementDiv),"none"===this.elementDiv.style.display&&(this.elementDiv.style.display="block"),this.onResize()},t.beforeAddingItems=function(e){},t.getId=function(){return this.id},t.getDivId=function(){return this.divId},t.setData=function(e,t){},t.show=function(e){},t.destroy=function(){this.unregisterCallback()},t.addViewItem=function(e){var t=this;this.viewItems.push(e),e.hasOwnProperty("styler")&&function(){var n=e.styler;t.stylers.push(n),e.hasOwnProperty("name")&&(t.names[n.getId()]=e.name),n.viewItem=e,n.init(t),t.stylerIdToStyler[n.id]=n;for(var i=n.getDataSourcesIds(),d=function(d){var u=i[d],h=t,f=new BroadcastChannel(o.a+u);t.viewItemsBroadcastChannels[u]=f,f.onmessage=function(t){if(t.data.type!==l||t.data.status!==s){var i=!1;i=Object(a.g)(h.selectedEntity)?e.entityId===h.selectedEntity:h.selectedDataSources.indexOf(u)>-1,t.data.type===c&&(n.setData(u,t.data,h,{selected:i}),h.lastRec[u]=t.data)}},r.a.observe(r.a.EVENT.SELECT_VIEW,(function(t){var i=!1;i=Object(a.g)(t.entityId)?e.entityId===t.entityId:t.dataSourcesIds.indexOf(u)>-1,u in h.lastRec&&n.setData(u,h.lastRec[u],h,{selected:i})}),t.divId)},u=0;u<i.length;u++)d(u)}()},t.removeViewItem=function(e){if(this.viewItems.includes(e)){for(var t in e.styler.dataSourceToStylerMap)this.viewItemsBroadcastChannels[t].close(),delete this.viewItemsBroadcastChannels[t],delete this.lastRec[t];this.viewItems=this.viewItems.filter((function(t){return t!==e}))}delete this.stylerIdToStyler[e.styler.id],this.stylers=this.stylers.filter((function(t){return t.id!==e.styler.id})),delete this.names[e.styler.id],delete this.stylerToObj[e.styler.id]},t.removeViewItems=function(){for(var e,t=Object(i.a)(this.viewItems);!(e=t()).done;){var n=e.value;this.removeViewItem(n)}},t.handleEvents=function(){var e=this;r.a.observe(r.a.EVENT.SELECT_VIEW,(function(t){return e.selectDataView(t.dataSourcesIds,t.entityId)}),this.divId),r.a.observe(r.a.EVENT.SHOW_VIEW,(function(t){return e.show(t)}),this.divId),r.a.observe(r.a.EVENT.ADD_VIEW_ITEM,(function(t){Object(a.g)(t.viewId)&&t.viewId===e.id&&e.addViewItem(t.viewItem)}),this.divId),r.a.observe(r.a.EVENT.RESIZE+"-"+this.divId,(function(t){return e.onResize()}),this.divId)},t.selectDataView=function(e,t){if(Object(a.g)(this.dataSources)){this.selectedDataSources=e,this.selectedEntity=t;for(var n=0;n<this.dataSources.length;n++)this.setData(this.dataSources[n],this.lastRec[this.dataSources[n]])}},t.getDataSourcesId=function(){var e=[];-1!==this.dataSourceId&&e.push(this.dataSourceId);for(var t=0;t<this.viewItems.length;t++){var n=this.viewItems[t];if(n.hasOwnProperty("styler")){var i=n.styler;e=e.concat(i.getDataSourcesIds())}}return e},t.reset=function(){},e}();t.a=d},191:function(e,t,n){"use strict";var i=n(3),a=n(235),r=n.n(a),o=n(236),s=n(137),c=n(157),l=function(){function e(e,t,n){this.id="DataSource-"+Object(s.h)(),this.name=e,this.properties=Object.assign({fetch:1},t),this.dataSourceWorker=n,this.dataSynchronizer=null,this.currentRunningProperties={},this.initDataSource(t)}var t=e.prototype;return t.initDataSource=function(e){this.dataSourceWorker.postMessage({message:"init",id:this.id,properties:JSON.stringify(e),topic:c.a+this.id})},t.setDataSynchronizer=function(e){this.dataSynchronizer=e,this.dataSourceWorker.postMessage({message:"topic",topic:c.b+this.dataSynchronizer.id})},t.setTimeRange=function(e,t,n){this.updateUrl(Object.assign({},this.currentRunningProperties,{startTime:e,endTime:t,replaySpeed:n}))},t.getStartTime=function(){return this.properties.startTime},t.getEndTime=function(){return this.properties.endTime},t.getReplaySpeed=function(){return Object(s.g)(this.properties.replaySpeed)?this.properties.replaySpeed:1},t.disconnect=function(){this.dataSourceWorker.postMessage({message:"disconnect"})},t.connect=function(){this.dataSourceWorker.postMessage({message:"connect"})},t.isConnected=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise((function(e){null!==n.dataSourceWorker&&(n.dataSourceWorker.onmessage=function(t){"is-connected"===t.data.message&&e(t.data.data)})})),null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"is-connected"}),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getCurrentTime=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(s.g)(this.dataSynchronizer)){e.next=4;break}return e.abrupt("return",this.dataSynchronizer.getCurrentTime());case 4:return t=new Promise((function(e){null!==n.dataSourceWorker&&(n.dataSourceWorker.onmessage=function(t){"last-timestamp"===t.data.message&&e(t.data.data)})})),null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"last-timestamp"}),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.getId=function(){return this.id},t.getName=function(){return this.name},t.updateUrl=function(e){this.currentRunningProperties=Object.assign({},this.properties,e),null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"update-url",data:e})},t.getCurrentRunningProperties=function(){return this.currentRunningProperties},t.terminate=function(){null!==this.dataSourceWorker&&this.dataSourceWorker.terminate()},e}(),d=n(184),u=n.n(d),h=function(e){function t(t,n){return e.call(this,t,Object.assign({timeShift:0,reconnectTimeout:5e3},n),new u.a)||this}return Object(i.a)(t,e),t}(l);t.a=h},192:function(e,t,n){"use strict";var i=n(237),a=n(3),r=n(137),o=n(150),s=function(e){function t(t){var n;(n=e.call(this,t)||this).properties=t,n.location=null,n.orientation={heading:0},n.icon=null,n.iconAnchor=[16,16],n.iconSize=[16,16],n.label=null,n.labelColor="#000000",n.labelSize=16,n.labelOffset=[0,0],n.zoomLevel=15,n.color=null,n.defaultToTerrainElevation=!1,n.options={},Object(r.g)(t.defaultToTerrainElevation)&&(n.defaultToTerrainElevation=t.defaultToTerrainElevation),Object(r.f)(t.location)&&(Object(r.c)(t.location,"location"),n.location=t.location),Object(r.f)(t.orientation)&&(Object(r.c)(t.orientation,"orientation"),n.orientation=t.orientation),Object(r.f)(t.icon)&&(Object(r.e)(t.icon,"icon"),n.icon=t.icon),Object(r.f)(t.iconAnchor)&&(Object(r.a)(t.iconAnchor,"iconAnchor"),n.iconAnchor=t.iconAnchor),Object(r.f)(t.iconSize)&&(Object(r.a)(t.iconSize,"iconSize"),n.iconSize=t.iconSize),Object(r.f)(t.label)&&(Object(r.e)(t.label,"label"),n.label=t.label),Object(r.f)(t.labelColor)&&(Object(r.e)(t.labelColor,"labelColor"),n.labelColor=t.labelColor),Object(r.f)(t.labelSize)&&(Object(r.d)(t.labelSize,"labelSize"),n.labelSize=t.labelSize),Object(r.f)(t.labelOffset)&&(Object(r.a)(t.labelOffset,"labelOffset"),n.labelOffset=t.labelOffset),Object(r.f)(t.zoomLevel)&&(Object(r.d)(t.zoomLevel,"zoomLevel"),n.zoomLevel=t.zoomLevel);var a=Object(i.a)(n);if(n.checkFn("locationFunc")){n.addFn(t.locationFunc.dataSourceIds,(function(e,n,i){a.location=t.locationFunc.handler(e,n,i)}))}if(n.checkFn("orientationFunc")){n.addFn(t.orientationFunc.dataSourceIds,(function(e,n,i){a.orientation=t.orientationFunc.handler(e,n,i)}))}if(n.checkFn("iconFunc")){n.addFn(t.iconFunc.dataSourceIds,(function(e,n,i){a.icon=t.iconFunc.handler(e,n,i)}))}if(n.checkFn("labelFunc")){n.addFn(t.labelFunc.dataSourceIds,(function(e,n,i){a.label=t.labelFunc.handler(e,n,i)}))}if(n.checkFn("labelColorFunc")){n.addFn(t.labelColorFunc.dataSourceIds,(function(e,n,i){a.labelColor=t.labelColorFunc.handler(e,n,i)}))}if(n.checkFn("labelSizeFunc")){n.addFn(t.labelSizeFunc.dataSourceIds,(function(e,n,i){a.labelSize=t.labelSizeFunc.handler(e,n,i)}))}return n}Object(a.a)(t,e);var n=t.prototype;return n.init=function(t){e.prototype.init.call(this,t),Object(r.g)(t)&&null!==this.location&&t.updateMarker(this,0,{})},n.setData=function(t,n,i,a){return!(!e.prototype.setData.call(this,t,n,i,a)||!Object(r.g)(i)||null===this.location)&&(i.updateMarker(this,n.timeStamp,a),!0)},t}(function(){function e(e){this.properties=e,this.id="styler-"+Object(r.h)(),this.dataSourceToStylerMap={},this.initEvents()}var t=e.prototype;return t.checkFn=function(e){var t=this.properties[e],n=Object(r.f)(t);return n&&(Object(r.a)(t.dataSourceIds,e+".dataSourceIds"),Object(r.b)(t.handler,e+".handler")),n},t.initEvents=function(){var e=this;o.a.observe(o.a.EVENT.DATASOURCE_UPDATE_TIME,(function(t){return e.clear()}))},t.clear=function(){},t.getId=function(){return this.id},t.select=function(e){},t.addFn=function(e,t){for(var n=0;n<e.length;n++){var i=e[n];Object(r.g)(this.dataSourceToStylerMap[i])||(this.dataSourceToStylerMap[i]=[]),this.dataSourceToStylerMap[i].push(t)}},t.setData=function(e,t,n,i){if(e in this.dataSourceToStylerMap){for(var a=this.dataSourceToStylerMap[e],r=0;r<a.length;r++)for(var o=0;o<t.values.length;o++)a[r](t.values[o].data,t.values[o].timeStamp,i);return!0}return!1},t.getDataSourcesIds=function(){var e=[];for(var t in this.dataSourceToStylerMap)e.push(t);return e},t.init=function(){},e}());t.a=s},307:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=307},387:function(e,t,n){"use strict";n.r(t);var i=n(3),a=n(0),r=n(191),o=n(192),s=n(190),c=n(137),l=n(150),d=n(381),u=(n(119),function(e){function t(t,n,i){var a;a=e.call(this,t,n,i)||this;var r=document.getElementById(a.divId).className;return document.getElementById(a.divId).setAttribute("class",r+" "+a.css),a.imageDrapingPrimitive=null,a.imageDrapingPrimitiveReady=!1,a.frameCount=0,a.captureCanvas=document.createElement("canvas"),a.captureCanvas.width=640,a.captureCanvas.height=480,a}Object(i.a)(t,e);var n=t.prototype;return n.updateMarker=function(e,t,n){var i=0;e.getId()in this.stylerToObj?i=this.stylerToObj[e.getId()]:(i=this.addMarker({lat:e.location.y,lon:e.location.x,alt:e.location.z,orientation:e.orientation,icon:e.icon,iconAnchor:e.iconAnchor,label:e.label,labelColor:e.labelColor,labelSize:e.labelSize,labelOffset:e.labelOffset,name:e.viewItem.name,description:e.viewItem.description,timeStamp:t,selected:void 0!==n.selected&&n.selected}),this.stylerToObj[e.getId()]=i),this.updateMapMarker(i,{lat:e.location.y,lon:e.location.x,alt:e.location.z,orientation:e.orientation,icon:e.icon,label:e.label,labelColor:e.labelColor,labelSize:e.labelSize,timeStamp:t,defaultToTerrainElevation:e.defaultToTerrainElevation,selected:void 0!==n.selected&&n.selected})},n.updateDrapedImage=function(e,t,n,i){var a=e.platformLocation,r=d.b.fromDegrees(a.x,a.y,a.z),o=d.o.PI/180,s=e.platformOrientation,c=e.gimbalOrientation,l=d.v.northEastDownToFixedFrame(r),u=new d.p;d.q.getMatrix3(l,u);var h=new d.p,f=d.p.fromRotationZ(s.heading*o,h);d.p.multiply(u,f,u);var m=d.p.fromRotationY(s.pitch*o,h);d.p.multiply(u,m,u);var v=d.p.fromRotationX(s.roll*o,h);d.p.multiply(u,v,u);var p=d.p.fromRotationZ(c.heading*o,h);d.p.multiply(u,p,u);var b=d.p.fromRotationX(c.roll*o,h);d.p.multiply(u,b,u);var g=d.p.fromRotationY((90+c.pitch)*o,h);d.p.multiply(u,g,u);var y=d.p.fromRotationZ(90*o,h);d.p.multiply(u,y,u);var w=e.cameraModel.camProj,O=e.cameraModel.camDistR,S=e.cameraModel.camDistT,I=e.imageSrc;i&&(this.captureCanvas.getContext("2d").drawImage(I,0,0,this.captureCanvas.width,this.captureCanvas.height),I=this.captureCanvas);var E=d.g.fromCartesian(r),T=new d.n({material:new d.m({fabric:{type:"Image",uniforms:{image:I,camPosHigh:E.high,camPosLow:E.low,camAtt:d.p.toArray(d.p.transpose(u,new d.p)),camProj:d.p.toArray(w),camDistR:O,camDistT:S}}}),vertexShaderSource:"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\n\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}",fragmentShaderSource:"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\n\nvec4 windowToEye(vec4 fragCoord)\n{\n    vec2 uv = fragCoord.xy / czm_viewport.zw;\n    float z_window = czm_unpackDepth(texture2D(czm_globeDepthTexture, uv));\n\n    if (z_window == 0.0)\n        discard;\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord.xy, z_window);\n\n    return eyeCoordinate / eyeCoordinate.w;\n}\n\n// Camera model and frames are based on OpenCV conventions:\n// http://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html\n// we pass in a normalized intrinsic matrix as uniform so we can compute the normalized texture coordinates directly\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    // get fragment 3D pos in eye coordinates using depth buffer value at fragment location\n    vec4 v_posEC = windowToEye(gl_FragCoord);\n\n    // translate to video cam frame\n    vec4 camPosEC = czm_modelViewRelativeToEye * czm_translateRelativeToEye(camPosHigh_1, camPosLow_2);\n    vec4 v_posCam = v_posEC - camPosEC;\n\n    // rotate to video cam frame\n    vec3 lookRay = camAtt_3 * czm_inverseViewRotation3D * v_posCam.xyz;\n\n    // discard if behind camera\n    if (lookRay.z < 0.1)\n        discard;\n\n    // undistort\n    float xn = lookRay.x / lookRay.z;\n    float yn = lookRay.y / lookRay.z;\n    float k1 = camDistR_5[0];\n    float k2 = camDistR_5[1];\n    float k3 = camDistR_5[2];\n    float p1 = camDistT_6[0];\n    float p2 = camDistT_6[1];\n\n    float r2 = xn * xn+ yn * yn;\n    float r4 = r2 * r2;\n    float r6 = r4 * r2;\n    float xd = xn * (1. + k1 * r2 + k2 * r4 + k3 * r6) + 2. * p1 * xn * yn + p2 * (r2 + 2. * xn * xn);\n    float yd = yn * (1. + k1 * r2 + k2 * r4 + k3 * r6) + 2. * p2 * xn * yn + p1 * (r2 + 2. * yn * yn);\n\n    // project with pinhole model\n    vec3 st = camProj_4 * vec3(xd, yd, 1.);\n    st.y = 1.0 - st.y;\n\n    if (st.x < 0.0 || st.x > 1.0 || st.y < 0.0 || st.y > 1.0)\n        discard;\n\n    // get color from material\n    czm_materialInput materialInput;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = vec2(st.x, st.y);\n    czm_material material = czm_getMaterial(materialInput);\n    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n\n    //float depth = pow(v_posEC.z * 0.5 + 0.5, 8.0);\n    //gl_FragColor = vec4(depth, depth, depth, 1.0);\n}"});if(null===this.imageDrapingPrimitive||i){null===this.imageDrapingPrimitive&&(this.imageDrapingPrimitive={});var D=Object(d.C)(this.viewer.terrainProvider,11,[d.c.fromDegrees(a.x,a.y)]),C=this;Object(d.D)(D,(function(e){var t=C.viewer.scene.primitives.add(new d.s({geometryInstances:new d.h({geometry:new d.u({rectangle:d.t.fromDegrees(a.x-.1,a.y-.1,a.x+.1,a.y+.1),height:e[0].height,extrudedHeight:a.z-1})}),appearance:T}));i||(C.imageDrapingPrimitive=t),C.viewer.scene.primitives.raiseToTop(C.imageDrapingPrimitive),C.imageDrapingPrimitiveReady=!0}))}else this.imageDrapingPrimitiveReady&&(this.imageDrapingPrimitive.appearance=T);this.frameCount++},n.beforeAddingItems=function(e){this.markers={},this.first=!0;var t=Object(d.z)();this.viewer=new d.x(this.divId,{baseLayerPicker:!0,imageryProviderViewModels:t,selectedImageryProviderViewModel:t[6],timeline:!1,homeButton:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,geocoder:!0,fullscreenButton:!1,showRenderLoopErrors:!0,animation:!1,scene3DOnly:!0}),this.viewer.terrainProvider=new d.f,this.viewer.scene.copyGlobeDepth=!0,this.viewer.scene._environmentState.useGlobeDepthFramebuffer=!0;var n=this;d.B.getObservable(this.viewer,"_selectedEntity").subscribe(function(e){if(Object(d.A)(e)){var t,i=[];for(var a in n.stylerToObj)if(n.stylerToObj[a]===e._dsid)for(var r=0;r<n.stylers.length;r++)if(n.stylers[r].getId()===a){i=i.concat(n.stylers[r].getDataSourcesIds()),t=n.stylers[r].viewItem.entityId;break}l.a.fire(l.a.EVENT.SELECT_VIEW,{dataSourcesIds:i,entityId:t})}else l.a.fire(l.a.EVENT.SELECT_VIEW,{dataSourcesIds:[],entityId:null})}.bind(this))},n.removeViewItem=function(t){var n=this.stylerToObj[t.styler.id];if(e.prototype.removeViewItem.call(this,t),Object(c.g)(n)){var i=this.markers[n];Object(c.g)(i)&&this.viewer.entities.remove(i),delete this.markers[n]}},n.addMarker=function(e){var t="images/cameralook.png";null!==e.icon&&(t=e.icon);var n,i=t.endsWith(".glb"),a=e.hasOwnProperty("label")&&null!=e.label?e.label:null,r=e.labelColor,o=e.labelSize,s=new d.a(-e.iconAnchor[0],-e.iconAnchor[1]),l=new d.a(e.labelOffset[0],e.labelOffset[1]),u=e.hasOwnProperty("name")&&null!=e.name?e.name:null!=a?a:"Selected Marker",h=e.hasOwnProperty("description")&&null!=e.description?e.description:null,f=e.hasOwnProperty("color")&&Object(c.g)(e.color)?d.d.fromCssColorString(e.color):d.d.YELLOW;if(i)n={name:u,description:h,position:d.b.fromDegrees(0,0,0),label:{text:a,font:o+"px sans-serif",scaleByDistance:new d.r(150,1,1e6,0),fillColor:d.d.fromCssColorString(r),horizontalOrigin:d.l.CENTER,verticalOrigin:d.w.TOP,pixelOffset:l},model:{uri:t,scale:4,modelM:d.q.IDENTITY.clone(),color:f}};else{var m=0;"undefined"!==e.orientation&&(m=e.orientation.heading),n={name:u,description:h,position:d.b.fromDegrees(0,0,0),label:{text:a,font:o+"px sans-serif",scaleByDistance:new d.r(150,1,1e6,0),fillColor:d.d.fromCssColorString(r),horizontalOrigin:d.l.CENTER,verticalOrigin:d.w.TOP,pixelOffset:l,pixelOffsetScaleByDistance:new d.r(150,1,1e6,0)},billboard:{image:t,scaleByDistance:new d.r(1e3,1,1e7,0),alignedAxis:d.b.UNIT_Z,rotation:d.o.toRadians(m),horizontalOrigin:d.l.LEFT,verticalOrigin:d.w.TOP,pixelOffset:s,pixelOffsetScaleByDistance:new d.r(1e3,1,1e7,0),eyeOffset:new d.b(0,0,-1)}}}e.hasOwnProperty("description")&&(n.description=e.description);var v=this.viewer.entities.add(n),p="view-marker-"+Object(c.h)();return v._dsid=p,this.markers[p]=v,p},n.updateMapMarker=function(e,t){var n=t.lon,i=t.lat,a=t.alt,r=t.orientation,o=t.labelColor,s=t.icon,l=t.label,u=t.defaultToTerrainElevation;if(!isNaN(n)&&!isNaN(i)){var h=this.markers[e];(Object(c.g)(a)||isNaN(a))&&(a=this.getAltitude(i,n))>1&&(a+=.3);var f=d.b.fromDegrees(n,i,a);if(h.position=f,Object(c.g)(r)){var m=d.o.PI/180,v=r.heading,p=d.v.headingPitchRollQuaternion(f,new d.j(v*m,0,0*m));h.orientation=p,h.billboard&&(h.billboard.rotation=d.o.toRadians(v))}Object(c.g)(l)&&(h.label.text=l),Object(c.g)(o)&&(h.label.fillColor=d.d.fromCssColorString(o)),h.billboard?(u&&(h.billboard.heightReference=d.k.CLAMP_TO_GROUND),h.billboard.image=s):h.model&&(u&&(h.model.heightReference=d.k.CLAMP_TO_GROUND),h.model.uri=s),h.billboard&&(this.viewer.camera.pitch<-d.o.PI/4?h.billboard.alignedAxis=d.b.UNIT_Z:h.billboard.alignedAxis=d.b.ZERO),this.first&&(this.viewer.zoomTo(this.viewer.entities,new d.i(d.o.toRadians(0),d.o.toRadians(-90),2e3)),this.first=!1),t.selected&&(this.viewer.selectedEntity=h)}},n.getAltitude=function(e,t){var n=d.b.fromDegrees(t,e,0,this.viewer.scene.globe.ellipsoid,new d.b),i=this.viewer.scene.globe.getHeight(d.e.WGS84.cartesianToCartographic(n));return("undefined"===i||i<=0)&&(i=.1),i},n.addImageryProvider=function(e,t,n,i,a){var r,o,s=0;return a.hasOwnProperty("minLOD")&&(s=a.minLOD),a.hasOwnProperty("maxLOD")&&(r=a.maxLOD),"wms"===e&&(o=new d.y({url:t,layers:n,minimumLevel:s,maximumLevel:r,parameters:{transparent:"true",format:"image/"+i}})),this.viewer.imageryLayers.addImageryProvider(o),o},t}(s.a)),h=function(e){function t(t){var n;return(n=e.call(this,t)||this).divId=Object(c.h)(),window.CESIUM_BASE_URL="../../../",n}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.dataSource=new r.a("android-GPS",{protocol:"ws",service:"SOS",endpointUrl:"sensiasoft.net:8181/sensorhub/sos",offeringID:"urn:android:device:060693280a28e015-sos",observedProperty:"http://sensorml.com/ont/swe/property/Location",startTime:"2015-02-16T07:58:32Z",endTime:"2015-02-16T08:09:00Z",replaySpeed:2});var e=new o.a({locationFunc:{dataSourceIds:[this.dataSource.getId()],handler:function(e){return{x:e.location.lon,y:e.location.lat}}},orientation:{heading:0},icon:this.props.base+"img/car-location.png",iconAnchor:[16,64],iconSize:[32,64]});this.view=new u("cesium-single-map",[{styler:e,name:"Android Phone GPS"}],{autoZoomOnFirstMarker:!0}),this.view.viewer.terrainProvider=new d.f,this.dataSource.connect()},n.componentWillUnmount=function(){this.dataSource.terminate(),this.view.destroy()},n.render=function(){return a.createElement("div",{style:{height:"500px"},id:"cesium-single-map"})},t}(a.Component);t.default=h},425:function(e,t){},427:function(e,t){}}]);