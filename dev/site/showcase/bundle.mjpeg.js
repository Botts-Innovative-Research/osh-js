!function(e){var t={};function r(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){e.exports=function(){return new Worker(r.p+"WorkerName.61c6e6fdff4e49e7d2c6.js")}},function(e,t,r){var s=r(2),i=r(3);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var n={insert:"head",singleton:!1},a=(s(i,n),i.locals?i.locals:{});e.exports=a},function(e,t,r){"use strict";var s,i=function(){return void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s},n=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),a=[];function o(e){for(var t=-1,r=0;r<a.length;r++)if(a[r].identifier===e){t=r;break}return t}function d(e,t){for(var r={},s=[],i=0;i<e.length;i++){var n=e[i],d=t.base?n[0]+t.base:n[0],c=r[d]||0,u="".concat(d," ").concat(c);r[d]=c+1;var l=o(u),h={css:n[1],media:n[2],sourceMap:n[3]};-1!==l?(a[l].references++,a[l].updater(h)):a.push({identifier:u,updater:g(h,t),references:1}),s.push(u)}return s}function c(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var i=r.nc;i&&(s.nonce=i)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var a=n(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,l=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function h(e,t,r,s){var i=r?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=l(t,i);else{var n=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(n,a[t]):e.appendChild(n)}}function p(e,t,r){var s=r.css,i=r.media,n=r.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),n&&btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var m=null,f=0;function g(e,t){var r,s,i;if(t.singleton){var n=f++;r=m||(m=c(t)),s=h.bind(null,r,n,!1),i=h.bind(null,r,n,!0)}else r=c(t),s=p.bind(null,r,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var r=d(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<r.length;s++){var i=o(r[s]);a[i].references--}for(var n=d(e,t),c=0;c<r.length;c++){var u=o(r[c]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}r=n}}}},function(e,t,r){(t=r(4)(!1)).push([e.i,".osh-view {\n    width:100%;\n    height: 100%;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",s=e[3];if(!s)return r;if(t&&"function"==typeof btoa){var i=(a=s,o=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(d," */")),n=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[r].concat(n).concat([i]).join("\n")}var a,o,d;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,s){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(s)for(var n=0;n<this.length;n++){var a=this[n][0];null!=a&&(i[a]=!0)}for(var o=0;o<e.length;o++){var d=[].concat(e[o]);s&&i[d[0]]||(r&&(d[2]?d[2]="".concat(r," and ").concat(d[2]):d[2]=r),t.push(d))}},t}},function(e,t,r){"use strict";r.r(t);Math.pow(2,53);function s(e){return null!=e}function i(e){return s(e)&&null!==e}function n(e,t){return i(e)&&typeof e===t}function a(e,t="letiable"){if(!s(e))throw t+" must be defined";return e}function o(e,t="letiable"){if(!s(e)||!e)throw t;return e}function d(e,t,r="letiable"){if(a(e,r),typeof e!==t)throw r+" must be of type "+t;return e}function c(e,t="letiable"){if(a(e,t),!Array.isArray(e))throw t+" must be an array";return e}function u(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}const l="disconnected";var h=class{constructor(e,t,r){this.id="DataSource-"+u(),this.name=e,this.properties=t,this.dataSourceWorker=r,this.currentRunningProperties={},this.initDataSource(t)}initDataSource(e){this.dataSourceWorker.postMessage({message:"init",id:this.id,properties:JSON.stringify(e),topic:this.getTopicId()})}disconnect(){this.dataSourceWorker.postMessage({message:"disconnect"})}onDisconnect(){return new Promise(e=>{new BroadcastChannel(this.getTopicId()).onmessage=t=>{t.data.status===l&&e()}})}async connect(){return this.dataSourceWorker.postMessage({message:"connect"}),this.isConnected()}async isConnected(){const e=new Promise(e=>{null!==this.dataSourceWorker&&(this.dataSourceWorker.onmessage=t=>{"is-connected"===t.data.message&&e(t.data.data)})});return null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"is-connected"}),e}getId(){return this.id}getName(){return this.name}updateProperties(e){this.currentRunningProperties={...this.properties,...e},null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"update-url",data:e})}getCurrentRunningProperties(){return this.currentRunningProperties}terminate(){null!==this.dataSourceWorker&&this.dataSourceWorker.terminate()}getTopicId(){return"datasource-data-"+this.id}};var p=class extends h{constructor(e,t,r){super(e,t,r),a(t,"Some properties must be defined"),a(t.startTime,"startTime must must be defined"),a(t.endTime,"startTime must must be defined"),this.timeSync=null}setDataSynchronizer(e){this.timeSync=e,this.dataSourceWorker.postMessage({message:"topic",topic:"data-synchronizer-"+this.timeSync.id,timeTopic:this.getTimeTopicId()})}initDataSource(e){super.initDataSource(e),this.dataSourceWorker.postMessage({message:"topic",topic:this.getTopicId(),timeTopic:this.getTimeTopicId()})}setTimeRange(e,t,r,i=!1){let n={};s(r)&&(n={replaySpeed:r}),this.updateProperties({...this.currentRunningProperties,startTime:e,endTime:t,...n,reconnect:i})}getStartTime(){return this.properties.startTime}getEndTime(){return this.properties.endTime}getMinTime(){return this.properties.minTime}getMaxTime(){return this.properties.maxTime}getReplaySpeed(){return s(this.properties.replaySpeed)?this.properties.replaySpeed:1}async getCurrentTime(){if(s(this.timeSync))return this.timeSync.getCurrentTime();{const e=new Promise(e=>{null!==this.dataSourceWorker&&(this.dataSourceWorker.onmessage=t=>{"last-timestamp"===t.data.message&&e(t.data.data)})});return null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"last-timestamp"}),e}}updateProperties(e){super.updateProperties(e)}getTimeTopicId(){return"datasource-time-"+this.id}},m=r(0),f=r.n(m);var g=class extends p{constructor(e,t){super(e,{timeShift:0,reconnectTimeout:5e3,...t},new f.a)}};r(1);const y="data",v="status";var S=class{constructor(e){this.properties=e,this.dataSourcesToFn=void 0,this.data=[],this.props={},this.props.id="layer-"+u(),this.props.name="",this.props.description="",this.props.dataSourceId="",s(e.name)&&(this.props.name=e.name),s(e.description)&&(this.props.description=e.description),s(e.dataSourceId)&&(this.props.dataSourceId=e.dataSourceId),this.initEvents()}saveState(){this.initialState={...this.props}}restoreState(){this.props={...this.initialState}}getFunc(e){return this.properties[e].handler||this.properties[e]}checkFn(e){let t=this.properties[e];if(n(t,"function"))return a(this.properties.dataSourceId,"dataSourceId"),!0;{let r=i(t);return r&&(c(t.dataSourceIds,e+".dataSourceIds"),function(e,t){d(e,"function",t)}(t.handler,e+".handler")),r}}initEvents(){}clear(){}getId(){return this.id}select(e){}addFn(e,t){s(this.dataSourcesToFn)||(this.dataSourcesToFn={});for(let r=0;r<e.length;r++){let i=e[r];s(this.dataSourcesToFn[i])||(this.dataSourcesToFn[i]=[]),this.dataSourcesToFn[i].push(t)}}setData(e,t,r){if(this.data=[],e in this.dataSourcesToFn){let s=this.dataSourcesToFn[e];for(let e=0;e<t.length;e++){for(let i=0;i<s.length;i++)s[i](t[e].data,t[e].timeStamp,r);this.data.push({...this.props})}}}getDataSourcesIds(){if(s(this.dataSourcesToFn)){let e=[];for(let t in this.dataSourcesToFn)e.push(t);return e}return a(this.properties.dataSourceId,"dataSourceId must be defined"),[this.properties.dataSourceId]}getDataSourcesIdsByProperty(e){return this.properties[e].dataSourceIds||[this.properties.dataSourceId]}init(){}getProps(){return{type:this.type,values:this.data}}reset(){this.restoreState()}};var b=class extends S{constructor(e){super(e),this.type="data"}setData(e,t,r){this.props.data=t}getProps(){return{type:this.type,values:this.props.data}}};var T=class{constructor(e){this.layers=[],this.lastRec={},this.dataSources=[],this.id="view-"+u(),this.css="",s(e)&&s(e.css)&&(this.css=e.css),a(e&&e.supportedLayers,"supportedLayers"),c(e.supportedLayers,"supportedLayers"),o(e.supportedLayers.length>0,"supportedLayers.length === 0"),this.supportedLayers=e.supportedLayers,this.init(e)}init(e){this.elementDiv=document.createElement("div"),this.elementDiv.setAttribute("id",this.id),this.elementDiv.setAttribute("class",this.css+" osh-view"),this.divId=this.id;let t=s(e.container)?e.container:document.body,r=document.getElementById(t);if(s(r)&&null!==r?(r.appendChild(this.elementDiv),this.container=r):(document.body.appendChild(this.elementDiv),this.hide(),this.container=document.body),this.beforeAddingItems(e),s(e)){if(s(e.layers))for(let t=0;t<e.layers.length;t++)this.addLayer(e.layers[t]);s(e.dataSourceId)&&this.addLayer(new b({dataSourceId:e.dataSourceId})),s(e.visible)&&(document.getElementById(this.divId).style.display=e.visible?"block":"none")}const i=this;new MutationObserver(e=>{e.forEach((function(e){"style"===e.attributeName&&i.onResize()}))}).observe(this.elementDiv,{attributes:!0});new MutationObserver((function(e){s(document.getElementById(i.divId))||(this.disconnect(),i.destroy())})).observe(document.body,{childList:!0})}hide(){this.elementDiv.style.display="none"}onResize(){}attachTo(e){s(this.elementDiv.parentNode)&&this.elementDiv.parentNode.removeChild(this.elementDiv),document.getElementById(e).appendChild(this.elementDiv),"none"===this.elementDiv.style.display&&(this.elementDiv.style.display="block"),this.onResize()}beforeAddingItems(e){}getId(){return this.id}getDivId(){return this.divId}setData(e,t){}show(e){}destroy(){}addLayer(e){o(this.supportedLayers.includes(e.type),"this layer is not supported: "+e.type+", should be "+this.supportedLayers),this.layers.push(e);let t=e.getDataSourcesIds();for(let r=0;r<t.length;r++){const s=t[r];let i=this;new BroadcastChannel("datasource-data-"+s).onmessage=t=>{t.data.type===v&&t.data.status===l||(t.data.message&&"reset"===t.data.message||t.data.type===v&&t.data.status===l?i.reset():t.data.type===y&&(e.setData(s,t.data.values),this.setData(s,e.getProps()),i.lastRec[s]=t.data))}}}removeAllFromLayer(e){if(this.layers.includes(e)){for(let t in e.dataSourcesToFn)delete this.lastRec[t];e.reset()}}removeAllFromLayers(){for(let e of this.layers)this.removeAllFromLayer(e)}getDataSourcesId(){let e=[];for(let t=0;t<this.layers.length;t++){let r=this.layers[t];e=e.concat(r.getDataSourcesIds())}return e}reset(){}};var I=class extends T{constructor(e){if(super({supportedLayers:["data"],...e}),this.timeStamp=null,s(e.showTime)&&e.showTime&&(this.timeStamp=document.createElement("div"),this.timeStamp.setAttribute("class","video-time"),document.getElementById(this.divId).appendChild(this.timeStamp)),this.imgTag=document.createElement("img"),this.imgTag.setAttribute("class","video-mjpeg"),this.rotation=0,void 0!==e&&void 0!==e.rotation){this.rotation=e.rotation*Math.PI/180,this.canvas=document.createElement("canvas"),this.canvas.width=640,this.canvas.height=480;var t=this.canvas.getContext("2d");t.translate(0,480),t.rotate(this.rotation),document.getElementById(this.divId).appendChild(this.canvas)}else document.getElementById(this.divId).appendChild(this.imgTag)}setData(e,t){const r=t.values;for(let e=0;e<r.length;e++){const e=r.shift();let t=new Blob([e.data.frameData]),s=window.URL.createObjectURL(t),i=this.imgTag.src;this.imgTag.src=s,null!==this.timeStamp&&(this.timeStamp.innerHTML=new Date(e.timeStamp).toISOString()),window.URL.revokeObjectURL(i)}}selectDataView(e,t){e.indexOf(this.dataSourceId)>-1||s(this.entity)&&this.entity.getId()===t?document.getElementById(this.divId).setAttribute("class",this.css+" "+this.cssSelected):document.getElementById(this.divId).setAttribute("class",this.css)}reset(){this.imgTag.src=""}};let x=new g("android-Video",{protocol:"ws",service:"SOS",endpointUrl:"sensiasoft.net:8181/sensorhub/sos",offeringID:"urn:android:device:060693280a28e015-sos",observedProperty:"http://sensorml.com/ont/swe/property/VideoFrame",startTime:"2015-02-16T07:58:35Z",endTime:"2015-02-16T08:09:00Z",replaySpeed:3});new I({container:"video-mjpeg-container",css:"video-mjpeg",name:"Android Video",keepRatio:!0,showTime:!0,dataSourceId:x.id});x.connect()}]);