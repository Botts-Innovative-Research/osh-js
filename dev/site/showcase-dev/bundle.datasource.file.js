!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){e.exports=function(){return new Worker(r.p+"WorkerName.33e3153f3095473d86ef.js")}},function(e,t,r){e.exports=function(){return new Worker(r.p+"WorkerName.71f89e2f287374f97554.js")}},function(e,t,r){"use strict";r.r(t);Math.pow(2,53);function n(e){return null!=e}function s(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var i=r(0),o=r.n(i);const a="realTime";var c=class{constructor(e){this.worker=e,this.onmessage=null}postMessage(e,t){this.worker.postMessage(e,t)}postMessageWithAck(e,t){const r=crypto.randomUUID();return new Promise((n,s)=>{const i=new AbortController;this.worker.addEventListener("message",e=>{e.data.ackId===r&&(delete e.data.ackId,i.abort(),e.error?s(e.error):n(e.data))},{signal:i.signal}),e.ackId=r,this.worker.postMessage(e,t)})}set onmessage(e){this.worker.onmessage=e}terminate(){this.worker&&this.worker.terminate()}};const u=[];let d=0,h={};var p=class{constructor(e,t){this.id=t.id||"DataSource-"+s(),this.name=e,this.properties=t,this.eventSubscriptionMap={},this.init=void 0,this.mode=a,n(t.mode)&&(this.mode=t.mode)}getId(){return this.id}getName(){return this.name}terminate(){null!==this.dataSourceWorker&&this.dataSourceWorker.terminate()}getTopicId(){return"datasource-data-"+this.id}subscribe(e,t){for(let r=0;r<t.length;r++)t[r]in this.eventSubscriptionMap||(this.eventSubscriptionMap[t[r]]=[]),this.eventSubscriptionMap[t[r]].push(e)}async createWorker(e){return new c(new o.a)}async updateProperties(e){return this.properties={...this.properties,...e},this.dataSourceWorker.postMessageWithAck({message:"update-properties",data:e,dsId:this.id})}async connect(){return await this.checkInit(),this.doConnect()}async getWorker(){return this.id in h||(d=(d+1)%5,n(u[d])||(u[d]=await this.createWorker()),h[this.id]=d),u[h[this.id]]}async initDataSource(e=this.properties){return this.dataSourceWorker=await this.getWorker(),this.dataSourceWorker.postMessageWithAck({message:"init",id:this.id,properties:e,topics:{data:this.getTopicId()},dsId:this.id}).then(()=>{new BroadcastChannel(this.getTopicId()).onmessage=async e=>{await this.handleMessage(e)},this.isInitialized=!0})}async handleMessage(e){const t=e.data.type;if(t in this.eventSubscriptionMap)for(let r=0;r<this.eventSubscriptionMap[t].length;r++)this.eventSubscriptionMap[t][r](e.data)}async checkInit(){return n(this.init)||(this.init=this.initDataSource()),this.init}async doConnect(){return this.dataSourceWorker.postMessageWithAck({message:"connect",dsId:this.id})}async isConnected(){return!!this.init&&(await this.checkInit(),this.dataSourceWorker.postMessageWithAck({message:"is-connected",dsId:this.id}))}async disconnect(){return await this.checkInit(),this.dataSourceWorker.postMessageWithAck({message:"disconnect",dsId:this.id})}async onDisconnect(){}reset(){this.init=void 0}onRemovedDataSource(e){}onAddedDataSource(e){}},l=r(1),f=r.n(l);var g=class extends p{constructor(e,t){super(e,{...t,protocol:"file",type:"File"})}async createWorker(e){return new c(new f.a)}};const x=[];for(let e=1;e<=8;e++)x.push("./data/earthquakes."+e+".csv");const k=new g("EQ data",{paths:x,batchSize:5e3}),m=document.getElementById("json-container");function y(e){return new Promise(t=>setTimeout(t,e))}k.subscribe(async e=>{let t;for(let r=0;r<e.values.length;r++){t=e.values[r];const n=JSON.stringify(t.data,null,2);m.innerHTML=n,await y(50)}},["data"]),k.connect()}]);