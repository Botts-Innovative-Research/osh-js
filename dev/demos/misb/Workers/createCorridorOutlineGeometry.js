define(["./GeometryOffsetAttribute-e8e698d7","./arrayRemoveDuplicates-198208a4","./Transforms-62a339c3","./Matrix2-92b7fb9d","./RuntimeError-4fdc4459","./ComponentDatatype-9ed50558","./PolylineVolumeGeometryLibrary-b9fa2b05","./CorridorGeometryLibrary-143e6a2e","./when-8166c7dd","./GeometryAttribute-6f4c3b93","./GeometryAttributes-50becc99","./IndexDatatype-797210ca","./PolygonPipeline-7fb6627c","./combine-a5c4cc47","./WebGLConstants-0664004c","./EllipsoidTangentPlane-5d8b4bd3","./AxisAlignedBoundingBox-b0cd1e39","./IntersectionTests-4f28a69c","./Plane-049255eb","./PolylinePipeline-fd9260c9","./EllipsoidGeodesic-133bd147","./EllipsoidRhumbLine-51654311"],(function(e,t,i,r,o,a,n,s,l,d,u,p,f,h,y,c,b,g,m,v,A,_){"use strict";var C=new r.Cartesian3,E=new r.Cartesian3,G=new r.Cartesian3;function T(e,t){var i,o,f,h=[],y=e.positions,c=e.corners,b=e.endPositions,g=new u.GeometryAttributes,m=0,v=0,A=0;for(o=0;o<y.length;o+=2)m+=f=y[o].length-3,A+=f/3*4,v+=y[o+1].length-3;for(m+=3,v+=3,o=0;o<c.length;o++){i=c[o];var _=c[o].leftPositions;l.defined(_)?(m+=f=_.length,A+=f/3*2):(v+=f=c[o].rightPositions.length,A+=f/3*2)}var T,P=l.defined(b);P&&(m+=T=b[0].length-3,v+=T,A+=4*(T/=3));var w,L,D,k,O,x,N=m+v,V=new Float64Array(N),H=0,I=N-1,S=T/2,B=p.IndexDatatype.createTypedArray(N/3,A+4),M=0;if(B[M++]=H/3,B[M++]=(I-2)/3,P){h.push(H/3),x=C,O=E;var R=b[0];for(o=0;o<S;o++)x=r.Cartesian3.fromArray(R,3*(S-1-o),x),O=r.Cartesian3.fromArray(R,3*(S+o),O),s.CorridorGeometryLibrary.addAttribute(V,O,H),s.CorridorGeometryLibrary.addAttribute(V,x,void 0,I),k=1+(L=H/3),D=(w=(I-2)/3)-1,B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3}var U=0,F=y[U++],j=y[U++];for(V.set(F,H),V.set(j,I-j.length+1),f=j.length-3,h.push(H/3,(I-2)/3),o=0;o<f;o+=3)k=1+(L=H/3),D=(w=(I-2)/3)-1,B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3;for(o=0;o<c.length;o++){var Y,q,W=(i=c[o]).leftPositions,J=i.rightPositions,z=G;if(l.defined(W)){for(I-=3,q=D,h.push(k),Y=0;Y<W.length/3;Y++)z=r.Cartesian3.fromArray(W,3*Y,z),B[M++]=q-Y-1,B[M++]=q-Y,s.CorridorGeometryLibrary.addAttribute(V,z,void 0,I),I-=3;h.push(q-Math.floor(W.length/6)),t===n.CornerType.BEVELED&&h.push((I-2)/3+1),H+=3}else{for(H+=3,q=k,h.push(D),Y=0;Y<J.length/3;Y++)z=r.Cartesian3.fromArray(J,3*Y,z),B[M++]=q+Y,B[M++]=q+Y+1,s.CorridorGeometryLibrary.addAttribute(V,z,H),H+=3;h.push(q+Math.floor(J.length/6)),t===n.CornerType.BEVELED&&h.push(H/3-1),I-=3}for(F=y[U++],j=y[U++],F.splice(0,3),j.splice(j.length-3,3),V.set(F,H),V.set(j,I-j.length+1),f=j.length-3,Y=0;Y<j.length;Y+=3)L=(k=H/3)-1,w=1+(D=(I-2)/3),B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3;H-=3,I+=3,h.push(H/3,(I-2)/3)}if(P){H+=3,I-=3,x=C,O=E;var K=b[1];for(o=0;o<S;o++)x=r.Cartesian3.fromArray(K,3*(T-o-1),x),O=r.Cartesian3.fromArray(K,3*o,O),s.CorridorGeometryLibrary.addAttribute(V,x,void 0,I),s.CorridorGeometryLibrary.addAttribute(V,O,H),L=(k=H/3)-1,w=1+(D=(I-2)/3),B[M++]=w,B[M++]=D,B[M++]=L,B[M++]=k,H+=3,I-=3;h.push(H/3)}else h.push(H/3,(I-2)/3);return B[M++]=H/3,B[M++]=(I-2)/3,g.position=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:V}),{attributes:g,indices:B,wallIndices:h}}function P(e){var t=(e=l.defaultValue(e,l.defaultValue.EMPTY_OBJECT)).positions,i=e.width;o.Check.typeOf.object("options.positions",t),o.Check.typeOf.number("options.width",i);var s=l.defaultValue(e.height,0),d=l.defaultValue(e.extrudedHeight,s);this._positions=t,this._ellipsoid=r.Ellipsoid.clone(l.defaultValue(e.ellipsoid,r.Ellipsoid.WGS84)),this._width=i,this._height=Math.max(s,d),this._extrudedHeight=Math.min(s,d),this._cornerType=l.defaultValue(e.cornerType,n.CornerType.ROUNDED),this._granularity=l.defaultValue(e.granularity,a.CesiumMath.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*r.Cartesian3.packedLength+r.Ellipsoid.packedLength+6}P.pack=function(e,t,i){o.Check.typeOf.object("value",e),o.Check.typeOf.object("array",t),i=l.defaultValue(i,0);var a=e._positions,n=a.length;t[i++]=n;for(var s=0;s<n;++s,i+=r.Cartesian3.packedLength)r.Cartesian3.pack(a[s],t,i);return r.Ellipsoid.pack(e._ellipsoid,t,i),i+=r.Ellipsoid.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=l.defaultValue(e._offsetAttribute,-1),t};var w=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),L={positions:void 0,ellipsoid:w,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return P.unpack=function(e,t,i){o.Check.typeOf.object("array",e),t=l.defaultValue(t,0);for(var a=e[t++],n=new Array(a),s=0;s<a;++s,t+=r.Cartesian3.packedLength)n[s]=r.Cartesian3.unpack(e,t);var d=r.Ellipsoid.unpack(e,t,w);t+=r.Ellipsoid.packedLength;var u=e[t++],p=e[t++],f=e[t++],h=e[t++],y=e[t++],c=e[t];return l.defined(i)?(i._positions=n,i._ellipsoid=r.Ellipsoid.clone(d,i._ellipsoid),i._width=u,i._height=p,i._extrudedHeight=f,i._cornerType=h,i._granularity=y,i._offsetAttribute=-1===c?void 0:c,i):(L.positions=n,L.width=u,L.height=p,L.extrudedHeight=f,L.cornerType=h,L.granularity=y,L.offsetAttribute=-1===c?void 0:c,new P(L))},P.createGeometry=function(o){var n=o._positions,u=o._width,h=o._ellipsoid;n=function(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}(n,h);var y=t.arrayRemoveDuplicates(n,r.Cartesian3.equalsEpsilon);if(!(y.length<2||u<=0)){var c,b=o._height,g=o._extrudedHeight,m=!a.CesiumMath.equalsEpsilon(b,g,0,a.CesiumMath.EPSILON2),v={ellipsoid:h,positions:y,width:u,cornerType:o._cornerType,granularity:o._granularity,saveAttributes:!1};if(m)v.height=b,v.extrudedHeight=g,v.offsetAttribute=o._offsetAttribute,c=function(t){var i=t.ellipsoid,r=T(s.CorridorGeometryLibrary.computePositions(t),t.cornerType),o=r.wallIndices,n=t.height,u=t.extrudedHeight,h=r.attributes,y=r.indices,c=h.position.values,b=c.length,g=new Float64Array(b);g.set(c);var m,v=new Float64Array(2*b);if(c=f.PolygonPipeline.scaleToGeodeticHeight(c,n,i),g=f.PolygonPipeline.scaleToGeodeticHeight(g,u,i),v.set(c),v.set(g,b),h.position.values=v,b/=3,l.defined(t.offsetAttribute)){var A=new Uint8Array(2*b);if(t.offsetAttribute===e.GeometryOffsetAttribute.TOP)A=e.arrayFill(A,1,0,b);else{var _=t.offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;A=e.arrayFill(A,_)}h.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}var C=y.length,E=p.IndexDatatype.createTypedArray(v.length/3,2*(C+o.length));E.set(y);var G,P,w=C;for(m=0;m<C;m+=2){var L=y[m],D=y[m+1];E[w++]=L+b,E[w++]=D+b}for(m=0;m<o.length;m++)P=(G=o[m])+b,E[w++]=G,E[w++]=P;return{attributes:h,indices:E}}(v);else if((c=T(s.CorridorGeometryLibrary.computePositions(v),v.cornerType)).attributes.position.values=f.PolygonPipeline.scaleToGeodeticHeight(c.attributes.position.values,b,h),l.defined(o._offsetAttribute)){var A=c.attributes.position.values.length,_=new Uint8Array(A/3),C=o._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;e.arrayFill(_,C),c.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}var E=c.attributes,G=i.BoundingSphere.fromVertices(E.position.values,void 0,3);return new d.Geometry({attributes:E,indices:c.indices,primitiveType:d.PrimitiveType.LINES,boundingSphere:G,offsetAttribute:o._offsetAttribute})}},function(e,t){return l.defined(t)&&(e=P.unpack(e,t)),e._ellipsoid=r.Ellipsoid.clone(e._ellipsoid),P.createGeometry(e)}}));