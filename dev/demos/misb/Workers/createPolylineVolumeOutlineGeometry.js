define(["./when-8166c7dd","./Matrix2-92b7fb9d","./arrayRemoveDuplicates-198208a4","./BoundingRectangle-ab1365ab","./Transforms-62a339c3","./ComponentDatatype-9ed50558","./PolylineVolumeGeometryLibrary-b9fa2b05","./RuntimeError-4fdc4459","./GeometryAttribute-6f4c3b93","./GeometryAttributes-50becc99","./IndexDatatype-797210ca","./PolygonPipeline-7fb6627c","./combine-a5c4cc47","./WebGLConstants-0664004c","./EllipsoidTangentPlane-5d8b4bd3","./AxisAlignedBoundingBox-b0cd1e39","./IntersectionTests-4f28a69c","./Plane-049255eb","./PolylinePipeline-fd9260c9","./EllipsoidGeodesic-133bd147","./EllipsoidRhumbLine-51654311"],(function(e,i,r,n,o,t,a,l,s,p,d,u,c,y,h,f,g,v,m,E,b){"use strict";function P(r){var n=(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT)).polylinePositions,o=r.shapePositions;if(!e.defined(n))throw new l.DeveloperError("options.polylinePositions is required.");if(!e.defined(o))throw new l.DeveloperError("options.shapePositions is required.");this._positions=n,this._shape=o,this._ellipsoid=i.Ellipsoid.clone(e.defaultValue(r.ellipsoid,i.Ellipsoid.WGS84)),this._cornerType=e.defaultValue(r.cornerType,a.CornerType.ROUNDED),this._granularity=e.defaultValue(r.granularity,t.CesiumMath.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var s=1+n.length*i.Cartesian3.packedLength;s+=1+o.length*i.Cartesian2.packedLength,this.packedLength=s+i.Ellipsoid.packedLength+2}P.pack=function(r,n,o){if(!e.defined(r))throw new l.DeveloperError("value is required");if(!e.defined(n))throw new l.DeveloperError("array is required");var t;o=e.defaultValue(o,0);var a=r._positions,s=a.length;for(n[o++]=s,t=0;t<s;++t,o+=i.Cartesian3.packedLength)i.Cartesian3.pack(a[t],n,o);var p=r._shape;for(s=p.length,n[o++]=s,t=0;t<s;++t,o+=i.Cartesian2.packedLength)i.Cartesian2.pack(p[t],n,o);return i.Ellipsoid.pack(r._ellipsoid,n,o),o+=i.Ellipsoid.packedLength,n[o++]=r._cornerType,n[o]=r._granularity,n};var _=i.Ellipsoid.clone(i.Ellipsoid.UNIT_SPHERE),k={polylinePositions:void 0,shapePositions:void 0,ellipsoid:_,height:void 0,cornerType:void 0,granularity:void 0};P.unpack=function(r,n,o){if(!e.defined(r))throw new l.DeveloperError("array is required");var t;n=e.defaultValue(n,0);var a=r[n++],s=new Array(a);for(t=0;t<a;++t,n+=i.Cartesian3.packedLength)s[t]=i.Cartesian3.unpack(r,n);a=r[n++];var p=new Array(a);for(t=0;t<a;++t,n+=i.Cartesian2.packedLength)p[t]=i.Cartesian2.unpack(r,n);var d=i.Ellipsoid.unpack(r,n,_);n+=i.Ellipsoid.packedLength;var u=r[n++],c=r[n];return e.defined(o)?(o._positions=s,o._shape=p,o._ellipsoid=i.Ellipsoid.clone(d,o._ellipsoid),o._cornerType=u,o._granularity=c,o):(k.polylinePositions=s,k.shapePositions=p,k.cornerType=u,k.granularity=c,new P(k))};var D=new n.BoundingRectangle;return P.createGeometry=function(e){var l=e._positions,c=r.arrayRemoveDuplicates(l,i.Cartesian3.equalsEpsilon),y=e._shape;if(y=a.PolylineVolumeGeometryLibrary.removeDuplicatesFromShape(y),!(c.length<2||y.length<3)){u.PolygonPipeline.computeWindingOrder2D(y)===u.WindingOrder.CLOCKWISE&&y.reverse();var h=n.BoundingRectangle.fromPoints(y,D);return function(e,i){var r=new p.GeometryAttributes;r.position=new s.GeometryAttribute({componentDatatype:t.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e});var n,a,l=i.length,u=r.position.values.length/3,c=e.length/3/l,y=d.IndexDatatype.createTypedArray(u,2*l*(c+1)),h=0,f=(n=0)*l;for(a=0;a<l-1;a++)y[h++]=a+f,y[h++]=a+f+1;for(y[h++]=l-1+f,y[h++]=f,f=(n=c-1)*l,a=0;a<l-1;a++)y[h++]=a+f,y[h++]=a+f+1;for(y[h++]=l-1+f,y[h++]=f,n=0;n<c-1;n++){var g=l*n,v=g+l;for(a=0;a<l;a++)y[h++]=a+g,y[h++]=a+v}return new s.Geometry({attributes:r,indices:d.IndexDatatype.createTypedArray(u,y),boundingSphere:o.BoundingSphere.fromVertices(e),primitiveType:s.PrimitiveType.LINES})}(a.PolylineVolumeGeometryLibrary.computePositions(c,y,h,e,!1),y)}},function(r,n){return e.defined(n)&&(r=P.unpack(r,n)),r._ellipsoid=i.Ellipsoid.clone(r._ellipsoid),P.createGeometry(r)}}));