(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{110:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));const i={CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",CLOSED_ERROR:"closed-error"}},123:function(e,t,r){"use strict";var i=r(8);var s=class{constructor(e){this.properties=e,this.dataSourcesToFn=void 0,this.data=[],this.props={},this.props.id="layer-"+Object(i.i)(),this.props.name="",this.props.description="",this.props.dataSourceId="",this.props.visible=!0,this.props.filter=!0,Object(i.g)(e.name)&&(this.props.name=e.name),Object(i.g)(e.description)&&(this.props.description=e.description),Object(i.g)(e.dataSourceId)&&(this.props.dataSourceId=e.dataSourceId),Object(i.g)(e.visible)&&(this.props.visible=e.visible),this.initEvents();const t=this;if(this.checkFn("filter")){let e=function(e,r,i){t.props.filter=t.getFunc("filter")(e,r,i)};this.addFn(t.getDataSourcesIdsByProperty("filter"),e)}else{this.properties.filter=function(e,t,r){return!0};let e=function(e,r,i){t.props.filter=t.getFunc("filter")(e,r,i)};this.addFn(t.getDataSourcesIdsByProperty("filter"),e)}if(this.checkFn("getVisible")){let e=function(e,r,i){t.props.visible=t.getFunc("getVisible")(e,r,i)};this.addFn(t.getDataSourcesIdsByProperty("getVisible"),e)}}saveState(){this.initialState={...this.props}}restoreState(){this.props={...this.initialState}}getFunc(e){return this.properties[e].handler||this.properties[e]}checkFn(e){let t=this.properties[e];if(Object(i.h)(t))return Object(i.b)(this.properties.dataSourceId,"dataSourceId"),!0;{let r=Object(i.e)(t);return r&&(Object(i.a)(t.dataSourceIds,e+".dataSourceIds"),Object(i.c)(t.handler,e+".handler")),r}}initEvents(){}clear(){}getId(){return this.id}select(e){}addFn(e,t){Object(i.g)(this.dataSourcesToFn)||(this.dataSourcesToFn={});for(let r=0;r<e.length;r++){let s=e[r];Object(i.g)(this.dataSourcesToFn[s])||(this.dataSourcesToFn[s]=[]),this.dataSourcesToFn[s].push(t)}}setData(e,t,r={}){if(this.data=[],r.dataSourceId=e,Object(i.g)(this.dataSourcesToFn)&&e in this.dataSourcesToFn){let i=this.dataSourcesToFn[e];for(let e=0;e<t.length;e++){e:for(let s=0;s<i.length&&(i[s](t[e].data,t[e].timeStamp,r),this.props.filter);s++);this.props.filter&&this.data.push({...this.props})}}}getDataSourcesIds(){if(Object(i.g)(this.dataSourcesToFn)){let e=[];for(let t in this.dataSourcesToFn)e.push(t);return e}return Object(i.b)(this.properties.dataSourceId,"dataSourceId must be defined"),[this.properties.dataSourceId]}getDataSourcesIdsByProperty(e){return this.properties[e].dataSourceIds||[this.properties.dataSourceId]}init(){}getProps(){return{type:this.type,values:this.data}}reset(){this.restoreState()}};t.a=class extends s{constructor(e){super(e),this.type="data"}setData(e,t,r){this.props.data=t}getProps(){return{type:this.type,values:this.props.data}}}},153:function(e,t,r){e.exports=function(){return new Worker(r.p+"e3ebbc86d50bf2816382.worker.js")}},158:function(e,t,r){"use strict";var i=r(8),s=(r(168),r(90)),o=r(110);const n="data",a="status",l="time-changed";var d=r(123);var c=class{constructor(e){this.layers=[],this.lastRec={},this.dataSources=[],this.id="view-"+Object(i.i)(),this.css="",Object(i.g)(e)&&Object(i.g)(e.css)&&(this.css=e.css),Object(i.b)(e&&e.supportedLayers,"supportedLayers"),Object(i.a)(e.supportedLayers,"supportedLayers"),Object(i.d)(e.supportedLayers.length>0,"supportedLayers.length === 0"),this.supportedLayers=e.supportedLayers,this.init(e)}init(e){this.properties=e,this.elementDiv=document.createElement("div"),this.elementDiv.setAttribute("id",this.id),this.elementDiv.setAttribute("class",this.css+" osh-view"),this.divId=this.id;let t=Object(i.g)(e.container)?e.container:document.body,r=document.getElementById(t);if(Object(i.g)(r)&&null!==r?(r.appendChild(this.elementDiv),this.container=r):(document.body.appendChild(this.elementDiv),this.hide(),this.container=document.body),this.beforeAddingItems(e),Object(i.g)(e)){if(Object(i.g)(e.layers))for(let t=0;t<e.layers.length;t++)this.addLayer(e.layers[t]);Object(i.g)(e.dataSourceId)&&this.addLayer(new d.a({dataSourceId:e.dataSourceId})),Object(i.g)(e.visible)&&(document.getElementById(this.divId).style.display=e.visible?"block":"none")}const s=this;new MutationObserver(e=>{e.forEach((function(e){"style"===e.attributeName&&s.onResize()}))}).observe(this.elementDiv,{attributes:!0});new MutationObserver((function(e){Object(i.g)(document.getElementById(s.divId))||(this.disconnect(),s.destroy())})).observe(document.body,{childList:!0})}hide(){this.elementDiv.style.display="none"}onResize(){}attachTo(e){Object(i.g)(this.elementDiv.parentNode)&&this.elementDiv.parentNode.removeChild(this.elementDiv),document.getElementById(e).appendChild(this.elementDiv),"none"===this.elementDiv.style.display&&(this.elementDiv.style.display="block"),this.onResize()}beforeAddingItems(e){}getId(){return this.id}getDivId(){return this.divId}setData(e,t){}show(e){}destroy(){}addLayer(e){Object(i.d)(this.supportedLayers.includes(e.type),"this layer is not supported: "+e.type+", should be "+this.supportedLayers),this.layers.push(e);let t=e.getDataSourcesIds();for(let r=0;r<t.length;r++){const i=t[r];let d=this;new BroadcastChannel(s.a+i).onmessage=t=>{t.data.type===a&&t.data.status===o.a.CLOSED_ERROR?d.reset():t.data.type===n&&(e.setData(i,t.data.values),this.setData(i,e.getProps()),d.lastRec[i]=t.data)};new BroadcastChannel(s.b+i).onmessage=e=>{e.data.type===l&&d.reset()}}}removeAllFromLayer(e){if(this.layers.includes(e)){for(let t in e.dataSourcesToFn)delete this.lastRec[t];e.reset()}}removeAllFromLayers(){for(let e of this.layers)this.removeAllFromLayer(e)}getDataSourcesId(){let e=[];for(let t=0;t<this.layers.length;t++){let r=this.layers[t];e=e.concat(r.getDataSourcesIds())}return e}reset(){this.removeAllFromLayers()}};var u=class extends c{constructor(e){super(e),this.layerIdToMarkers={},this.layerIdToPolylines={},this.layerIdToEllipsoids={},this.layerIdToPolygon={},this.layerIdToFrustum={},this.layerIdToDrapedImage={}}setData(e,t){const r=t.values;for(let e=0;e<r.length;e++){const i=r[e];"marker"===t.type?this.updateMarker(i):"polyline"===t.type?this.updatePolyline(i):"drapedImage"===t.type?this.updateDrapedImage(i):"ellipse"===t.type?this.updateEllipse(i):"polygon"===t.type?this.updatePolygon(i):"coplanarPolygon"===t.type?this.updateCoPlanarPolygon(i):"frustum"===t.type&&this.updateFrustum(i)}}addPolygonToLayer(e,t){this.getLayer(e);e.id in this.layerIdToPolygon||(this.layerIdToPolygon[e.id]={}),this.layerIdToPolygon[e.id][e.polygonId]=t}addMarkerToLayer(e,t){this.getLayer(e);e.id in this.layerIdToMarkers||(this.layerIdToMarkers[e.id]={}),this.layerIdToMarkers[e.id][e.markerId]=t}addPolylineToLayer(e,t){e.id in this.layerIdToPolylines||(this.layerIdToPolylines[e.id]={}),this.layerIdToPolylines[e.id][e.polylineId]=t}addEllipseToLayer(e,t){e.id in this.layerIdToEllipsoids||(this.layerIdToEllipsoids[e.id]={}),this.layerIdToEllipsoids[e.id][e.ellipseId]=t}addDrapedImageToLayer(e,t){e.id in this.layerIdToDrapedImage||(this.layerIdToDrapedImage[e.id]={}),this.layerIdToDrapedImage[e.id][e.drapedImageId]=t}addFrustumToLayer(e,t){this.getLayer(e);e.id in this.layerIdToFrustum||(this.layerIdToFrustum[e.id]={}),this.layerIdToFrustum[e.id][e.frustumId]=t}getPolygons(){const e=[];for(let t in this.layerIdToPolygon)for(let r in this.layerIdToPolygon[t])e.push(this.layerIdToPolygon[t][r]);return e}getPolygon(e){return e.id in this.layerIdToPolygon?this.layerIdToPolygon[e.id][e.polygonId]:null}getMarker(e){return e.id in this.layerIdToMarkers?this.layerIdToMarkers[e.id][e.markerId]:null}getMarkers(){const e=[];for(let t in this.layerIdToMarkers)for(let r in this.layerIdToMarkers[t])e.push(this.layerIdToMarkers[t][r]);return e}getPolylines(){const e=[];for(let t in this.layerIdToPolylines)for(let r in this.layerIdToPolylines[t])e.push(this.layerIdToPolylines[t][r]);return e}getEllipsoids(){const e=[];for(let t in this.layerIdToEllipsoids)for(let r in this.layerIdToEllipsoids[t])e.push(this.layerIdToEllipsoids[t][r]);return e}getPolyline(e){return e.id in this.layerIdToEllipsoids?this.layerIdToEllipsoids[e.id][e.ellipseId]:null}getEllipse(e){return e.id in this.layerIdToEllipsoids?this.layerIdToEllipsoids[e.id][e.ellipseId]:null}getPolyline(e){return e.id in this.layerIdToPolylines?this.layerIdToPolylines[e.id][e.polylineId]:null}getDrapedImage(e){return e.id in this.layerIdToDrapedImage?this.layerIdToDrapedImage[e.id][e.drapedImageId]:null}getFrustums(){const e=[];for(let t in this.layerIdToFrustum)for(let r in this.layerIdToFrustum[t])e.push(this.layerIdToFrustum[t][r]);return e}getFrustum(e){return e.id in this.layerIdToFrustum?this.layerIdToFrustum[e.id][e.frustumId]:null}getLayer(e){for(let t of this.layers)if(t.props.id===e)return t;return null}removeAllFromLayer(e){super.removeAllFromLayer(e),this.removeMarkers(e),this.removePolylines(e),this.removeEllipsoids(e),this.removePolygons(e),this.removeFrustums(e)}removePolygons(e){if(Object(i.g)(e.props.polygonId)){const t=this.layerIdToPolygon[e.props.id];if(Object(i.g)(t))for(let e in t){const r=t[e];this.removePolygonFromLayer(r)}delete this.layerIdToPolygon[e.props.id]}}removeMarkers(e){if(Object(i.g)(e.props.markerId)){const t=this.layerIdToMarkers[e.props.id];if(Object(i.g)(t))for(let e in t){const r=t[e];this.removeMarkerFromLayer(r)}delete this.layerIdToMarkers[e.props.id]}}removeEllipsoids(e){if(Object(i.g)(e.props.ellipseId)){const t=this.layerIdToEllipsoids[e.props.id];if(Object(i.g)(t))for(let e in t){const r=t[e];this.removeEllipseFromLayer(r)}delete this.layerIdToEllipsoids[e.props.id]}}removePolylines(e){if(Object(i.g)(e.props.polylineId)){const t=this.layerIdToPolylines[e.props.id];if(Object(i.g)(t))for(let e in t){const r=t[e];this.removePolylineFromLayer(r)}delete this.layerIdToPolylines[e.props.id]}}removeDrapedImages(e){if(Object(i.g)(e.props.drapedImageId)){const t=this.layerIdToDrapedImage[e.props.id];if(Object(i.g)(t))for(let e in t){const r=t[e];this.removeDrapedImageFromLayer(r)}delete this.layerIdToDrapedImage[e.props.id]}}removeFrustums(e){if(Object(i.g)(e.props.frustumId)){const t=this.layerIdToFrustum[e.props.id];if(Object(i.g)(t))for(let e in t){const r=t[e];this.removeFrustumFromLayer(r)}delete this.layerIdToFrustum[e.props.id]}}removeMarkerFromLayer(e){}removePolylineFromLayer(e){}removeDrapedImageFromLayer(e){}removePolygonFromLayer(e){}onMarkerLeftClick(e,t,r,s){Object(i.g)(r.onLeftClick)&&r.onLeftClick.call(r,e,t,s)}onMarkerRightClick(e,t,r,s){Object(i.g)(r.onRightClick)&&r.onRightClick.call(r,e,t,s)}onMarkerMove(e,t,r,s){Object(i.g)(r.onMove)&&r.onMove.call(r,e,t,s)}onMarkerHover(e,t,r,s){Object(i.g)(r.onHover)&&r.onHover.call(r,e,t,s)}getLayerId(e){const t=e.split("$");return Object(i.g)(t)&&2===t.length?t[0]:null}getMarkerId(e){if(!Object(i.g)(e))return null;const t=e.split("$");return Object(i.g)(t)&&2===t.length?t[1]:null}updateMarker(){}updatePolyline(){}updatePolygon(){}updateEllipse(){}updateCoPlanarPolygon(){}updateDrapedImage(){}},p=r(155),h=r(214),y=r(221),g=r(220),m=r(97),I=r(213),f=r(216);r(170);t.a=class extends u{constructor(e){super({supportedLayers:["marker","polyline","polygon"],...e});let t=document.getElementById(this.divId).className;document.getElementById(this.divId).setAttribute("class",t+" "+this.css),this.autoZoomOnFirstMarker=!1,Object(i.g)(e)&&Object(i.g)(e.autoZoomOnFirstMarker)&&(this.autoZoomOnFirstMarker=e.autoZoomOnFirstMarker)}beforeAddingItems(e){this.initMap(e)}initMap(e){this.INITIAL_VIEW_STATE={longitude:0,latitude:0,zoom:2,bearing:0,pitch:0};const t=document.createElement("canvas");if(t.setAttribute("id",Object(i.i)()),t.setAttribute("style","width:100%;height:100%;position:relative;"),document.getElementById(this.divId).appendChild(t),this.deckLayers=[],Object(i.g)(e)&&Object(i.g)(e.deckProps)&&Object(i.g)(e.deckProps.layers))for(let t=0;t<e.deckProps.layers.length;t++){const r=e.deckProps.layers[t].id?e.deckProps.layers[t].id:"base_"+r;this.deckLayers.push(e.deckProps.layers[t])}else this.deckLayers.push(new f.a({id:"base",data:"https://c.tile.openstreetmap.org/{z}/{x}/{y}.png",minZoom:0,maxZoom:19,tileSize:256,renderSubLayers:e=>{const{bbox:{west:t,south:r,east:i,north:s}}=e.tile;return new g.a(e,{data:null,image:e.data,bounds:[t,r,i,s]})}}));let r={canvas:t.id,width:"100%",height:"100%",controller:!0,views:[new p.a],initialViewState:this.INITIAL_VIEW_STATE,onViewStateChange:({viewState:e})=>{},layers:this.deckLayers};Object(i.g)(e)&&Object(i.g)(r)&&(r={...r,...e.deckProps}),this.INITIAL_VIEW_STATE=r.initialViewState,this.deckgl=new h.a(r)}updateMarker(e){const t=e.id+"$"+e.markerId,r=e.markerId,s=new y.a({id:t,data:[{position:[e.location.x,e.location.y,1]}],pickable:!0,iconAtlas:e.icon,iconMapping:{marker:{x:0,y:0,anchorX:e.iconAnchor[0],anchorY:e.iconAnchor[1],width:e.iconSize[0],height:e.iconSize[1],mask:"#000000"!==e.iconColor}},getIcon:e=>"marker",sizeScale:e.iconScale,getPosition:e=>e.position,getSize:t=>e.iconScale,getColor:t=>Object(i.f)(e.iconColor),onHover:(t,i)=>this.onMarkerHover(r,t,e,i),onClick:(t,i)=>i.leftButton?this.onMarkerLeftClick(r,t,e,i):this.onMarkerRightClick(r,t,e,i),zIndex:e.zIndex});this.addMarkerToLayer(e,s);const o={};this.autoZoomOnFirstMarker&&(this.autoZoomOnFirstMarker=!1,o.initialViewState={...this.INITIAL_VIEW_STATE,longitude:e.location.x,latitude:e.location.y,zoom:e.zoomLevel}),this.render(o)}updatePolyline(e){const t=e.id+"$"+e.polylineId,r=e.locations[e.polylineId].map(e=>[e.x,e.y,1]),i=[{weight:e.weight,name:e.id,color:this.rgbaToArray(e.color),path:r}],s=new m.a({id:t,data:i,widthUnits:"pixels",widthMinPixels:5,getPath:e=>e.path,getColor:e=>e.color,getWidth:e=>e.weight});this.addPolylineToLayer(e,s),this.render({})}updatePolygon(e){const t=e.id+"$"+e.polygonId;let r=[];const s=e.vertices[e.polygonId];if(Object(i.g)(s)&&s.length>0)for(let e=0;e<s.length-1;e+=2)r.push([s[e],s[e+1]]);let o=Object(i.j)(e.outlineColor).map((e,t,r)=>t>=3?parseInt(255*e):e),n=Object(i.j)(e.color).map((e,t,r)=>t>=3?parseInt(255*e):e);const a=[{outlineWidth:e.outlineWidth,outlineColor:o,name:e.label,color:n,contour:[r]}],l=new I.a({id:t,data:a,widthUnits:"pixels",lineWidthMinPixels:1,stroked:!0,filled:!0,getPolygon:e=>e.contour,getFillColor:e=>e.color,getLineWidth:e=>e.outlineWidth,getLineColor:e=>e.outlineColor});this.addPolygonToLayer(e,l),this.render({})}removeMarker(e){super.removeMarkers(e),this.render({})}removePolylines(e){super.removePolylines(e),this.render({})}removePolygons(e){super.removePolygons(e),this.render({})}render(e){const t=this.getMarkers(),r=this.getPolylines(),i=this.getPolygons();t.sort((e,t)=>e.props.zIndex>t.props.zIndex?1:t.props.zIndex>e.props.zIndex?-1:0);const s={layers:[...this.deckLayers,...i,...r,...t]};this.deckgl.setProps({...e,...s})}rgbaToArray(e){if(Array.isArray(e))return e;let t=e.indexOf("(")+1,r=e.indexOf(")");const i=e.substr(t,r-t).split(",").map(Number);return i[3]=parseInt(100*i[3]),i}}},160:function(e,t,r){"use strict";var i=r(8),s=r(90),o=r(110);var n=class{constructor(e,t,r){this.id="DataSource-"+Object(i.i)(),this.name=e,this.properties=t,this.dataSourceWorker=r,this.currentRunningProperties={},this.eventSubscriptionMap={},this.initDataSource(t)}initDataSource(e){this.dataSourceWorker.postMessage({message:"init",id:this.id,properties:JSON.stringify(e),topic:this.getTopicId()});new BroadcastChannel(this.getTopicId()).onmessage=e=>{const t=e.data.type;if(t in this.eventSubscriptionMap)for(let r=0;r<this.eventSubscriptionMap[t].length;r++)this.eventSubscriptionMap[t][r](e.data)}}disconnect(){this.dataSourceWorker.postMessage({message:"disconnect"})}onDisconnect(){return new Promise(e=>{new BroadcastChannel(this.getTopicId()).onmessage=t=>{t.data.status===o.a.DISCONNECTED&&e()}})}async connect(){return this.dataSourceWorker.postMessage({message:"connect"}),this.isConnected()}async isConnected(){const e=new Promise(e=>{null!==this.dataSourceWorker&&(this.dataSourceWorker.onmessage=t=>{"is-connected"===t.data.message&&e(t.data.data)})});return null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"is-connected"}),e}getId(){return this.id}getName(){return this.name}updateProperties(e){this.currentRunningProperties={...this.properties,...e},null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"update-url",data:e})}getCurrentRunningProperties(){return this.currentRunningProperties}terminate(){null!==this.dataSourceWorker&&this.dataSourceWorker.terminate()}getTopicId(){return s.a+this.id}getVersion(){return 0}subscribe(e,t){for(let r=0;r<t.length;r++)t[r]in this.eventSubscriptionMap||(this.eventSubscriptionMap[t[r]]=[]),this.eventSubscriptionMap[t[r]].push(e)}},a=r(153),l=r.n(a);t.a=class extends n{constructor(e,t){super(e,{...t,protocol:"file"},new l.a)}}},168:function(e,t,r){var i=r(169);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,r(47).default)("7b064102",i,!1,{})},169:function(e,t,r){(t=r(45)(!1)).push([e.i,".osh-view {\n    width:100%;\n    height: 100%;\n}\n",""]),e.exports=t},170:function(e,t,r){var i=r(171);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,r(47).default)("76e66efc",i,!1,{})},171:function(e,t,r){(t=r(45)(!1)).push([e.i,".osh-view > .deckgl-overlay {\n    position: relative !important;\n}\n",""]),e.exports=t},8:function(e,t,r){"use strict";r.d(t,"g",(function(){return i})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return o})),r.d(t,"h",(function(){return a})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"a",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return y}));Math.pow(2,53);function i(e){return null!=e}function s(e){return i(e)&&null!==e}function o(e){const[t,r,i]=e.match(/\w\w/g).map(e=>parseInt(e,16));return[t,r,i]}function n(e,t){return s(e)&&typeof e===t}function a(e,t){return n(e,"function")}function l(e,t="letiable"){if(!i(e))throw t+" must be defined";return e}function d(e,t="letiable"){if(!i(e)||!e)throw t;return e}function c(e,t,r="letiable"){if(l(e,r),typeof e!==t)throw r+" must be of type "+t;return e}function u(e,t="letiable"){if(l(e,t),!Array.isArray(e))throw t+" must be an array";return e}function p(e,t){return c(e,"function",t)}function h(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function y(e){let t=e.indexOf("(")+1,r=e.indexOf(")");return e.substr(t,r-t).split(",").map(Number)}},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));const i="datasource-data-",s="datasource-time-"}}]);