!function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){e.exports=r.p+"755b40e18673d35e4b61.worklet.js"},function(e,t,r){e.exports=function(){return new Worker(r.p+"WorkerName.a114cabac1df52ebc43f.js")}},function(e,t,r){var i=r(3),s=r(4);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var n={insert:"head",singleton:!1},o=(i(s,n),s.locals?s.locals:{});e.exports=o},function(e,t,r){"use strict";var i,s=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},n=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),o=[];function a(e){for(var t=-1,r=0;r<o.length;r++)if(o[r].identifier===e){t=r;break}return t}function d(e,t){for(var r={},i=[],s=0;s<e.length;s++){var n=e[s],d=t.base?n[0]+t.base:n[0],u=r[d]||0,c="".concat(d," ").concat(u);r[d]=u+1;var l=a(c),h={css:n[1],media:n[2],sourceMap:n[3]};-1!==l?(o[l].references++,o[l].updater(h)):o.push({identifier:c,updater:y(h,t),references:1}),i.push(c)}return i}function u(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=r.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,l=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function h(e,t,r,i){var s=r?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=l(t,s);else{var n=document.createTextNode(s),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function p(e,t,r){var i=r.css,s=r.media,n=r.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),n&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var f=null,m=0;function y(e,t){var r,i,s;if(t.singleton){var n=m++;r=f||(f=u(t)),i=h.bind(null,r,n,!1),s=h.bind(null,r,n,!0)}else r=u(t),i=p.bind(null,r,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=s());var r=d(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<r.length;i++){var s=a(r[i]);o[s].references--}for(var n=d(e,t),u=0;u<r.length;u++){var c=a(r[u]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}r=n}}}},function(e,t,r){(t=r(5)(!1)).push([e.i,".osh-view {\n    width:100%;\n    height: 100%;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var s=(o=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(d," */")),n=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[r].concat(n).concat([s]).join("\n")}var o,a,d;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,i){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(i)for(var n=0;n<this.length;n++){var o=this[n][0];null!=o&&(s[o]=!0)}for(var a=0;a<e.length;a++){var d=[].concat(e[a]);i&&s[d[0]]||(r&&(d[2]?d[2]="".concat(r," and ").concat(d[2]):d[2]=r),t.push(d))}},t}},function(e,t,r){e.exports=r.p+"6e84123720c07f6b98a5.worklet.js"},function(e,t,r){"use strict";r.r(t);Math.pow(2,53);function i(e){return null!=e}function s(e){return i(e)&&null!==e}function n(e,t){return s(e)&&typeof e===t}function o(e,t="letiable"){if(!i(e))throw t+" must be defined";return e}function a(e,t="letiable"){if(!i(e)||!e)throw t;return e}function d(e,t,r="letiable"){if(o(e,r),typeof e!==t)throw r+" must be of type "+t;return e}function u(e,t="letiable"){if(o(e,t),!Array.isArray(e))throw t+" must be an array";return e}function c(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}r(2);const l="disconnected",h="data",p="status";var f=class{constructor(e){this.properties=e,this.dataSourcesToFn=void 0,this.data=[],this.props={},this.props.id="layer-"+c(),this.props.name="",this.props.description="",this.props.dataSourceId="",i(e.name)&&(this.props.name=e.name),i(e.description)&&(this.props.description=e.description),i(e.dataSourceId)&&(this.props.dataSourceId=e.dataSourceId),this.initEvents()}saveState(){this.initialState={...this.props}}restoreState(){this.props={...this.initialState}}getFunc(e){return this.properties[e].handler||this.properties[e]}checkFn(e){let t=this.properties[e];if(n(t,"function"))return o(this.properties.dataSourceId,"dataSourceId"),!0;{let r=s(t);return r&&(u(t.dataSourceIds,e+".dataSourceIds"),function(e,t){d(e,"function",t)}(t.handler,e+".handler")),r}}initEvents(){}clear(){}getId(){return this.id}select(e){}addFn(e,t){i(this.dataSourcesToFn)||(this.dataSourcesToFn={});for(let r=0;r<e.length;r++){let s=e[r];i(this.dataSourcesToFn[s])||(this.dataSourcesToFn[s]=[]),this.dataSourcesToFn[s].push(t)}}setData(e,t,r){if(this.data=[],e in this.dataSourcesToFn){let i=this.dataSourcesToFn[e];for(let e=0;e<t.length;e++){for(let s=0;s<i.length;s++)i[s](t[e].data,t[e].timeStamp,r);this.data.push({...this.props})}}}getDataSourcesIds(){if(i(this.dataSourcesToFn)){let e=[];for(let t in this.dataSourcesToFn)e.push(t);return e}return o(this.properties.dataSourceId,"dataSourceId must be defined"),[this.properties.dataSourceId]}getDataSourcesIdsByProperty(e){return this.properties[e].dataSourceIds||[this.properties.dataSourceId]}init(){}getProps(){return{type:this.type,values:this.data}}reset(){this.restoreState()}};var m=class extends f{constructor(e){super(e),this.type="data"}setData(e,t,r){this.props.data=t}getProps(){return{type:this.type,values:this.props.data}}};var y=class{constructor(e){this.layers=[],this.lastRec={},this.dataSources=[],this.id="view-"+c(),this.css="",i(e)&&i(e.css)&&(this.css=e.css),o(e&&e.supportedLayers,"supportedLayers"),u(e.supportedLayers,"supportedLayers"),a(e.supportedLayers.length>0,"supportedLayers.length === 0"),this.supportedLayers=e.supportedLayers,this.init(e)}init(e){this.properties=e,this.elementDiv=document.createElement("div"),this.elementDiv.setAttribute("id",this.id),this.elementDiv.setAttribute("class",this.css+" osh-view"),this.divId=this.id;let t=i(e.container)?e.container:document.body,r=document.getElementById(t);if(i(r)&&null!==r?(r.appendChild(this.elementDiv),this.container=r):(document.body.appendChild(this.elementDiv),this.hide(),this.container=document.body),this.beforeAddingItems(e),i(e)){if(i(e.layers))for(let t=0;t<e.layers.length;t++)this.addLayer(e.layers[t]);i(e.dataSourceId)&&this.addLayer(new m({dataSourceId:e.dataSourceId})),i(e.visible)&&(document.getElementById(this.divId).style.display=e.visible?"block":"none")}const s=this;new MutationObserver(e=>{e.forEach((function(e){"style"===e.attributeName&&s.onResize()}))}).observe(this.elementDiv,{attributes:!0});new MutationObserver((function(e){i(document.getElementById(s.divId))||(this.disconnect(),s.destroy())})).observe(document.body,{childList:!0})}hide(){this.elementDiv.style.display="none"}onResize(){}attachTo(e){i(this.elementDiv.parentNode)&&this.elementDiv.parentNode.removeChild(this.elementDiv),document.getElementById(e).appendChild(this.elementDiv),"none"===this.elementDiv.style.display&&(this.elementDiv.style.display="block"),this.onResize()}beforeAddingItems(e){}getId(){return this.id}getDivId(){return this.divId}setData(e,t){}show(e){}destroy(){}addLayer(e){a(this.supportedLayers.includes(e.type),"this layer is not supported: "+e.type+", should be "+this.supportedLayers),this.layers.push(e);let t=e.getDataSourcesIds();for(let r=0;r<t.length;r++){const i=t[r];let s=this;new BroadcastChannel("datasource-data-"+i).onmessage=t=>{t.data.type===p&&t.data.status===l||(t.data.message&&"reset"===t.data.message||t.data.type===p&&t.data.status===l?s.reset():t.data.type===h&&(e.setData(i,t.data.values),this.setData(i,e.getProps()),s.lastRec[i]=t.data))}}}removeAllFromLayer(e){if(this.layers.includes(e)){for(let t in e.dataSourcesToFn)delete this.lastRec[t];e.reset()}}removeAllFromLayers(){for(let e of this.layers)this.removeAllFromLayer(e)}getDataSourcesId(){let e=[];for(let t=0;t<this.layers.length;t++){let r=this.layers[t];e=e.concat(r.getDataSourcesIds())}return e}reset(){}},g=(r(6),r(0)),v=r.n(g);var S=class extends y{constructor(e){super({flush:2,supportedLayers:["data"],...e}),this.initDecoder()}initDecoder(){try{this.decoder=new x(this.properties),console.warn("using WebCodec for audio decoding")}catch(e){this.decoder=new b(this.properties),console.warn("using WebAudioApi for audio decoding")}this.decoder.onDecodedBuffer=e=>{this.onDecodedBuffer(e)}}async setData(e,t){for(let e of t.values)await this.decoder.decode(e.data)}reset(){this.decoder.reset()}onDecodedBuffer(e){}getCurrentTime(){return this.decoder.getCurrentTime()}};class b{constructor(e){let t=window.AudioContext||window.webkitAudioContext;this.audioCtx=new t,this.deltaInc=0,this.audioBuffer=null,this.flushLimit=e.flush,this.count=0,this.init=!1}concat(e,t){const r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r.buffer}async decode(e){this.init||(this.audioCtx=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"playback",sampleRate:e.sampleRate}),this.audioCtx.resume(),await this.audioCtx.audioWorklet.addModule(v.a),this.workletNode=new AudioWorkletNode(this.audioCtx,"audio-player",{outputChannelCount:[1]}),this.workletNode.connect(this.audioCtx.destination),this.init=!0),0===this.count?this.audioBuffer=e.frameData.buffer:this.audioBuffer=this.concat(this.audioBuffer,e.frameData.buffer),this.count>=this.flushLimit?(await this.flush(),this.count=0):this.count++}async flush(){try{let e=(await this.audioCtx.decodeAudioData(this.audioBuffer)).getChannelData(0).buffer;this.workletNode.port.postMessage({data:e},[e])}catch(e){console.error(e)}}reset(){}onDecodedBuffer(e){}getCurrentTime(){return null===this.audioCtx?0:this.audioCtx.currentTime}}class x{constructor(e){this.deltaInc=0,this.init=!1,this.key=!0,this.audioCtx=null;try{this.audioDecoder=new AudioDecoder({output:e=>{const t=e.buffer;let r=this.audioCtx.createBufferSource();r.buffer=t,r.connect(this.audioCtx.destination),r.start(this.deltaInc),this.deltaInc+=t.duration,this.onDecodedBuffer(e.buffer)},error:e=>{console.error(e)}})}catch(e){throw new Error("WebCodec is not supported")}}async decode(e){if(!this.init){let t=window.AudioContext||window.webkitAudioContext;this.audioCtx=new t({sampleRate:e.sampleRate,latencyHint:"interactive"}),await this.audioDecoder.configure({codec:"mp4a.40.2",numberOfChannels:1,sampleRate:e.sampleRate}),this.init=!0}const t=new EncodedAudioChunk({type:this.key?"key":"delta",data:e.frameData.buffer,timestamp:0});try{this.audioDecoder.decode(t)}catch(e){console.error(e)}}reset(){this.init&&(this.init=!1)}onDecodedBuffer(e){console.log("decoded")}getCurrentTime(){return null===this.audioCtx?0:this.audioCtx.currentTime}}var w=class{constructor(e,t,r){this.id="DataSource-"+c(),this.name=e,this.properties=t,this.dataSourceWorker=r,this.currentRunningProperties={},this.initDataSource(t)}initDataSource(e){this.dataSourceWorker.postMessage({message:"init",id:this.id,properties:JSON.stringify(e),topic:this.getTopicId()})}disconnect(){this.dataSourceWorker.postMessage({message:"disconnect"})}onDisconnect(){return new Promise(e=>{new BroadcastChannel(this.getTopicId()).onmessage=t=>{t.data.status===l&&e()}})}async connect(){return this.dataSourceWorker.postMessage({message:"connect"}),this.isConnected()}async isConnected(){const e=new Promise(e=>{null!==this.dataSourceWorker&&(this.dataSourceWorker.onmessage=t=>{"is-connected"===t.data.message&&e(t.data.data)})});return null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"is-connected"}),e}getId(){return this.id}getName(){return this.name}updateProperties(e){this.currentRunningProperties={...this.properties,...e},null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"update-url",data:e})}getCurrentRunningProperties(){return this.currentRunningProperties}terminate(){null!==this.dataSourceWorker&&this.dataSourceWorker.terminate()}getTopicId(){return"datasource-data-"+this.id}};var T=class extends w{constructor(e,t,r){super(e,t,r),o(t,"Some properties must be defined"),o(t.startTime,"startTime must must be defined"),o(t.endTime,"startTime must must be defined"),this.timeSync=null}setDataSynchronizer(e){this.timeSync=e,this.dataSourceWorker.postMessage({message:"topic",topic:"data-synchronizer-"+this.timeSync.id,timeTopic:this.getTimeTopicId()})}initDataSource(e){super.initDataSource(e),this.dataSourceWorker.postMessage({message:"topic",topic:this.getTopicId(),timeTopic:this.getTimeTopicId()})}setTimeRange(e,t,r,s=!1){let n={};i(r)&&(n={replaySpeed:r}),this.updateProperties({...this.currentRunningProperties,startTime:e,endTime:t,...n,reconnect:s})}getStartTime(){return this.properties.startTime}getEndTime(){return this.properties.endTime}getMinTime(){return this.properties.minTime}getMaxTime(){return this.properties.maxTime}getReplaySpeed(){return i(this.properties.replaySpeed)?this.properties.replaySpeed:1}async getCurrentTime(){if(i(this.timeSync))return this.timeSync.getCurrentTime();{const e=new Promise(e=>{null!==this.dataSourceWorker&&(this.dataSourceWorker.onmessage=t=>{"last-timestamp"===t.data.message&&e(t.data.data)})});return null!==this.dataSourceWorker&&this.dataSourceWorker.postMessage({message:"last-timestamp"}),e}}updateProperties(e){super.updateProperties(e)}getTimeTopicId(){return"datasource-time-"+this.id}},C=r(1),I=r.n(C);let D=new class extends T{constructor(e,t){super(e,{timeShift:0,reconnectTimeout:5e3,...t},new I.a)}}("alex-audio",{protocol:"ws",service:"SOS",endpointUrl:"sensiasoft.net:8181/sensorhub/sos",offeringID:"urn:android:device:dd90fceba7fd5b47-sos",observedProperty:"http://sensorml.com/ont/swe/property/AudioFrame",startTime:"2021-03-24T09:56:00Z",endTime:"now",batchSize:500}),k=new S({container:"audio-container",name:"Audio",dataSourceId:D.id});document.getElementById("listen").onclick=()=>{null!==D&&D.disconnect(),null!==k&&k.reset(),D.connect()}}]);