!function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=10)}([function(e,t,i){"use strict";var s,r=function(){return void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s},a=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),n=[];function o(e){for(var t=-1,i=0;i<n.length;i++)if(n[i].identifier===e){t=i;break}return t}function h(e,t){for(var i={},s=[],r=0;r<e.length;r++){var a=e[r],h=t.base?a[0]+t.base:a[0],c=i[h]||0,d="".concat(h," ").concat(c);i[h]=c+1;var m=o(d),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==m?(n[m].references++,n[m].updater(p)):n.push({identifier:d,updater:T(p,t),references:1}),s.push(d)}return s}function c(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var r=i.nc;r&&(s.nonce=r)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var n=a(e.insert||"head");if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(t)}return t}var d,m=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function p(e,t,i,s){var r=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=m(t,r);else{var a=document.createTextNode(r),n=e.childNodes;n[t]&&e.removeChild(n[t]),n.length?e.insertBefore(a,n[t]):e.appendChild(a)}}function u(e,t,i){var s=i.css,r=i.media,a=i.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var l=null,g=0;function T(e,t){var i,s,r;if(t.singleton){var a=g++;i=l||(l=c(t)),s=p.bind(null,i,a,!1),r=p.bind(null,i,a,!0)}else i=c(t),s=u.bind(null,i,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var i=h(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<i.length;s++){var r=o(i[s]);n[r].references--}for(var a=h(e,t),c=0;c<i.length;c++){var d=o(i[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}i=a}}}},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",s=e[3];if(!s)return i;if(t&&"function"==typeof btoa){var r=(n=s,o=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(h," */")),a=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[i].concat(a).concat([r]).join("\n")}var n,o,h;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,s){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(s)for(var a=0;a<this.length;a++){var n=this[a][0];null!=n&&(r[n]=!0)}for(var o=0;o<e.length;o++){var h=[].concat(e[o]);s&&r[h[0]]||(i&&(h[2]?h[2]="".concat(i," and ").concat(h[2]):h[2]=i),t.push(h))}},t}},function(e,t,i){var s=i(0),r=i(9);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1},n=(s(r,a),r.locals?r.locals:{});e.exports=n},function(e,t,i){e.exports=function(){return new Worker(i.p+"WorkerName.b04f2f8cdd10633386cb.js")}},function(e,t,i){e.exports=function(){return new Worker(i.p+"WorkerName.16bf42c8177010c1532c.js")}},function(e,t,i){e.exports=function(){return new Worker(i.p+"WorkerName.78f197fe4f480c3e263a.js")}},function(e,t,i){e.exports=function(){return new Worker(i.p+"WorkerName.700516bd551ae0d05417.js")}},function(e,t,i){var s=i(0),r=i(8);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1},n=(s(r,a),r.locals?r.locals:{});e.exports=n},function(e,t,i){(t=i(1)(!1)).push([e.i,".osh-view {\n    width:100%;\n    height: 100%;\n}\n",""]),e.exports=t},function(e,t,i){(t=i(1)(!1)).push([e.i,".ffmpeg-info{\n    position:absolute;\n    font-size: 12px;\n    color:#FFFFFF;\n    padding:2px;\n    font-weight: bold;\n    background-color: rgba(0, 0, 0, 0.3);\n    box-shadow: 2px 2px 2px 1px rgba(0, 0, 0, 0.3);\n    z-index: 10;\n}\n",""]),e.exports=t},function(e,t,i){"use strict";i.r(t);const s="replay",r="realTime";Math.pow(2,53);function a(e){return null!=e}function n(e){return a(e)&&null!==e}function o(e,t){return n(e)&&typeof e===t}function h(e,t="letiable"){if(!a(e))throw t+" must be defined";return e}function c(e,t="letiable"){if(!a(e)||!e)throw t;return e}function d(e,t,i="letiable"){if(h(e,i),typeof e!==t)throw i+" must be of type "+t;return e}function m(e,t="letiable"){if(h(e,t),!Array.isArray(e))throw t+" must be an array";return e}function p(e,t){return d(e,"function",t)}function u(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}var g=i(3),T=i.n(g);var y=class{constructor(e){this.worker=e,this.onmessage=null}postMessage(e,t){this.worker.postMessage(e,t)}postMessageWithAck(e,t){const i=crypto.randomUUID();return new Promise((s,r)=>{const a=new AbortController;this.worker.addEventListener("message",e=>{e.data.ackId===i&&(delete e.data.ackId,a.abort(),e.error?r(e.error):s(e.data))},{signal:a.signal}),e.ackId=i,this.worker.postMessage(e,t)})}set onmessage(e){this.worker.onmessage=e}terminate(){this.worker&&this.worker.terminate()}};const S=[];let v=0,f={};var D=class{constructor(e,t){this.id=t.id||"DataSource-"+u(),this.name=e,this.properties=t,this.eventSubscriptionMap={},this.init=void 0,this.mode=r,a(t.mode)&&(this.mode=t.mode)}getId(){return this.id}getName(){return this.name}terminate(){null!==this.dataSourceWorker&&this.dataSourceWorker.terminate()}getTopicId(){return"datasource-data-"+this.id}subscribe(e,t){for(let i=0;i<t.length;i++)t[i]in this.eventSubscriptionMap||(this.eventSubscriptionMap[t[i]]=[]),this.eventSubscriptionMap[t[i]].push(e)}async createWorker(e){return new y(new T.a)}async updateProperties(e){return this.properties={...this.properties,...e},this.dataSourceWorker.postMessageWithAck({message:"update-properties",data:e,dsId:this.id})}async connect(){return await this.checkInit(),this.doConnect()}async getWorker(){return this.id in f||(v=(v+1)%5,a(S[v])||(S[v]=await this.createWorker()),f[this.id]=v),S[f[this.id]]}async initDataSource(e=this.properties){return this.dataSourceWorker=await this.getWorker(),this.dataSourceWorker.postMessageWithAck({message:"init",id:this.id,properties:e,topics:{data:this.getTopicId()},dsId:this.id}).then(()=>{new BroadcastChannel(this.getTopicId()).onmessage=async e=>{await this.handleMessage(e)},this.isInitialized=!0})}async handleMessage(e){const t=e.data.type;if(t in this.eventSubscriptionMap)for(let i=0;i<this.eventSubscriptionMap[t].length;i++)this.eventSubscriptionMap[t][i](e.data)}async checkInit(){return a(this.init)||(this.init=this.initDataSource()),this.init}async doConnect(){return this.dataSourceWorker.postMessageWithAck({message:"connect",dsId:this.id})}async isConnected(){return!!this.init&&(await this.checkInit(),this.dataSourceWorker.postMessageWithAck({message:"is-connected",dsId:this.id}))}async disconnect(){return await this.checkInit(),this.dataSourceWorker.postMessageWithAck({message:"disconnect",dsId:this.id})}async onDisconnect(){}reset(){this.init=void 0}onRemovedDataSource(e){}onAddedDataSource(e){}};var w=class extends D{constructor(e,t){super(e,t),this.dataSynchronizer=void 0,this.properties.version=0}getTimeTopicId(){return"datasource-time-"+this.id}getMode(){return r}getStartTimeAsIsoDate(){return"now"}getStartTimeAsTimestamp(){return Date.now()}getEndTimeAsIsoDate(){return this.getMaxTimeAsTimestamp()}getEndTimeAsTimestamp(){return this.getMaxTimeAsTimestamp()}getMinTimeAsIsoDate(){return"now"}getMaxTimeAsIsoDate(){return"2055-01-01Z"}getMinTimeAsTimestamp(){return Date.now()}getMaxTimeAsTimestamp(){return new Date("2055-01-01Z").toISOString()}setMinTime(e){}setMaxTime(e){}setStartTimestamp(e){}setEndTimestamp(e){}getReplaySpeed(){return 1}setReplaySpeed(e){}setVersion(e){this.properties.version=e}async setDataSynchronizer(e){await this.checkInit();const t="data-synchronizer-"+e.id;return this.dataSynchronizer=e,this.properties.version=this.dataSynchronizer.version(),this.dataSourceWorker.postMessageWithAck({message:"topics",topics:{data:t,time:this.getTimeTopicId(),sync:e.getTimeTopicId()},dsId:this.id})}async removeDataSynchronizer(){return this.dataSourceWorker&&(this.dataSourceWorker.terminate(),this.dataSynchronizer=void 0),this.checkInit()}async disconnect(){return await this.checkInit(),this.dataSourceWorker.postMessageWithAck({message:"disconnect",dsId:this.id})}async doConnect(){return this.dataSourceWorker.postMessageWithAck({message:"connect",startTime:"now",version:this.version(),dsId:this.id})}async initDataSource(e){await super.initDataSource(e);const t={data:this.getTopicId(),time:this.getTimeTopicId()};return this.dataSynchronizer&&(t.sync=dataSynchronizer.getTimeTopicId()),this.dataSourceWorker.postMessageWithAck({message:"topics",topics:t,dsId:this.id}).then(()=>{new BroadcastChannel(this.getTimeTopicId()).onmessage=async e=>{await this.handleTimeMessage(e)}})}async handleTimeMessage(e){const t=e.data.type;if(t in this.eventSubscriptionMap)for(let i=0;i<this.eventSubscriptionMap[t].length;i++)this.eventSubscriptionMap[t][i](e.data)}version(){return this.properties.version}};var x=class extends D{constructor(e,t){super(e,t),this.setMinTime(t.startTime),this.setMaxTime(t.endTime),this.properties.startTimestamp=new Date(t.startTime).getTime(),this.properties.endTimestamp=new Date(t.endTime).getTime(),h(t,"Some properties must be defined"),this.dataSynchronizer=void 0,this.properties.version=0}getTimeTopicId(){return"datasource-time-"+this.id}getMode(){return this.properties.mode}getStartTimeAsIsoDate(){return new Date(this.getStartTimeAsTimestamp()).toISOString()}getStartTimeAsTimestamp(){return this.properties.startTimestamp}getEndTimeAsIsoDate(){return new Date(this.getEndTimeAsTimestamp()).toISOString()}getEndTimeAsTimestamp(){return this.properties.endTimestamp}getMinTimeAsIsoDate(){return new Date(this.getMinTimeAsTimestamp()).toISOString()}getMaxTimeAsIsoDate(){return new Date(this.getMaxTimeAsTimestamp()).toISOString()}getMinTimeAsTimestamp(){return this.properties.minTimestamp}getMaxTimeAsTimestamp(){return this.properties.maxTimestamp}async setMinTime(e){this.properties.minTimestamp=new Date(e).getTime(),await this.computeMinMax()}async setMaxTime(e){this.properties.maxTimestamp=new Date(e).getTime(),await this.computeMinMax()}async setStartTimestamp(e){this.properties.startTimestamp=e,await this.computeMinMax()}async setEndTimestamp(e){this.properties.endTimestamp=e,this.computeMinMax()}async setStartTime(e){await this.setStartTimestamp(new Date(e).getTime())}async setEndTime(e){await this.setEndTimestamp(new Date(e).getTime())}getReplaySpeed(){return this.properties.replaySpeed}setReplaySpeed(e){this.properties.replaySpeed=e}setVersion(e){this.properties.version=e}async setDataSynchronizer(e){await this.checkInit();const t="data-synchronizer-"+e.getId();return this.dataSynchronizer=e,this.properties.version=this.dataSynchronizer.version(),this.dataSourceWorker.postMessageWithAck({message:"topics",topics:{data:t,time:this.getTimeTopicId(),sync:e.getTimeTopicId()},dsId:this.id})}async removeDataSynchronizer(){this.dataSourceWorker&&(this.dataSourceWorker.terminate(),this.dataSynchronizer=void 0),this.init=void 0,this.dataSynchronizer=void 0,await this.checkInit()}async disconnect(){if(a(this.init))try{return this.dataSourceWorker.postMessageWithAck({message:"disconnect",dsId:this.id})}catch(e){console.error(e)}}async doConnect(){return this.dataSourceWorker.postMessageWithAck({message:"connect",startTime:this.getStartTimeAsIsoDate(),version:this.version(),dsId:this.id})}async initDataSource(e){await super.initDataSource(e);const t={data:this.getTopicId(),time:this.getTimeTopicId()};return this.dataSynchronizer&&(t.sync=dataSynchronizer.getTimeTopicId()),this.dataSourceWorker.postMessageWithAck({message:"topics",topics:t,dsId:this.id}).then(()=>{new BroadcastChannel(this.getTimeTopicId()).onmessage=async e=>{await this.handleTimeMessage(e)}})}async handleTimeMessage(e){const t=e.data.type;if(t in this.eventSubscriptionMap)for(let i=0;i<this.eventSubscriptionMap[t].length;i++)this.eventSubscriptionMap[t][i](e.data)}version(){return this.properties.version}computeMinMax(){this.properties.startTimestamp<this.properties.minTimestamp&&(this.properties.startTimestamp=this.properties.minTimestamp),this.properties.endTimestamp>this.properties.maxTimestamp&&(this.properties.endTimestamp=this.properties.maxTimestamp)}async setTimeRange(e=this.getStartTimeAsIsoDate(),t=this.getEndTimeAsIsoDate(),i=this.getReplaySpeed(),s=!1,r=this.getMode(),a=this.version()){return await this.checkInit(),a!==this.version()&&(this.properties.version=a),this.properties.startTimestamp=new Date(e).getTime(),this.properties.endTimestamp=new Date(t).getTime(),this.computeMinMax(),this.updateProperties({startTime:this.getStartTimeAsIsoDate(),endTime:this.getEndTimeAsIsoDate(),replaySpeed:i,reconnect:s,mode:r,version:a})}};var A=class{constructor(e,t){const i=u();this.timeSeriesRealtimeDataSource=new w(e,{id:i,...t}),this.timeSeriesReplayDataSource=new x(e,{id:i,...t}),this.setMode(t.mode)}async setMode(e){this.timeSeriesDataSource&&await this.timeSeriesDataSource.disconnect(),this.timeSeriesDataSource&&e===this.timeSeriesDataSource.getMode()||(this.timeSeriesDataSource=e===r?this.timeSeriesRealtimeDataSource:this.timeSeriesReplayDataSource,this.properties=this.timeSeriesDataSource.properties,this.id=this.timeSeriesDataSource.id,this.name=this.timeSeriesDataSource.name,this.properties.mode=e)}getTimeTopicId(){return this.timeSeriesDataSource.getTimeTopicId()}getMode(){return this.timeSeriesDataSource.getMode()}setVersion(e){this.timeSeriesDataSource.setVersion(e)}getStartTimeAsIsoDate(){return this.timeSeriesDataSource.getStartTimeAsIsoDate()}getStartTimeAsTimestamp(){return this.timeSeriesDataSource.getStartTimeAsTimestamp()}getEndTimeAsIsoDate(){return this.timeSeriesDataSource.getEndTimeAsIsoDate()}getEndTimeAsTimestamp(){return this.timeSeriesDataSource.getEndTimeAsTimestamp()}getMinTimeAsIsoDate(){return this.timeSeriesDataSource.getMinTimeAsIsoDate()}getMaxTimeAsIsoDate(){return this.timeSeriesDataSource.getMaxTimeAsIsoDate()}getMinTimeAsTimestamp(){return this.timeSeriesDataSource.getMinTimeAsTimestamp()}getMaxTimeAsTimestamp(){return this.timeSeriesDataSource.getMaxTimeAsTimestamp()}setMinTime(e){this.timeSeriesDataSource.setMinTime(e)}setMaxTime(e){this.timeSeriesDataSource.setMaxTime(e)}setStartTimestamp(e){this.timeSeriesDataSource.setStartTimestamp(e)}setEndTimestamp(e){this.timeSeriesDataSource.setEndTimestamp(e)}setStartTime(e){this.timeSeriesDataSource.setStartTime(e)}setEndTime(e){this.timeSeriesDataSource.setEndTime(e)}getReplaySpeed(){return this.timeSeriesDataSource.getReplaySpeed()}setReplaySpeed(e){this.timeSeriesDataSource.setReplaySpeed(e)}async setDataSynchronizer(e){return this.timeSeriesDataSource.setDataSynchronizer(e)}async removeDataSynchronizer(){return this.timeSeriesDataSource.removeDataSynchronizer()}async disconnect(){return this.timeSeriesDataSource.disconnect()}async doConnect(){return this.timeSeriesDataSource.doConnect()}async initDataSource(e){return this.timeSeriesDataSource.initDataSource(e)}version(){return this.timeSeriesDataSource.version()}async setTimeRange(e=this.getStartTimeAsIsoDate(),t=this.getEndTimeAsIsoDate(),i=this.getReplaySpeed(),s=!1,r=this.getMode(),a=this.version()){return this.timeSeriesDataSource.setTimeRange(e,t,i,s,r,a)}getId(){return this.timeSeriesDataSource.getId()}getName(){return this.timeSeriesDataSource.getName()}terminate(){this.timeSeriesDataSource.terminate()}getTopicId(){return this.timeSeriesDataSource.getTopicId()}subscribe(e,t){this.timeSeriesDataSource.subscribe(e,t)}async updateProperties(e){return this.timeSeriesDataSource.updateProperties(e)}async connect(){return this.timeSeriesDataSource.connect()}async checkInit(){return this.timeSeriesDataSource.checkInit()}async isConnected(){return this.timeSeriesDataSource.isConnected()}reset(){this.timeSeriesDataSource.reset()}onTimeChanged(e,t,i,s){}};var I=class extends A{constructor(e,t){super(e,{protocol:"ws",service:"SOS",timeShift:0,reconnectTimeout:5e3,reconnectRetry:10,tls:!1,type:"SosGetResult",mode:r,prefetchBatchSize:250,prefetchBatchDuration:5e3,...t})}};i(7);const R="closed-error",M="data",b="master-time",E="status",C="time-changed";var k=class{constructor(e){this.layers=[],this.lastRec={},this.dataSources=[],this.broadcastChannels=[],this.id="view-"+u(),this.css="",a(e)&&a(e.css)&&(this.css=e.css),h(e&&e.supportedLayers,"supportedLayers"),m(e.supportedLayers,"supportedLayers"),c(e.supportedLayers.length>0,"supportedLayers.length === 0"),this.supportedLayers=e.supportedLayers,this.init(e)}init(e){this.properties=e,this.elementDiv=document.createElement("div"),this.elementDiv.setAttribute("id",this.id),this.elementDiv.setAttribute("class",this.css+" osh-view"),this.divId=this.id;let t=a(e.container)?e.container:document.body,i=!a(e.destroyAfterMutation)||e.destroyAfterMutation,s=document.getElementById(t);if(a(s)&&null!==s?(s.appendChild(this.elementDiv),this.container=s):(document.body.appendChild(this.elementDiv),this.hide(),this.container=document.body),this.beforeAddingItems(e),a(e)){if(a(e.layers))for(let t=0;t<e.layers.length;t++)this.addLayer(e.layers[t]);a(e.visible)&&(document.getElementById(this.divId).style.display=e.visible?"block":"none")}const r=this;if(new MutationObserver(e=>{e.forEach((function(e){"style"===e.attributeName&&r.onResize()}))}).observe(this.elementDiv,{attributes:!0}),i){new MutationObserver((function(e){a(document.getElementById(r.divId))||(this.disconnect(),r.destroy())})).observe(document.body,{childList:!0})}}hide(){this.elementDiv.style.display="none"}onResize(){}attachTo(e){a(this.elementDiv.parentNode)&&this.elementDiv.parentNode.removeChild(this.elementDiv),document.getElementById(e).appendChild(this.elementDiv),"none"===this.elementDiv.style.display&&(this.elementDiv.style.display="block"),this.onResize()}beforeAddingItems(e){}getId(){return this.id}getDivId(){return this.divId}async setData(e,t){}show(e){}destroy(){this.removeAllFromLayers();for(let e of this.broadcastChannels)e.close(),console.log("closing BC..");this.broadcastChannels=[],a(this.elementDiv)&&this.elementDiv.remove()}addLayer(e){c(this.supportedLayers.includes(e.type),"this layer is not supported: "+e.type+", should be "+this.supportedLayers),this.layers.push(e);let t=e.getDataSourcesIds();for(let i=0;i<t.length;i++){const s=t[i];let r=this;const a=new BroadcastChannel("datasource-data-"+s);a.onmessage=async t=>{if(t.data.type===E&&t.data.status===R)r.reset();else if(t.data.type===M){const i=this;await e.setData(s,t.data.values),await i.setData(s,e.getProps()),r.lastRec[s]=t.data}};const n=new BroadcastChannel("datasource-time-"+s);n.onmessage=e=>{e.data.type===C&&r.reset()},this.broadcastChannels.push(a),this.broadcastChannels.push(n)}}removeAllFromLayer(e){if(this.layers.includes(e)){for(let t in e.dataSourcesToFn)delete this.lastRec[t];e.reset()}}removeAllFromLayers(){for(let e of this.layers)this.removeAllFromLayer(e)}getDataSourcesId(){let e=[];for(let t=0;t<this.layers.length;t++){let i=this.layers[t];e=e.concat(i.getDataSourcesIds())}return e}reset(){this.removeAllFromLayers()}};var F=class extends k{constructor(e){if(super({supportedLayers:["videoData"],...e}),this.timestamp=null,a(e.showTime)&&e.showTime&&(this.timestamp=document.createElement("div"),this.timestamp.setAttribute("class","video-time"),document.getElementById(this.divId).appendChild(this.timestamp)),this.imgTag=document.createElement("img"),this.imgTag.setAttribute("class","video-mjpeg"),this.rotation=0,void 0!==e&&void 0!==e.rotation){this.rotation=e.rotation*Math.PI/180,this.canvas=document.createElement("canvas"),this.canvas.width=640,this.canvas.height=480;var t=this.canvas.getContext("2d");t.translate(0,480),t.rotate(this.rotation),document.getElementById(this.divId).appendChild(this.canvas)}else document.getElementById(this.divId).appendChild(this.imgTag)}async setData(e,t){if("videoData"===t.type){const e=t.values;for(let t=0;t<e.length;t++)this.updateVideo(e[t])}}updateVideo(e){let t=new Blob([e.frameData.data]),i=window.URL.createObjectURL(t),s=this.imgTag.src;this.imgTag.src=i,null!==this.timestamp&&(this.timestamp.innerHTML=new Date(e.timestamp).toISOString()),window.URL.revokeObjectURL(s)}selectDataView(e,t){e.indexOf(this.dataSourceId)>-1||a(this.entity)&&this.entity.getId()===t?document.getElementById(this.divId).setAttribute("class",this.css+" "+this.cssSelected):document.getElementById(this.divId).setAttribute("class",this.css)}reset(){this.imgTag.src=""}async getCanvas(){return this.canvas}};i(2);var P=class extends k{constructor(e){super(e),this.fps=0,this.width=1920,this.height=1080,this.showTime=!1,this.showStats=!1,this.statistics={averageFps:0,frames:0,firstTime:0,bitRate:0,averageBitRate:0},this.framerate=29.67,a(e)&&(a(e.framerate)&&(this.framerate=e.framerate),a(e.directPlay)&&(this.directPlay=e.directPlay),a(e.codec)&&(this.codec=e.codec),a(e.showTime)&&(this.showTime=e.showTime),a(e.showStats)&&(this.showStats=e.showStats),a(e.width)&&(this.width=e.width),a(e.height)&&(this.height=e.height));let t,i,s=document.getElementById(this.divId);(this.showTime||this.showStats)&&(this.textDiv=document.createElement("div"),this.textDiv.setAttribute("width",""+this.width),this.textDiv.setAttribute("height",15),this.textDiv.setAttribute("class","ffmpeg-info"),this.showTime&&(this.textFpsDiv=document.createElement("div"),this.textFpsDiv.setAttribute("class","ffmpeg-fps"),this.textDiv.appendChild(this.textFpsDiv)),this.showStats&&(this.textStatsDiv=document.createElement("div"),this.textStatsDiv.setAttribute("class","ffmpeg-stats"),this.textDiv.appendChild(this.textStatsDiv)),s.appendChild(this.textDiv)),this.domNode=s,a(document.hidden)?(t="hidden",i="visibilitychange"):a(document.msHidden)?(t="msHidden",i="msvisibilitychange"):a(document.webkitHidden)&&(t="webkitHidden",i="webkitvisibilitychange");const r=this;document.addEventListener(i,(function(){document.hidden?r.skipFrame=!0:r.skipFrame=!1}),!1)}updateStatistics(e){if(this.statistics.frames++,this.statistics.pktSize+=e,0===this.statistics.firstTime)return void(this.statistics.firstTime=performance.now());const t=performance.now();t-this.statistics.firstTime<1e3||(this.statistics.averageFps=(this.statistics.frames-1)/((t-this.statistics.firstTime)/1e3),this.statistics.averageBitRate=(this.statistics.pktSize-e)/((t-this.statistics.firstTime)/1e3),this.statistics.frames=1,this.statistics.pktSize=e,this.statistics.firstTime=t)}onUpdated(e){}destroy(){super.destroy()}onAfterDecoded(e,t){}};const z="array";var W=class extends P{constructor(e){if(super({supportedLayers:["videoData"],...e}),!1 in window)throw Error("WebCodec API is not supported");if(this.codecMap={vp9:"vp09.02.10.10.01.09.16.09.01",vp8:"vp08.00.41.08",h264:"avc1.42e01e",h265:"hev1.1.6.L123.00"},this.codec=this.codecMap.h264,a(e.codec)){if(!e.codec in this.codecMap)throw Error("The codec properties.codec is not supported, the list of supported codec: this.codecMap");this.codec=this.codecMap[e.codec]}this.compression=e.codec,this.canvasElt=this.createCanvas(this.width,this.height),this.domNode.appendChild(this.canvasElt),this.queue=[]}createCanvas(e,t,i){const s=document.createElement("canvas");return s.setAttribute("width",e),s.setAttribute("height",t),a(i)&&s.setAttribute("style",i),s}updateCanvasSize(e,t){this.canvasElt.width=e,this.canvasElt.height=t}async setData(e,t){if("videoData"===t.type){const e=t.values;for(let t=0;t<e.length;t++)await this.updateVideo(e[t])}}async updateVideo(e){this.skipFrame||(this.codecConfigured||(this.codec=this.codecMap[e.frameData.compression.toLowerCase()],this.initDecoder()),await this.decode(e.frameData.data.length,e.frameData.data,e.timestamp,e.roll||0))}reset(){}initDecoder(){this.gl=this.canvasElt.getContext("bitmaprenderer");const e={output:async e=>{let t=!1;this.width===e.codedWidth&&this.height===e.codedHeight||(this.width=e.codedWidth,this.height=e.codedHeight,this.updateCanvasSize(this.width,this.height),t=!0),("closed"===this.videoDecoder.state||t)&&this.videoDecoder.configure({codec:this.codec,codedWidth:this.width,codedHeight:this.height});const i=await createImageBitmap(e);try{await this.handleDocodedFrame(i,this.width,this.height,e.timestamp,this.queue.shift())}finally{e.close()}},error:e=>{this.queue.shift(),console.error(e),"closed"===this.videoDecoder.state&&this.initDecoder()}};try{this.videoDecoder=new VideoDecoder(e),this.videoDecoder.configure({codec:this.codec,codedWidth:this.width,codedHeight:this.height}),this.codecConfigured=!0}catch(e){throw this.elementDiv.remove(),Error("Cannot configure WebCodec API VideoDecoder")}}async handleDocodedFrame(e,t,i,s=0,r=null){try{let a=90*Math.round(r.roll/90);a>180&&(a-=360);let n=1;90===Math.abs(a)&&(n=this.height/this.width);const o=a*Math.PI/180;(this.angleRad&&this.angleRad!==o||this.scale&&this.scale!==n||!this.angleRad||!this.scale)&&(this.canvasElt.style=`transform:rotate(${o}rad) scale(${n})`,this.angleRad=o,this.scale=n),this.gl.transferFromImageBitmap(e),this.onAfterDecoded(e,z),this.updateStatistics(r.pktSize),this.showTime&&(this.textFpsDiv.innerText=new Date(s).toISOString()+" "),this.showStats&&(this.textStatsDiv.innerText=this.statistics.averageFps.toFixed(2)+" fps, "+(this.statistics.averageBitRate/1e3).toFixed(2)+" kB/s @"+t+"x"+i+"\n "+this.compression),this.onUpdated(this.statistics)}catch(e){console.error(e)}}async decode(e,t,i,s){if(this.codecConfigured){let r=!1;this.codec===this.codecMap.h264&&(r=101===t[26]&&1===t[25]&&0===t[24]&&0===t[23]),this.queue.push({roll:s,pktSize:e});let a=new EncodedVideoChunk({timestamp:i,type:r?"key":"delta",data:t});this.videoDecoder.decode(a)}else console.warn("decoder has not been initialized yet")}destroy(){super.destroy()}async getCanvas(){return this.canvasElt}},B=i(4),L=i.n(B);var _=class{constructor(e){e=e||{},this.canvasElement=e.canvas||document.createElement("canvas"),this.canvasElement.setAttribute("id",u()),this.contextOptions=e.contextOptions,this.type=e.type||"yuv420",this.customYUV444=e.customYUV444,this.conversionType=e.conversionType||"rec601",this.width=e.width||640,this.height=e.height||320,this.animationTime=e.animationTime||0,this.canvasElement.width=this.width,this.canvasElement.height=this.height,this.init()}init(){this.initContextGL(),this.contextGL&&(this.initProgram(),this.initBuffers(),this.initTextures()),"yuv420"===this.type?(this.drawNextOuptutPictureGL=e=>{var t=this.contextGL,i=this.texturePosBuffer,s=this.uTexturePosBuffer,r=this.vTexturePosBuffer,a=this.yTextureRef,n=this.uTextureRef,o=this.vTextureRef,h=e.yData,c=e.uData,d=e.vData,m=this.width,p=this.height,u=e.yDataPerRow||m,l=e.yRowCnt||p,g=e.uDataPerRow||m/2,T=e.uRowCnt||p/2,y=e.vDataPerRow||g,S=e.vRowCnt||T;let v=90*Math.round(e.roll/90);v>180&&(v-=360),90==Math.abs(v)?(this.canvasElement.width=this.height,this.canvasElement.height=this.width,t.viewport(0,0,p,m)):(this.canvasElement.width=this.width,this.canvasElement.height=this.height,t.viewport(0,0,m,p));var f=p/l,D=m/u,w=new Float32Array([D,0,0,0,D,f,0,f]);t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,w,t.DYNAMIC_DRAW),this.customYUV444?(f=p/T,D=m/g):(f=p/2/T,D=m/2/g);var x=new Float32Array([D,0,0,0,D,f,0,f]);t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,x,t.DYNAMIC_DRAW),this.customYUV444?(f=p/S,D=m/y):(f=p/2/S,D=m/2/y);var A=new Float32Array([D,0,0,0,D,f,0,f]);t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,A,t.DYNAMIC_DRAW),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,u,l,0,t.LUMINANCE,t.UNSIGNED_BYTE,h),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,g,T,0,t.LUMINANCE,t.UNSIGNED_BYTE,c),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,o),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,y,S,0,t.LUMINANCE,t.UNSIGNED_BYTE,d),t.uniform1f(this.rollUniform,v*Math.PI/180),t.drawArrays(t.TRIANGLE_STRIP,0,4)},this.drawNextOuptutPictureBitmapGL=e=>{var t=this.contextGL,i=this.texturePosBuffer,s=this.yTextureRef,r=e.yData,a=this.width,n=this.height,o=n/n,h=a/a,c=new Float32Array([h,0,0,0,h,o,0,o]);let d=90*Math.round(e.roll/90);d>180&&(d-=360),90==Math.abs(d)?(this.canvasElement.width=this.height,this.canvasElement.height=this.width,t.viewport(0,0,n,a)):(this.canvasElement.width=this.width,this.canvasElement.height=this.height,t.viewport(0,0,a,n)),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,c,t.DYNAMIC_DRAW),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1f(this.rollUniform,d*Math.PI/180),t.drawArrays(t.TRIANGLE_STRIP,0,4)}):"yuv422"===this.type&&(this.drawNextOuptutPictureGL=e=>{var t=this.contextGL,i=this.texturePosBuffer,s=this.textureRef,r=e.data,a=this.width,n=this.height,o=e.dataPerRow||2*a,h=e.rowCnt||n;t.viewport(0,0,a,n);var c=n/h,d=a/(o/2),m=new Float32Array([d,0,0,0,d,c,0,c]);t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,m,t.DYNAMIC_DRAW),t.uniform2f(t.getUniformLocation(this.shaderProgram,"resolution"),o,n),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,o,h,0,t.LUMINANCE,t.UNSIGNED_BYTE,r),t.drawArrays(t.TRIANGLE_STRIP,0,4)})}isWebGL(){return this.contextGL}initContextGL(){for(var e=this.canvasElement,t=null,i=["webgl","experimental-webgl","moz-webgl","webkit-3d"],s=0;!t&&s<i.length;){var r=i[s];try{t=this.contextOptions?e.getContext(r,this.contextOptions):e.getContext(r)}catch(e){t=null}t&&"function"==typeof t.getParameter||(t=null),++s}this.contextGL=t}initProgram(){var e,t,i=this.contextGL;"yuv420"===this.type?(e=["attribute vec4 vertexPos;","attribute vec4 texturePos;","attribute vec4 uTexturePos;","attribute vec4 vTexturePos;","varying vec2 textureCoord;","varying vec2 uTextureCoord;","varying vec2 vTextureCoord;","uniform float roll;","void main()","{","  vec4 ctr = vec4(0.5, 0.5, 0, 0);","  mat4 rotMatrix = mat4( cos(roll), -sin(roll), 0, 0,","                         sin(roll),  cos(roll), 0, 0,","                         0,          0,         1, 0,","                         0,          0,         0, 1);","  gl_Position = vertexPos;","  textureCoord = mat2(rotMatrix) * (texturePos.xy - vec2(ctr)) + vec2(ctr);","  uTextureCoord = mat2(rotMatrix) * (uTexturePos.xy - vec2(ctr)) + vec2(ctr);","  vTextureCoord = mat2(rotMatrix) * (vTexturePos.xy - vec2(ctr)) + vec2(ctr);","}"].join("\n"),t=["precision highp float;","varying highp vec2 textureCoord;","varying highp vec2 uTextureCoord;","varying highp vec2 vTextureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","uniform mat4 YUV2RGB;","void main(void) {","  highp float y = texture2D(ySampler,  textureCoord).r;","  highp float u = texture2D(uSampler,  uTextureCoord).r;","  highp float v = texture2D(vSampler,  vTextureCoord).r;","  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n")):"yuv422"===this.type&&(e=["attribute vec4 vertexPos;","attribute vec4 texturePos;","varying vec2 textureCoord;","void main()","{","  gl_Position = vertexPos;","  textureCoord = texturePos.xy;","}"].join("\n"),t=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D sampler;","uniform highp vec2 resolution;","uniform mat4 YUV2RGB;","void main(void) {","  highp float texPixX = 1.0 / resolution.x;","  highp float logPixX = 2.0 / resolution.x;","  highp float logHalfPixX = 4.0 / resolution.x;","  highp float steps = floor(textureCoord.x / logPixX);","  highp float uvSteps = floor(textureCoord.x / logHalfPixX);","  highp float y = texture2D(sampler, vec2((logPixX * steps) + texPixX, textureCoord.y)).r;","  highp float u = texture2D(sampler, vec2((logHalfPixX * uvSteps), textureCoord.y)).r;","  highp float v = texture2D(sampler, vec2((logHalfPixX * uvSteps) + texPixX + texPixX, textureCoord.y)).r;","  gl_FragColor = vec4(y, u, v, 1.0) * YUV2RGB;","}"].join("\n"));var s=[];s="rec709"===this.conversionType?[1.16438,0,1.79274,-.97295,1.16438,-.21325,-.53291,.30148,1.16438,2.1124,0,-1.1334,0,0,0,1]:[1.16438,0,1.59603,-.87079,1.16438,-.39176,-.81297,.52959,1.16438,2.01723,0,-1.08139,0,0,0,1];var r=i.createShader(i.VERTEX_SHADER);i.shaderSource(r,e),i.compileShader(r),i.getShaderParameter(r,i.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+i.getShaderInfoLog(r));var a=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(a,t),i.compileShader(a),i.getShaderParameter(a,i.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+i.getShaderInfoLog(a));var n=i.createProgram();i.attachShader(n,r),i.attachShader(n,a),i.linkProgram(n),i.getProgramParameter(n,i.LINK_STATUS)||console.log("Program failed to compile: "+i.getProgramInfoLog(n)),i.useProgram(n);var o=i.getUniformLocation(n,"YUV2RGB");i.uniformMatrix4fv(o,!1,s),this.rollUniform=i.getUniformLocation(n,"roll"),this.shaderProgram=n}initBuffers(){var e=this.contextGL,t=this.shaderProgram,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW);var s=e.getAttribLocation(t,"vertexPos");if(e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),this.animationTime){var r=this.animationTime,a=0,n=function(){var i=1*(a+=15)/r;a>=r?i=1:setTimeout(n,15);var s=-1*i,o=1*i,h=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,new Float32Array([o,o,s,o,o,s,s,s]),e.STATIC_DRAW);var c=e.getAttribLocation(t,"vertexPos");e.enableVertexAttribArray(c),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0);try{e.drawArrays(e.TRIANGLE_STRIP,0,4)}catch(e){}};n()}var o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW);var h=e.getAttribLocation(t,"texturePos");if(e.enableVertexAttribArray(h),e.vertexAttribPointer(h,2,e.FLOAT,!1,0,0),this.texturePosBuffer=o,"yuv420"===this.type){var c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW);var d=e.getAttribLocation(t,"uTexturePos");e.enableVertexAttribArray(d),e.vertexAttribPointer(d,2,e.FLOAT,!1,0,0),this.uTexturePosBuffer=c;var m=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,m),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),e.STATIC_DRAW);var p=e.getAttribLocation(t,"vTexturePos");e.enableVertexAttribArray(p),e.vertexAttribPointer(p,2,e.FLOAT,!1,0,0),this.vTexturePosBuffer=m}}initTextures(){var e=this.contextGL,t=this.shaderProgram;if("yuv420"===this.type){var i=this.initTexture(),s=e.getUniformLocation(t,"ySampler");e.uniform1i(s,0),this.yTextureRef=i;var r=this.initTexture(),a=e.getUniformLocation(t,"uSampler");e.uniform1i(a,1),this.uTextureRef=r;var n=this.initTexture(),o=e.getUniformLocation(t,"vSampler");e.uniform1i(o,2),this.vTextureRef=n}else if("yuv422"===this.type){var h=this.initTexture(),c=e.getUniformLocation(t,"sampler");e.uniform1i(c,0),this.textureRef=h}}initTexture(){var e=this.contextGL,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),t}drawNextOutputPicture(e,t,i,s){this.contextGL?this.drawNextOuptutPictureGL(e,t,i,s):this.drawNextOuptutPictureRGBA(e,t,i,s)}drawNextOuptutPictureRGBA(e,t,i,s){var r=s,a=this.canvasElement.getContext("2d"),n=a.getImageData(0,0,e,t);n.data.set(r),null===i?a.putImageData(n,0,0):a.putImageData(n,-i.left,-i.top,0,0,i.width,i.height)}resize(e,t){this.canvasElement.width=e,this.canvasElement.height=t,this.width=e,this.height=t}};var U=class extends P{constructor(e){super({supportedLayers:["videoData"],...e}),this.directPlay=!1,this.codec="h264",this.yuvCanvas=this.createCanvas(this.width,this.height),this.domNode.appendChild(this.yuvCanvas.canvasElement),this.buf=[],this.bufferingTime=2e3}createCanvas(e,t,i){return new _({width:e,height:t,contextOptions:{preserveDrawingBuffer:!0}})}async setData(e,t){if("videoData"===t.type){const e=t.values;for(let t=0;t<e.length;t++)this.updateVideo(e[t])}}async updateVideo(e){if(!this.skipFrame)return null==this.decodeWorker&&this.initFFMPEG_DECODER_WORKER(e.frameData.compression),this.decode(e.frameData.data.length,e.frameData.data,e.timestamp,e.roll||0)}reset(){this.skipFrame=!0,this.decodeWorker&&this.decodeWorker.postMessage({message:"release"});let e=new Uint8Array(1);e[0]=128,this.yuvCanvas.drawNextOuptutPictureGL({yData:e,yDataPerRow:1,yRowCnt:1,uData:e,uDataPerRow:1,uRowCnt:1,vData:e,vDataPerRow:1,vRowCnt:1}),this.skipFrame=!1}initFFMPEG_DECODER_WORKER(e){this.decodeWorker=new L.a,this.decodeWorker.id=u(),this.decodeWorker.postMessage({message:"init",codec:e.toLowerCase()});const t=this;this.decodeWorker.onmessage=function(e){let i=e.data;t.drawFrame(i),this.onAfterDecoded(i,z),this.updateStatistics(i.pktSize),this.showTime&&(this.textFpsDiv.innerText=new Date(i.timestamp).toISOString()+" "),this.showStats&&(this.textStatsDiv.innerText=this.statistics.averageFps.toFixed(2)+" fps, "+(this.statistics.averageBitRate/1e3).toFixed(2)+" kB/s @"+t.yuvCanvas.width+"x"+t.yuvCanvas.height+"\n "+this.codec),this.onUpdated(this.statistics)}.bind(this)}drawFrame(e){this.yuvCanvas.canvasElement.drawing=!0,this.width===e.frame_width&&this.height===e.frame_height||(this.yuvCanvas.resize(e.frame_width,e.frame_height),this.width=e.frame_width,this.height=e.frame_height),this.yuvCanvas.drawNextOuptutPictureGL({yData:e.frameYData,yDataPerRow:e.frame_width,yRowCnt:e.frame_height,uData:e.frameUData,uDataPerRow:e.frame_width/2,uRowCnt:e.frame_height/2,vData:e.frameVData,vDataPerRow:e.frame_width/2,vRowCnt:e.frame_height/2,roll:e.roll}),this.yuvCanvas.canvasElement.drawing=!1}async decode(e,t,i,s){if(e>0){let r=t.buffer;this.decodeWorker.postMessage({message:"data",pktSize:e,pktData:r,roll:s,byteOffset:t.byteOffset,codec:this.codec,timestamp:i,dataSourceId:this.dataSourceId},[r]),t=null}}destroy(){super.destroy(),a(this.decodeWorker)&&(this.decodeWorker.postMessage({message:"release"}),this.decodeWorker.terminate())}async getCanvas(){return this.yuvCanvas.canvasElement}drawBlank(){let e=new Uint8Array(1);this.yuvCanvas.drawNextOuptutPictureGL({yData:e,yDataPerRow:1,yRowCnt:1,uData:e,uDataPerRow:1,uRowCnt:1,vData:e,vDataPerRow:1,vRowCnt:1})}};var N=class extends k{constructor(e){super({supportedLayers:["videoData"],...e}),this.videoView=void 0,this.canvasResolve=void 0,this.useWebCodecApi=!0,"useWebCodecApi"in e&&(this.useWebCodecApi=e.useWebCodecApi)}createVideoView(e){if("jpeg"===e)this.videoView=new F({...this.properties,layers:[]});else if("h265"!==e&&this.useWebCodecApi)try{this.videoView=new W({...this.properties,codec:e,layers:[]}),this.videoView.initDecoder()}catch(t){this.videoView=new U({...this.properties,codec:e,layers:[]})}else this.videoView=new U({...this.properties,codec:e,layers:[]});this.hide(),this.canvasResolve&&this.canvasResolve(this.videoView.getCanvas()),this.videoView.onAfterDecoded=(e,t)=>{this.onDecode(e,t)}}async setData(e,t){if("videoData"===t.type){const e=t.values;for(let t=0;t<e.length;t++)a(this.videoView)||this.createVideoView(e[t].frameData.compression.toLowerCase()),await this.videoView.updateVideo(e[t])}}async getVideoCanvas(){if(a(this.videoView))return this.videoView.getCanvas();{const e=this;return new Promise(async t=>{e.canvasResolve=t})}}reset(){super.reset(),a(this.videoView)&&this.videoView.reset()}destroy(){console.warn("Destroying VideoView"),super.destroy(),a(this.videoView)&&this.videoView.destroy()}onDecode(e,t){}};var O=class{constructor(e){this.properties=e,this.init(e)}init(e=this.properties){if(this.data=[],this.propsById={},this.dataSourcesToFn=void 0,this.props={id:"layer-"+u(),filter:!0,name:"",description:"",visible:!0,timestamp:!0},this.dataSourceIds=void 0,a(e.name)&&(this.props.name=e.name),a(e.description)&&(this.props.description=e.description),a(e.dataSourceId)&&(this.dataSourceIds=[e.dataSourceId]),a(e.dataSourceIds)&&(this.dataSourceIds=e.dataSourceIds),this.dataSourceIds||(this.dataSourceIds=[]),a(e.visible)&&(this.props.visible=e.visible),a(e.timestamp)&&(this.props.timestamp=e.timestamp),a(e.onLeftClick)&&p(e.onLeftClick)&&(this.props.onLeftClick=e.onLeftClick),a(e.onRightClick)&&p(e.onRightClick)&&(this.props.onRightClick=e.onRightClick),a(e.onHover)&&p(e.onHover)&&(this.props.onHover=e.onHover),this.initEvents(),this.checkFn("filter")){let e=(e,t,i)=>{this.props.filter=this.getFunc("filter")(e,t,i)};this.addFn(this.getDataSourcesIdsByProperty("filter"),e)}else{this.properties.filter=function(e,t,i){return!0};let e=async(e,t,i)=>{this.props.filter=await this.getFunc("filter")(e,t,i)};this.addFn(this.getDataSourcesIdsByProperty("filter"),e)}if(this.checkFn("getVisible")){let e=async(e,t,i)=>{this.updateProperty("visible",await this.getFunc("getVisible")(e,t,i))};this.addFn(this.getDataSourcesIdsByProperty("getVisible"),e)}if(this.checkFn("getTimestamp")){let e=async(e,t,i)=>{this.updateProperty("timestamp",await this.getFunc("getTimestamp")(e,t,i))};this.addFn(this.getDataSourcesIdsByProperty("getTimestamp"),e)}if(this.checkFn("getName")){let e=async(e,t,i)=>{this.updateProperty("name",await this.getFunc("getName")(e,t,i))};this.addFn(this.getDataSourcesIdsByProperty("getName"),e)}if(this.checkFn("getDescription")){let e=async(e,t,i)=>{this.updateProperty("description",await this.getFunc("getDescription")(e,t,i))};this.addFn(this.getDataSourcesIdsByProperty("getDescription"),e)}}getFunc(e){return this.properties[e].handler||this.properties[e]}checkFn(e){let t=this.properties[e];if(o(t,"function"))return h(this.dataSourceIds,"dataSourceIds"),!0;{let i=n(t);return i&&(m(t.dataSourceIds,e+".dataSourceIds"),p(t.handler,e+".handler")),i}}initEvents(){}clear(){}getId(){return this.props.id}select(e){}addFn(e,t,i=!1){a(this.dataSourcesToFn)||(this.dataSourcesToFn={});for(let s=0;s<e.length;s++){let r=e[s];a(this.dataSourcesToFn[r])||(this.dataSourcesToFn[r]=[]),i?this.dataSourcesToFn[r].unshift(t):this.dataSourcesToFn[r].push(t)}}async setData(e,t,i={}){if(this.data=[],i.dataSourceId=e,a(this.dataSourcesToFn)&&e in this.dataSourcesToFn){let s=this.dataSourcesToFn[e];this.props.filter=!0;for(let e=0;e<t.length;e++){for(let r=0;r<s.length&&(await s[r](t[e].data,t[e].data.timestamp,i),this.props.filter);r++);this.props.filter&&this.data.push({...this.props,...this.propsById[this.getId()]})}}}getDataSourcesIds(){if(a(this.dataSourcesToFn)){let e=[];for(let t in this.dataSourcesToFn)e.push(t);return e}return h(this.dataSourceIds,"dataSourceId must be defined"),this.dataSourceIds}getDataSourcesIdsByProperty(e){return this.properties[e].dataSourceIds||this.dataSourceIds}getProps(){return{type:this.type,values:this.data}}reset(){this.init(this.properties)}updateProperty(e,t){this.propsById[this.getId()][e]=t}checkExistingProps(e){return e in this.propsById}setProps(e,t){this.propsById[e]=t}setId(e,t){this.props.id=e,this.checkExistingProps(e)||this.setProps(e,t())}definedId(e,t){if(this.checkFn("get"+l(e))){let i=async(i,s,r)=>{const a=await this.getFunc("get"+l(e))(i,s,r);this.setId(a,()=>({...t,[e]:a}))};this.addFn(this.getDataSourcesIdsByProperty("get"+l(e)),i,!0)}else this.setId(this.getId(),()=>({...t,[e]:this.getId()}))}getCurrentProps(){return this.propsById[this.getId()]}getIds(){return Object.keys(this.propsById)}};var V=class extends O{constructor(e){super(e),this.type="binaryData"}init(e=this.properties){super.init(e);const t={frameData:void 0};if(a(e.frameData)&&(this.props.frameData=e.frameData),this.definedId("dataId",t),a(e.getFrameData)){let e=async(e,t,i)=>{this.updateProperty("frameData",await this.getFunc("getFrameData")(e,t,i))};this.addFn(this.getDataSourcesIdsByProperty("getFrameData"),e)}}};var G=class extends V{constructor(e){super(e),this.type="videoData"}init(e=this.properties){super.init(e);const t={roll:0};if(a(e.roll)&&(t.roll=e.roll),this.definedId("videoDataId",t),a(e.getRoll)){let e=async(e,t,i)=>{this.updateProperty("roll",await this.getFunc("getRoll")(e,t,i))};this.addFn(this.getDataSourcesIdsByProperty("getRoll"),e)}}},Y=i(5),X=i.n(Y);var j=class{constructor(e,t){this.bufferingTime=1e3,this.id=e.id||u(),this.dataSources=e.dataSources||[],this.replaySpeed=e.replaySpeed||1,this.timerResolution=e.timerResolution||5,this.masterTimeRefreshRate=e.masterTimeRefreshRate||250,this.initialized=!1,this.timeSync=t,this.properties={},this.properties.replaySpeed=this.replaySpeed,this.properties.startTimestamp=void 0,this.properties.endTimestamp=void 0,this.properties.minTimestamp=void 0,this.properties.maxTimestamp=void 0,this.properties.version=0,a(e)&&(a(e.minTime)&&(this.minTimestamp=new Date(e.minTime).getTime()),a(e.maxTime)&&(this.maxTimestamp=new Date(e.maxTime).getTime())),this.computeMinMax()}getId(){return this.id}getTopicId(){return"data-synchronizer-"+this.id}getTimeTopicId(){return"data-synchronizer-time-"+this.id}getDataSources(){return this.dataSources}computeMinMax(){if(this.dataSources.length>0){let e=Number.MAX_VALUE,t=Number.MIN_VALUE;for(let i of this.dataSources){let s=i.getMinTimeAsTimestamp(),r=i.getMaxTimeAsTimestamp();s<e&&(e=s),r>t&&(t=r)}a(this.minTimestamp)&&this.minTimestamp>e&&(e=this.minTimestamp),a(this.maxTimestamp)&&this.maxTimestamp>t&&(t=this.maxTimestamp),this.properties.minTimestamp=e,this.properties.maxTimestamp=t}else{const e=new Date("1970-01-01T00:00:00Z").getTime(),t=new Date("2055-01-01T00:00:00Z").getTime();this.properties.minTimestamp=this.properties.startTimestamp=e,this.properties.maxTimestamp=this.properties.endTimestamp=t}}getStartTimeAsIsoDate(){return this.properties.startTimestamp?new Date(this.properties.startTimestamp).toISOString():this.getMinTimeAsIsoDate()}getStartTimeAsTimestamp(){return this.properties.startTimestamp}getEndTimeAsIsoDate(){return this.properties.endTimestamp?new Date(this.properties.endTimestamp).toISOString():this.getMaxTimeAsIsoDate()}getEndTimeAsTimestamp(){return this.properties.endTimestamp}getMinTimeAsIsoDate(){return new Date(this.properties.minTimestamp).toISOString()}getMinTimeAsTimestamp(){return this.properties.minTimestamp}getMaxTimeAsIsoDate(){return new Date(this.properties.maxTimestamp).toISOString()}getMaxTimeAsTimestamp(){return this.properties.maxTimestamp}async setStartTime(e,t=!1){this.properties.startTimestamp=new Date(e).getTime(),t||await this.updateAlgo()}async setEndTime(e,t=!1){this.properties.endTimestamp=new Date(e).getTime(),t||await this.updateAlgo()}async setMinTime(e,t=!1){this.minTimestamp=new Date(e).getTime(),this.computeMinMax(),this.timeChanged()}async setMaxTime(e,t=!1){this.maxTimestamp=new Date(e).getTime(),this.computeMinMax(),this.timeChanged()}getReplaySpeed(){return this.replaySpeed}terminate(){null!==this.synchronizerWorker&&(this.synchronizerWorker.terminate(),this.synchronizerWorker=null);for(let e of this.dataSources)e.terminate()}getMode(){return s}async initDataSources(){try{const e=[];for(let t of this.dataSources){const i=await this.createDataSourceForWorker(t);e.push(i)}return this.synchronizerWorker=new y(new X.a),this.synchronizerWorker.postMessageWithAck({message:"init",dataSources:e,replaySpeed:this.replaySpeed,timerResolution:this.timerResolution,masterTimeRefreshRate:this.masterTimeRefreshRate,startTimestamp:this.getStartTimeAsTimestamp(),endTimestamp:this.getEndTimeAsTimestamp(),mode:this.getMode(),version:this.version(),topics:{data:this.getTopicId(),time:this.getTimeTopicId()}}).then(()=>{this.initialized=!0})}catch(e){console.error(e)}}async createDataSourceForWorker(e){const t={bufferingTime:e.properties.bufferingTime||0,timeOut:e.properties.timeOut||0,id:e.getId(),name:e.getName(),minTimestamp:e.getMinTimeAsTimestamp(),maxTimestamp:e.getMaxTimeAsTimestamp()};try{await e.setDataSynchronizer(this.timeSync),e.properties.replaySpeed=this.replaySpeed}catch(e){throw console.error("Cannot set the synchronizer to this DataSource",e),e}return t}timeChanged(){this.onTimeChanged(this.getMinTimeAsTimestamp(),this.getMaxTimeAsTimestamp(),this.getStartTimeAsTimestamp(),this.getEndTimeAsTimestamp())}async addDataSource(e){if(this.dataSources.push(e),this.computeMinMax(),this.initialized){e.setStartTime(this.getStartTimeAsIsoDate()),e.setEndTime(this.getEndTimeAsIsoDate());const t=await this.createDataSourceForWorker(e);return this.synchronizerWorker.postMessageWithAck({message:"add",dataSources:[t]}).then(async()=>{await this.isConnected()&&await e.connect(),this.onAddedDataSource(e.id),this.timeChanged()})}console.log(`DataSynchronizer not initialized yet, add DataSource ${e.id} as it`),this.timeChanged(),this.onAddedDataSource(e.id)}async removeDataSource(e){if(this.dataSources=this.dataSources.filter(t=>t.id!==e.getId()),0===this.dataSources.length&&await this.reset(),this.computeMinMax(),this.initialized)return await e.disconnect(),await e.removeDataSynchronizer(),this.synchronizerWorker.postMessageWithAck({message:"remove",dataSourceIds:[e.getId()],startTimestamp:this.getStartTimeAsTimestamp(),endTimestamp:this.getEndTimeAsTimestamp()}).then(()=>{this.timeChanged(),this.onRemovedDataSource(e.id)});console.log(`DataSynchronizer not initialized yet, remove DataSource ${e.id} as it`),await e.removeDataSynchronizer(),this.timeChanged(),this.onRemovedDataSource(e.id)}async push(e,t){if(this.synchronizerWorker)return this.synchronizerWorker.postMessageWithAck({type:"data",dataSourceId:e,data:t})}version(){return this.properties.version}async connect(){if(0!==this.dataSources.length){await this.checkInit();const e=await this.isConnected();return e||this.doConnect()}}async checkInit(){return a(this.init)||(this.init=this.initDataSources()),this.init}checkStartEndTime(){this.properties.startTimestamp||(this.properties.startTimestamp=this.properties.minTimestamp),this.properties.endTimestamp||(this.properties.endTimestamp=this.properties.maxTimestamp)}async doConnect(){this.checkStartEndTime(),await this.updateAlgo();for(let e of this.dataSources)await e.setTimeRange(this.getStartTimeAsIsoDate(),this.getEndTimeAsIsoDate(),this.getReplaySpeed(),!0);return this.synchronizerWorker.postMessageWithAck({message:"connect",version:this.version()})}async disconnect(){await this.reset();const e=[];for(let t of this.dataSources)e.push(t.disconnect());return Promise.all(e)}async setReplaySpeed(e){return this.replaySpeed=e,this.properties.replaySpeed=e,this.synchronizerWorker.postMessageWithAck({message:"replay-speed",replaySpeed:e})}async setTimeRange(e=this.getStartTimeAsIsoDate(),t=this.getEndTimeAsIsoDate(),i=this.getReplaySpeed(),s=!1){await this.disconnect(),this.incVersion(),this.replaySpeed=i,await this.setStartTime(e,!1),await this.setEndTime(t,!1);const r=[];for(let e of this.dataSources)r.push(e.setTimeRange(this.getStartTimeAsIsoDate(),this.getEndTimeAsIsoDate(),this.getReplaySpeed(),!1,this.getMode(),this.version()));return Promise.all(r)}setStartTimestamp(e){this.properties.startTimestamp=e}async updateAlgo(){for(let e of this.dataSources)e.setStartTimestamp(this.getStartTimeAsTimestamp()),e.setEndTimestamp(this.getEndTimeAsTimestamp());this.computeMinMax();const e=[];for(let t of this.dataSources){const i={bufferingTime:t.properties.bufferingTime||0,timeOut:t.properties.timeOut||0,id:t.getId(),name:t.getName(),minTimestamp:t.getMinTimeAsTimestamp(),maxTimestamp:t.getMaxTimeAsTimestamp()};e.push(i)}return this.synchronizerWorker.postMessageWithAck({message:"time-range",mode:this.getMode(),replaySpeed:this.getReplaySpeed(),startTimestamp:this.getStartTimeAsTimestamp(),endTimestamp:this.getEndTimeAsTimestamp(),version:this.version(),dataSources:e})}async updateProperties(e){for(let t of this.dataSources)t.updateProperties(e)}resetTimes(){this.computeMinMax()}async reset(){return await this.checkInit(),this.synchronizerWorker.postMessageWithAck({message:"reset"}).then(()=>this.resetTimes())}async getCurrentTime(){return this.synchronizerWorker.postMessageWithAck({message:"current-time"})}async isConnected(){return 0!==this.dataSources.length&&(await this.checkInit(),this.synchronizerWorker.postMessageWithAck({message:"is-connected"}).then(e=>e.data))}incVersion(){this.properties.version++}onTimeChanged(e,t,i,s){}onRemovedDataSource(e){}onAddedDataSource(e){}},H=i(6),Z=i.n(H);var $=class{constructor(e,t){this.bufferingTime=1e3,this.id=e.id||u(),this.dataSources=e.dataSources||[],this.timerResolution=e.timerResolution||5,this.masterTimeRefreshRate=e.masterTimeRefreshRate||250,this.initialized=!1,this.timeSync=t,this.properties={},this.properties.version=0}getId(){return this.id}getDataSources(){return this.dataSources}getTopicId(){return"data-synchronizer-"+this.id}getTimeTopicId(){return"data-synchronizer-time-"+this.id}setStartTimestamp(e){this.properties.startTimestamp=e}terminate(){null!==this.synchronizerWorker&&(this.synchronizerWorker.terminate(),this.synchronizerWorker=null);for(let e of this.dataSources)e.terminate()}getMode(){return r}async initDataSources(){try{const e=[];for(let t of this.dataSources){const i=await this.createDataSourceForWorker(t);e.push(i)}this.synchronizerWorker=new y(new Z.a),this.synchronizerWorker.postMessageWithAck({message:"init",dataSources:e,timerResolution:this.timerResolution,masterTimeRefreshRate:this.masterTimeRefreshRate,mode:r,version:this.version(),topics:{data:this.getTopicId(),time:this.getTimeTopicId()}}).then(()=>{this.initialized=!0})}catch(e){console.log(e)}}async createDataSourceForWorker(e){const t={bufferingTime:e.properties.bufferingTime||0,timeOut:e.properties.timeOut||0,id:e.id,name:e.name};try{await e.setDataSynchronizer(this.timeSync)}catch(e){throw console.error("Cannot set the synchronizer to this DataSource",e),e}return t}async addDataSource(e){if(this.dataSources.push(e),this.initialized){const t=await this.createDataSourceForWorker(e);this.synchronizerWorker.postMessageWithAck({message:"add",dataSources:[t]}).then(()=>{this.onAddedDataSource(e.id)})}else console.log(`DataSynchronizer not initialized yet, add DataSource ${e.id} as it`)}async removeDataSource(e){await e.removeDataSynchronizer(),this.dataSources=this.dataSources.filter(t=>t.id!==e.getId()),0===this.dataSources.length&&await this.reset(),this.initialized?this.synchronizerWorker.postMessageWithAck({message:"remove",dataSourceIds:[e.getId()]}).then(()=>{this.onRemovedDataSource(e.id)}):console.log(`DataSynchronizer not initialized yet, remove DataSource ${e.id} as it`)}async push(e,t){if(null!==this.synchronizerWorker)return this.synchronizerWorker.postMessageWithAck({type:"data",dataSourceId:e,data:t})}version(){return this.properties.version}async connect(){return await this.checkInit(),this.doConnect()}async checkInit(){return a(this.init)||(this.init=this.initDataSources()),this.init}async doConnect(){for(let e of this.dataSources)await e.connect();return this.synchronizerWorker.postMessageWithAck({message:"connect",version:this.version()})}async disconnect(){await this.reset();const e=[];for(let t of this.dataSources)e.push(t.disconnect());return Promise.all(e)}async updateProperties(e){for(let t of this.dataSources)t.updateProperties(e)}async reset(){return await this.checkInit(),this.synchronizerWorker.postMessageWithAck({message:"reset"})}async getCurrentTime(){return this.synchronizerWorker.postMessageWithAck({message:"current-time"})}async isConnected(){return 0!==this.dataSources.length&&(await this.checkInit(),this.synchronizerWorker.postMessageWithAck({message:"is-connected"}).then(e=>e.data))}setMinTime(e){}setMaxTime(e){}incVersion(){this.properties.version++}onTimeChanged(e,t){}onRemovedDataSource(e){}onAddedDataSource(e){}};var q=class{constructor(e){const t=e.id||u();this.dataSynchronizerReplay=new j({...e,id:t+"-replay"},this),this.dataSynchronizerRt=new $({...e,id:t+"-realtime"},this),this.broadcastChannels=[],this.setMode(e.mode||s).then(()=>{this.dataSynchronizer.onTimeChanged=(e,t,i,s)=>this.onTimeChanged(e,t,i,s),this.dataSynchronizer.onAddedDataSource=e=>this.onAddedDataSource(e),this.dataSynchronizer.onRemovedDataSource=e=>this.onRemovedDataSource(e)})}getId(){return this.id}async setMode(e){this.dataSynchronizer&&await this.dataSynchronizer.disconnect(),e===s?this.dataSynchronizer=this.dataSynchronizerReplay:e===r&&(this.dataSynchronizer=this.dataSynchronizerRt),this.id=this.dataSynchronizer.id;for(let e of this.broadcastChannels)e.close();this.initEventSubscription(),this.broadcastChannels=[];for(let t of this.dataSynchronizer.getDataSources())await t.setMode(e);this.onChangedMode(e)}initEventSubscription(){this.eventSubscriptionMap={},this.broadcastChannels.push(new BroadcastChannel(this.getTopicId()).onmessage=e=>{const t=e.data.type;if(t in this.eventSubscriptionMap)for(let i=0;i<this.eventSubscriptionMap[t].length;i++)this.eventSubscriptionMap[t][i](e.data)}),this.broadcastChannels.push(new BroadcastChannel(this.getTimeTopicId()).onmessage=e=>{e.data.type===b&&this.dataSynchronizer.setStartTimestamp(e.data.timestamp);const t=e.data.type;if(t in this.eventSubscriptionMap)for(let i=0;i<this.eventSubscriptionMap[t].length;i++)this.eventSubscriptionMap[t][i](e.data)})}subscribe(e,t){for(let i=0;i<t.length;i++)t[i]in this.eventSubscriptionMap||(this.eventSubscriptionMap[t[i]]=[]),this.eventSubscriptionMap[t[i]].push(e)}getDataSources(){return this.dataSynchronizer.getDataSources()}getTopicId(){return this.dataSynchronizer.getTopicId()}getTimeTopicId(){return this.dataSynchronizer.getTimeTopicId()}getStartTimeAsIsoDate(){return this.dataSynchronizer.getStartTimeAsIsoDate()}getStartTimeAsTimestamp(){return this.dataSynchronizer.getStartTimeAsTimestamp()}getEndTimeAsIsoDate(){return this.dataSynchronizer.getEndTimeAsIsoDate()}getEndTimeAsTimestamp(){return this.dataSynchronizer.getEndTimeAsTimestamp()}getMinTimeAsIsoDate(){return this.dataSynchronizer.getMinTimeAsIsoDate()}getMinTimeAsTimestamp(){return this.dataSynchronizer.getMinTimeAsTimestamp()}getMaxTimeAsIsoDate(){return this.dataSynchronizer.getMinTimeAsTimestamp()}getMaxTimeAsTimestamp(){return this.dataSynchronizer.getMaxTimeAsTimestamp()}getReplaySpeed(){return this.dataSynchronizer.getReplaySpeed()}terminate(){return this.dataSynchronizer.terminate()}getMode(){return this.dataSynchronizer.getMode()}async initDataSources(){return this.dataSynchronizer.initDataSources()}async addDataSource(e){return await this.dataSynchronizerRt.addDataSource(e),this.dataSynchronizerReplay.addDataSource(e)}async removeDataSource(e){return await this.dataSynchronizerRt.removeDataSource(e),this.dataSynchronizerReplay.removeDataSource(e)}async push(e,t){return this.dataSynchronizer.push(e,t)}version(){return this.dataSynchronizer.version()}async connect(){await this.dataSynchronizer.connect()}async checkInit(){return this.dataSynchronizer.checkInit()}async doConnect(){return this.dataSynchronizer.doConnect()}async disconnect(){return this.dataSynchronizer.disconnect()}async setReplaySpeed(e){return this.dataSynchronizer.setReplaySpeed(e)}async setTimeRange(e=this.getStartTimeAsIsoDate(),t=this.getEndTimeAsIsoDate(),i=this.getReplaySpeed(),s=!1){return this.dataSynchronizer.setTimeRange(e,t,i,s)}async updateProperties(e){return this.dataSynchronizer.updateProperties(e)}async reset(){return this.dataSynchronizer.reset()}async getCurrentTime(){return this.dataSynchronizer.getCurrentTime()}setMinTime(e){this.dataSynchronizer.setMinTime(e)}setMaxTime(e){this.dataSynchronizer.setMaxTime(e)}async isConnected(){return this.dataSynchronizer.isConnected()}minMaxChanged(e=!1){e&&(this.dataSynchronizerReplay.properties.startTimestamp=void 0,this.dataSynchronizerReplay.properties.endTimestamp=void 0),this.dataSynchronizerReplay.computeMinMax(),this.dataSynchronizerReplay.timeChanged()}onTimeChanged(e,t){}onRemovedDataSource(e){}onAddedDataSource(e){}onChangedMode(e){}};let K=new I("android-Video",{endpointUrl:"sensiasoft.net/sensorhub/sos",offeringID:"urn:android:device:060693280a28e015-sos",observedProperty:"http://sensorml.com/ont/swe/property/VideoFrame",startTime:"2015-02-16T07:57:59.447Z",endTime:"2015-02-16T08:09:00Z",mode:s,tls:!0,prefetchBatchDuration:5e3,timeShift:-16e3});new N({container:"video-mjpeg-container",css:"video-mjpeg",name:"Android Video",keepRatio:!0,showTime:!0,layers:[new G({dataSourceId:K.id,getFrameData:e=>e.videoFrame,getTimestamp:e=>e.timestamp})]});new q({masterTimeRefreshRate:250,replaySpeed:1,startTime:"2015-02-16T07:57:59.447Z",endTime:"2015-02-16T08:09:00Z",dataSources:[K]}).connect()}]);