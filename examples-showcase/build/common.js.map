{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../Toolkit/src/osh/osh-EventManager.js","webpack:///../Toolkit/src/osh/osh-EventMap.js","webpack:///../Toolkit/src/osh/ui/view/osh-UI-View.js","webpack:///../Toolkit/src/osh/datareceiver/osh-DataReceiver-DataSourceJSON.js","webpack:///../Toolkit/src/osh/ui/styler/osh-UI-StylerPointMarker.js","webpack:///../Toolkit/src/osh/ui/styler/osh-UI-Styler.js","webpack:///../Toolkit/src/osh/dataconnector/osh-DataConnector.js","webpack:///../Toolkit/src/osh/dataconnector/osh-DataConnector-Websocket.js","webpack:///../Toolkit/src/osh/dataconnector/osh-DataConnector-HttpAjaxConnector.js","webpack:///../Toolkit/src/osh/datareceiver/osh-DataReceiver-DataSource.js","webpack:///../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///../node_modules/css-loader/dist/runtime/api.js","webpack:///../node_modules/css-loader/dist/runtime/getUrl.js","webpack:///../Toolkit/src/osh/osh-Utils.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","eventMap","this","eventName","fnCallback","properties","fnCallbackArr","EventManager","fire","observe","divId","document","getElementById","addEventListener","DATA","SYNC_DATA","SELECT_VIEW","CONTEXT_MENU","SHOW_VIEW","CONNECT_DATASOURCE","DISCONNECT_DATASOURCE","DATASOURCE_UPDATE_TIME","CURRENT_MASTER_TIME","UAV_TAKEOFF","UAV_GOTO","UAV_LOOKAT","UAV_LAND","UAV_ORBIT","LOADING_START","LOADING_STOP","ADD_VIEW_ITEM","RESIZE","PTZ_SEND_REQUEST","View","parentElementDivId","viewItems","options","stylers","contextMenus","names","stylerToObj","stylerIdToStyler","lastRec","selectedDataSources","dataSources","id","dataSourceId","entityId","css","cssSelected","init","elementDiv","createElement","setAttribute","div","appendChild","container","body","hide","beforeAddingItems","addViewItem","show","style","display","handleEvents","that","EVENT","event","reset","setData","MutationObserver","mutations","forEach","mutation","attributeName","onResize","attributes","parentNode","removeChild","viewItem","styler","getId","contextmenu","ds","getDataSourcesIds","self","frozenDataSourceId","selected","selectedEntity","indexOf","dataSourcesIds","selectDataView","viewId","res","concat","Json","rec","String","fromCharCode","Uint8Array","Date","JSON","parse","getTime","url","protocol","endpointUrl","service","offeringID","foiURN","observedProperty","startTime","endTime","timeShift","toISOString","replaySpeed","jsonProperties","dataSourceToStylerMap","initEvents","funcName","func","isSet","dataSourceIds","handler","clear","fn","view","fnArr","timeStamp","super","location","orientation","heading","icon","iconAnchor","iconSize","label","labelColor","labelSize","labelOffset","color","defaultToTerrainElevation","checkFn","locationFunc","addFn","orientationFunc","iconFunc","labelFunc","labelColorFunc","labelSizeFunc","updateMarker","getUrl","blobURL","URL","createObjectURL","Blob","ws","onmessage","e","close","WebSocket","binaryType","byteLength","postMessage","onerror","toString","type","worker","Worker","onMessage","revokeObjectURL","terminate","disconnect","method","responseType","request","extraUrl","xmlhttp","XMLHttpRequest","timeout","open","onload","oEvent","response","ontimeout","console","log","send","setRequestHeader","onreadystatechange","readyState","status","onSuccess","responseText","onError","sendRequest","connected","initDataSource","syncMasterTime","bufferingTime","timeOut","connect","startsWith","connector","buildUrl","onData","parseTimeStamp","parseData","responseFormat","memo","isOldIE","Boolean","all","atob","getTarget","target","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","identifier","modulesToDom","list","idCountMap","identifiers","item","base","count","index","obj","media","sourceMap","references","updater","addStyle","insertStyleElement","nonce","keys","insert","Error","textStore","replaceText","replacement","filter","join","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","stringify","firstChild","singleton","singletonCounter","update","styleIndex","removeStyleElement","newObj","lastIdentifiers","newList","newLastIdentifiers","_i","_index","useSourceMap","map","content","cssMapping","sourceMapping","base64","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","default","test","hash","needQuotes","replace","Math","pow","isDefined","v","hasValue","assertDefined","letName","assertType","expectedType","assertString","assertPositive","assertNumber","assertObject","assertArray","Array","isArray","assertFunction","randomUUID","random","absoluteXposition","absoluteYposition","onMouseUpdate","pageX","pageY","isWebWorker"],"mappings":"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","file":"common.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// run deferred modules from other chunks\n \tcheckDeferredModules();\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n *\n * @constructor\n */\nimport EventMap from './osh-EventMap.js';\n\nconst eventMap = new EventMap();\n\nexport default class EventManager {\n\n    /**\n     *\n     * @param eventName\n     * @param properties\n     * @instance\n     * @memberof OSH.EventManager\n     */\n    static fire(eventName, properties) {\n        properties.name = eventName;\n        eventMap.fire('osh:' + eventName, properties);\n    }\n\n    /**\n     *\n     * @param eventName\n     * @param fnCallback\n     * @param id\n     * @instance\n     * @memberof OSH.EventManager\n     */\n    static observe(eventName, fnCallback) {\n        eventMap.observe('osh:' + eventName, fnCallback);\n    }\n\n    /**\n     *\n     * @param divId\n     * @param eventName\n     * @param fnCallback\n     * @instance\n     * @memberof OSH.EventManager\n     */\n    static observeDiv(divId, eventName, fnCallback) {\n        let elem = document.getElementById(divId);\n        // use native dom event listener\n        elem.addEventListener(eventName, fnCallback);\n    }\n\n    /**\n     * This part defines the events used INTO the API\n     * @const\n     * @type {{DATA: string, SYNC_DATA: string, SELECT_VIEW: string, CONTEXT_MENU: string, SHOW_VIEW: string, CONNECT_DATASOURCE: string, DISCONNECT_DATASOURCE: string, DATASOURCE_UPDATE_TIME: string, CURRENT_MASTER_TIME: string, UAV_TAKEOFF: string, UAV_GOTO: string, UAV_LOOKAT: string, UAV_LAND: string, UAV_ORBIT: string, LOADING_START: string, LOADING_STOP: string, ADD_VIEW_ITEM: string}}\n     */\n    static get EVENT() {\n        return {\n            DATA: \"data\",\n            SYNC_DATA: \"syncData\",\n            SELECT_VIEW: \"selectView\",\n            CONTEXT_MENU: \"contextMenu\",\n            SHOW_VIEW: \"showView\",\n            CONNECT_DATASOURCE: \"connectDataSource\",\n            DISCONNECT_DATASOURCE: \"disconnectDataSource\",\n            DATASOURCE_UPDATE_TIME: \"updateDataSourceTime\",\n            CURRENT_MASTER_TIME: \"currentMasterTime\",\n            UAV_TAKEOFF: \"uav:takeoff\",\n            UAV_GOTO: \"uav:goto\",\n            UAV_LOOKAT: \"uav:lookat\",\n            UAV_LAND: \"uav:land\",\n            UAV_ORBIT: \"uav:orbit\",\n            LOADING_START: \"loading:start\",\n            LOADING_STOP: \"loading:stop\",\n            ADD_VIEW_ITEM: \"addViewItem\",\n            RESIZE: \"resize\",\n            PTZ_SEND_REQUEST: \"ptzSendRequest\"\n        };\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\nimport {isDefined} from './osh-Utils.js';\n\nexport default class EventMap {\n\n    constructor() {\n        this.eventMap = {};\n    }\n\n    observe(eventName, fnCallback) {\n        if(!isDefined(eventName) || !isDefined(fnCallback)) {\n            return;\n        }\n        if(!(eventName in this.eventMap)) {\n            this.eventMap[eventName] = [];\n        }\n        this.eventMap[eventName].push(fnCallback);\n    }\n\n    fire(eventName, properties) {\n        if(!isDefined(eventName)) {\n            return;\n        }\n        if(eventName in this.eventMap) {\n            let fnCallbackArr = this.eventMap[eventName];\n            for(let i = 0; i < fnCallbackArr.length;i++){\n                // callback the properties to the current callback\n                fnCallbackArr[i](properties);\n            }\n        }\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n * @classdesc The abstract object to represent a view.\n * @class\n * @param {Object} parentElementDivId - The parent html element div id to attach/or create the view.\n * @param {string} viewItems - The list of view items\n * @param {string} options - The options\n * @abstract\n */\nimport {isDefined, randomUUID} from '../../osh-Utils.js';\nimport EventManager from '../../osh-EventManager.js';\n\nexport class View {\n    constructor(parentElementDivId, viewItems, options) {\n        // list of stylers\n        this.stylers = [];\n        this.contextMenus = [];\n        this.viewItems = [];\n        this.names = {};\n        this.stylerToObj = {};\n        this.stylerIdToStyler = {};\n        this.lastRec = {};\n        this.selectedDataSources = [];\n        this.dataSources = [];\n\n        //this.divId = divId;\n        this.id = \"view-\" + randomUUID();\n\n        this.dataSourceId = -1;\n        // sets dataSourceId\n        if (isDefined(options) && isDefined(options.dataSourceId)) {\n            this.dataSourceId = options.dataSourceId;\n        }\n\n        if (isDefined(options) && isDefined(options.entityId)) {\n            this.entityId = options.entityId;\n        }\n        this.css = \"\";\n\n        this.cssSelected = \"\";\n\n        if (isDefined(options) && isDefined(options.css)) {\n            this.css = options.css;\n        }\n\n        if (isDefined(options) && isDefined(options.cssSelected)) {\n            this.cssSelected = options.cssSelected;\n        }\n\n        // inits the view before adding the viewItem\n        this.init(parentElementDivId, viewItems, options);\n    }\n\n    /**\n     * Inits the view component.\n     * @param parentElementDivId The parent html element object to attach/create the view\n     * @param viewItems the list of items to add\n     * @param options [TODO]\n     * @memberof OSH.UI.View\n     */\n    init(parentElementDivId, viewItems, options) {\n        this.elementDiv = document.createElement(\"div\");\n        this.elementDiv.setAttribute(\"id\", this.id);\n        this.elementDiv.setAttribute(\"class\", this.css);\n        this.divId = this.id;\n\n        let div = document.getElementById(parentElementDivId);\n\n        if (!isDefined(div) || div === null) {\n            document.body.appendChild(this.elementDiv);\n            this.hide();\n            this.container = document.body;\n        } else {\n            div.appendChild(this.elementDiv);\n            this.container = div;\n        }\n\n        this.beforeAddingItems(options);\n\n        if (isDefined(viewItems)) {\n            for (let i = 0; i < viewItems.length; i++) {\n                this.addViewItem(viewItems[i]);\n            }\n        }\n\n        if (isDefined(options)) {\n            if (isDefined(options.show)) {\n                document.getElementById(this.divId).style.display = (options.show) ? \"block\" : \"none\";\n            }\n        }\n        this.handleEvents();\n\n        var that = this;\n        // observes the event associated to the dataSourceId\n        if (isDefined(options) && isDefined(options.dataSourceId)) {\n            EventManager.observe(EventManager.EVENT.DATA + \"-\" + options.dataSourceId, (event) => {\n                if (event.reset) {\n                    that.reset(); // on data stream reset\n                } else {\n                    that.setData(options.dataSourceId, event.data);\n                }\n            });\n        }\n\n        let observer = new MutationObserver((mutations) => {\n            mutations.forEach(function (mutation) {\n                // Was it the style attribute that changed? (Maybe a classname or other attribute change could do this too? You might want to remove the attribute condition) Is display set to 'none'?\n                if (mutation.attributeName === 'style') {\n                    that.onResize();\n\n                }\n            });\n        });\n\n        // Attach the mutation observer to blocker, and only when attribute values change\n        observer.observe(this.elementDiv, {attributes: true});\n    }\n\n    /**\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    hide() {\n        this.elementDiv.style.display = \"none\";\n    }\n\n    /**\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    onResize() {\n    }\n\n    /**\n     *\n     * @param divId\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    attachTo(divId) {\n        if (isDefined(this.elementDiv.parentNode)) {\n            // detach from its parent\n            this.elementDiv.parentNode.removeChild(this.elementDiv);\n        }\n        document.getElementById(divId).appendChild(this.elementDiv);\n        if (this.elementDiv.style.display === \"none\") {\n            this.elementDiv.style.display = \"block\";\n        }\n\n        this.onResize();\n    }\n\n    /**\n     *\n     * @param options\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    beforeAddingItems(options) {\n\n    }\n\n    /**\n     *\n     * @returns {string|*}\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    getId() {\n        return this.id;\n    }\n\n    /**\n     *\n     * @returns {string|*}\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    getDivId() {\n        return this.divId;\n    }\n\n    /**\n     *\n     * @param dataSourceId\n     * @param data\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    setData(dataSourceId, data) {\n    }\n\n    /**\n     * Show the view by removing display:none style if any.\n     * @param properties\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    show(properties) {\n    }\n\n    /**\n     *\n     * @param properties\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    shows(properties) {\n    }\n\n    /**\n     * Add viewItem to the view\n     * @param viewItem\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    addViewItem(viewItem) {\n        this.viewItems.push(viewItem);\n        if (viewItem.hasOwnProperty(\"styler\")) {\n            let styler = viewItem.styler;\n            this.stylers.push(styler);\n            if (viewItem.hasOwnProperty(\"name\")) {\n                this.names[styler.getId()] = viewItem.name;\n            }\n            styler.viewItem = viewItem;\n            styler.init(this);\n            this.stylerIdToStyler[styler.id] = styler;\n            if (viewItem.hasOwnProperty(\"contextmenu\")) {\n                this.contextMenus.push(viewItem.contextmenu);\n            }\n            //for(let dataSourceId in styler.dataSourceToStylerMap) {\n            let ds = styler.getDataSourcesIds();\n            for (let i = 0; i < ds.length; i++) {\n                let dataSourceId = ds[i];\n                // observes the data come in\n                let self = this;\n                (function (frozenDataSourceId) { // use a close here to no share the dataSourceId letiable\n\n                    EventManager.observe(EventManager.EVENT.DATA + \"-\" + frozenDataSourceId, (event) => {\n\n                        // skip data reset events for now\n                        if (event.reset) {\n                            return;\n                        }\n\n                        // we check selected dataSource only when the selected entity is not set\n                        let selected = false;\n                        if (isDefined(self.selectedEntity)) {\n                            selected = (viewItem.entityId === self.selectedEntity);\n                        } else {\n                            selected = (self.selectedDataSources.indexOf(frozenDataSourceId) > -1);\n                        }\n\n                        //TODO: maybe done into the styler?\n                        styler.setData(frozenDataSourceId, event.data, self, {\n                            selected: selected\n                        });\n                        self.lastRec[frozenDataSourceId] = event.data;\n                    });\n\n                    EventManager.observe(EventManager.EVENT.SELECT_VIEW, (event) => {\n                        // we check selected dataSource only when the selected entity is not set\n                        let selected = false;\n                        if (isDefined(event.entityId)) {\n                            selected = (viewItem.entityId === event.entityId);\n                        } else {\n                            selected = (event.dataSourcesIds.indexOf(frozenDataSourceId) > -1);\n                        }\n\n                        if (frozenDataSourceId in self.lastRec) {\n                            styler.setData(frozenDataSourceId, self.lastRec[frozenDataSourceId], self, {\n                                selected: selected\n                            });\n                        }\n                    });\n\n                })(dataSourceId); //passing the letiable to freeze, creating a new closure\n            }\n        }\n    }\n\n    /**\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    handleEvents() {\n        var that = this;\n        // observes the selected event\n        EventManager.observe(EventManager.EVENT.SELECT_VIEW, (event) =>\n            that.selectDataView(event.dataSourcesIds, event.entityId));\n\n        // observes the SHOW event\n        EventManager.observe(EventManager.EVENT.SHOW_VIEW, (event) => that.show(event));\n\n        EventManager.observe(EventManager.EVENT.ADD_VIEW_ITEM, (event) => {\n            if (isDefined(event.viewId) && event.viewId === that.id) {\n                that.addViewItem(event.viewItem);\n            }\n        });\n\n        EventManager.observe(EventManager.EVENT.RESIZE + \"-\" + this.divId, (event) =>\n            that.onResize());\n    }\n\n    /**\n     * Should be called after receiving osh:SELECT_VIEW event\n     * @param $super\n     * @param dataSourcesIds\n     * @param entitiesIds\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    selectDataView(dataSourcesIds, entityId) {\n        if (isDefined(this.dataSources)) {\n            this.selectedDataSources = dataSourcesIds;\n            // set the selected entity even if it is undefined\n            // this is handled by the setData function\n            this.selectedEntity = entityId;\n            for (let j = 0; j < this.dataSources.length; j++) {\n                this.setData(this.dataSources[j], this.lastRec[this.dataSources[j]]);\n            }\n        }\n    }\n\n    /**\n     *\n     * @returns {Array}\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    getDataSourcesId() {\n        let res = [];\n        if (this.dataSourceId !== -1) {\n            res.push(this.dataSourceId);\n        }\n\n        // check for stylers\n        for (let i = 0; i < this.viewItems.length; i++) {\n            let viewItem = this.viewItems[i];\n            if (viewItem.hasOwnProperty(\"styler\")) {\n                let styler = viewItem.styler;\n                res = res.concat(styler.getDataSourcesIds());\n            }\n        }\n\n        return res;\n    }\n\n    /**\n     * @instance\n     * @memberof OSH.UI.View\n     */\n    reset() {\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n * @classdesc This datasource provides generic parsing for JSON response.\n *\n * @class OSH.DataReceiver.JSON\n * @augments OSH.DataReceiver.DataSource\n * @example\n * let androidPhoneGpsDataSource = new OSH.DataReceiver.JSON(\"android-GPS\", {\n    protocol: \"ws\",\n    service: \"SOS\",\n    endpointUrl: \"sensiasoft.net:8181/sensorhub/sos\",\n    offeringID: \"urn:android:device:060693280a28e015-sos\",\n    observedProperty: \"http://sensorml.com/ont/swe/property/Location\",\n    startTime: \"2015-02-16T07:58:00Z\",\n    endTime: \"2015-02-16T08:09:00Z\",\n    replaySpeed: replayFactor+\"\",\n    syncMasterTime: true,\n    bufferingTime: 1000,\n    timeShift: -16000\n  });\n */\n\nimport DataSource from './osh-DataReceiver-DataSource.js';\n\nexport default class Json extends DataSource {\n\n    /**\n     * Extracts timestamp from the message. The timestamp corresponds to the 'time' attribute of the JSON object.\n     * @param {function} $super the parseTimeStamp super method\n     * @param {string} data the data to parse\n     * @returns {number} the extracted timestamp\n     * @memberof OSH.DataReceiver.JSON\n     * @instance\n     */\n    parseTimeStamp(data) {\n        let rec = String.fromCharCode.apply(null, new Uint8Array(data));\n        return new Date(JSON.parse(rec)['time']).getTime();\n    }\n\n    /**\n     * Extract data from the message. The data are corresponding to the whole list of attributes of the JSON object\n     * excepting the 'time' one.\n     * @param {function} $super the parseData super method\n     * @param {Object} data the data to parse\n     * @returns {Object} the parsed data\n     * @example\n     * {\n     *   location : {\n     *    lat:43.61758626,\n     *    lon: 1.42376557,\n     *    alt:100\n     *   }\n     * }\n     * @memberof OSH.DataReceiver.JSON\n     * @instance\n     */\n    parseData(data) {\n        let rec = JSON.parse(String.fromCharCode.apply(null, new Uint8Array(data)));\n\n        let result = {};\n\n        for (let key in rec) {\n            if (key !== 'time') {\n                result[key] = rec[key];\n            }\n        }\n        return result;\n    }\n\n    /**\n     * Builds the full url.\n     * @param {object} properties\n     * @param {string} properties.protocol the connector protocol\n     * @param {string} properties.endpointUrl the endpoint url\n     * @param {string} properties.service the service\n     * @param {string} properties.offeringID the offeringID\n     * @param {string} properties.observedProperty the observed property\n     * @param {string} properties.startTime the start time (ISO format)\n     * @param {string} properties.endTime the end time (ISO format)\n     * @param {number} properties.replaySpeed the replay factor\n     * @param {number} properties.responseFormat the response format (e.g video/mp4)\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     * @returns {string} the full url\n     */\n    buildUrl(properties) {\n        let url = \"\";\n\n        // adds protocol\n        url += properties.protocol + \"://\";\n\n        // adds endpoint url\n        url += properties.endpointUrl + \"?\";\n\n        // adds service\n        url += \"service=\" + properties.service + \"&\";\n\n        // adds version\n        url += \"version=2.0&\";\n\n        // adds request\n        url += \"request=GetResult&\";\n\n        // adds offering\n        url += \"offering=\" + properties.offeringID + \"&\";\n\n        // adds feature of interest urn\n        if (properties.foiURN && properties.foiURN !== '') {\n            url += 'featureOfInterest=' + properties.foiURN + '&';\n        }\n\n        // adds observedProperty\n        url += \"observedProperty=\" + properties.observedProperty + \"&\";\n\n        // adds temporalFilter\n        let startTime = properties.startTime;\n        let endTime = properties.endTime;\n        if (startTime !== \"now\" && this.timeShift !== 0) {\n            // HACK: don't do it for old Android dataset that is indexed differently\n            if (properties.offeringID !== \"urn:android:device:060693280a28e015-sos\") {\n                // apply time shift\n                startTime = new Date(Date.parse(startTime) - this.timeShift).toISOString();\n                endTime = new Date(Date.parse(endTime) - this.timeShift).toISOString();\n            }\n        }\n        url += \"temporalFilter=phenomenonTime,\" + startTime + \"/\" + endTime + \"&\";\n\n        if (properties.replaySpeed) {\n            // adds replaySpeed\n            url += \"replaySpeed=\" + properties.replaySpeed;\n        }\n\n        // adds responseFormat (mandatory)\n        url += \"&responseFormat=application/json\";\n\n        return url;\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\nimport {assertArray, assertObject, assertPositive, assertString, hasValue, isDefined} from \"../../osh-Utils.js\";\nimport Styler from \"./osh-UI-Styler.js\";\n\n/**\n * @classdesc\n * @class OSH.UI.Styler.PointMarker\n * @type {OSH.UI.Styler}\n * @augments OSH.UI.Styler\n * @example\n * let pointMarker = new OSH.UI.Styler.PointMarker({\n        location : {\n            x : 1.42376557,\n            y : 43.61758626,\n            z : 100\n        },\n        locationFunc : {\n            dataSourceIds : [androidPhoneGpsDataSource.getId()],\n            handler : function(rec) {\n                return {\n                    x : rec.lon,\n                    y : rec.lat,\n                    z : rec.alt\n                };\n            }\n        },\n        orientationFunc : {\n            dataSourceIds : [androidPhoneOrientationDataSource.getId()],\n            handler : function(rec) {\n                return {\n                    heading : rec.heading\n                };\n            }\n        },\n        icon : 'images/cameralook.png',\n        iconFunc : {\n            dataSourceIds: [androidPhoneGpsDataSource.getId()],\n            handler : function(rec,timeStamp,options) {\n                if(options.selected) {\n                    return 'images/cameralook-selected.png'\n                } else {\n                    return 'images/cameralook.png';\n                };\n            }\n        }\n    });\n */\nexport default class PointMarker extends Styler {\n\tconstructor(properties) {\n\t\tsuper(properties);\n\t\tthis.properties = properties;\n\t\tthis.location = null;\n\t\tthis.orientation = {heading:0};\n\t\tthis.icon = null;\n\t\tthis.iconAnchor = [16,16];\n\t\tthis.iconSize = [16,16];\n\t\tthis.label = null;\n\t\tthis.labelColor = \"#000000\";\n\t\tthis.labelSize = 16;\n\t\tthis.labelOffset = [0,0];\n\n\t\tthis.color = null;\n\t\tthis.defaultToTerrainElevation = false;\n\n\t\tthis.options = {};\n\n\t\tif(isDefined(properties.defaultToTerrainElevation)) {\n\t\t\tthis.defaultToTerrainElevation = properties.defaultToTerrainElevation;\n\t\t}\n\n\t\tif (hasValue(properties.location)) {\n\t\t\tassertObject(properties.location, \"location\");\n\t\t\tthis.location = properties.location;\n\t\t}\n\n\t\tif (hasValue(properties.orientation)) {\n\t\t\tassertObject(properties.orientation, \"orientation\");\n\t\t\tthis.orientation = properties.orientation;\n\t\t}\n\n\t\tif (hasValue(properties.icon)) {\n\t\t\tassertString(properties.icon, \"icon\");\n\t\t\tthis.icon = properties.icon;\n\t\t}\n\n\t\tif (hasValue(properties.iconAnchor)) {\n\t\t\tassertArray(properties.iconAnchor, \"iconAnchor\");\n\t\t\tthis.iconAnchor = properties.iconAnchor;\n\t\t}\n\n\t\tif (hasValue(properties.iconSize)) {\n\t\t\tassertArray(properties.iconSize, \"iconSize\");\n\t\t\tthis.iconSize = properties.iconSize;\n\t\t}\n\n\t\tif (hasValue(properties.label)) {\n\t\t\tassertString(properties.label, \"label\");\n\t\t\tthis.label = properties.label;\n\t\t}\n\n\t\tif (hasValue(properties.labelColor)) {\n\t\t\tassertString(properties.labelColor, \"labelColor\");\n\t\t\tthis.labelColor = properties.labelColor;\n\t\t}\n\n\t\tif (hasValue(properties.labelSize)) {\n\t\t\tassertPositive(properties.labelSize, \"labelSize\");\n\t\t\tthis.labelSize = properties.labelSize;\n\t\t}\n\n\t\tif (hasValue(properties.labelOffset)) {\n\t\t\tassertArray(properties.labelOffset, \"labelOffset\");\n\t\t\tthis.labelOffset = properties.labelOffset;\n\t\t}\n\n\t\tlet that = this;\n\t\tif (this.checkFn(\"locationFunc\")) {\n\t\t\tlet fn = function(rec,timeStamp,options) {\n\t\t\t\tthat.location = properties.locationFunc.handler(rec,timeStamp,options);\n\t\t\t};\n\t\t\tthis.addFn(properties.locationFunc.dataSourceIds,fn);\n\t\t}\n\n\t\tif (this.checkFn(\"orientationFunc\")) {\n\t\t\tlet fn = function(rec,timeStamp,options) {\n\t\t\t\tthat.orientation = properties.orientationFunc.handler(rec,timeStamp,options);\n\t\t\t};\n\t\t\tthis.addFn(properties.orientationFunc.dataSourceIds,fn);\n\t\t}\n\n\t\tif (this.checkFn(\"iconFunc\")) {\n\t\t\tlet fn = function(rec,timeStamp,options) {\n\t\t\t\tthat.icon = properties.iconFunc.handler(rec,timeStamp,options);\n\t\t\t};\n\t\t\tthis.addFn(properties.iconFunc.dataSourceIds,fn);\n\t\t}\n\n\t\tif (this.checkFn(\"labelFunc\")) {\n\t\t\tlet fn = function(rec,timeStamp,options) {\n\t\t\t\tthat.label = properties.labelFunc.handler(rec,timeStamp,options);\n\t\t\t};\n\t\t\tthis.addFn(properties.labelFunc.dataSourceIds,fn);\n\t\t}\n\n\t\tif (this.checkFn(\"labelColorFunc\")) {\n\t\t\tlet fn = function(rec,timeStamp,options) {\n\t\t\t\tthat.labelColor = properties.labelColorFunc.handler(rec,timeStamp,options);\n\t\t\t};\n\t\t\tthis.addFn(properties.labelColorFunc.dataSourceIds,fn);\n\t\t}\n\n\t\tif (this.checkFn(\"labelSizeFunc\")) {\n\t\t\tlet fn = function(rec,timeStamp,options) {\n\t\t\t\tthat.labelSize = properties.labelSizeFunc.handler(rec,timeStamp,options);\n\t\t\t};\n\t\t\tthis.addFn(properties.labelSizeFunc.dataSourceIds,fn);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param view\n\t * @memberof OSH.UI.Styler.PointMarker\n\t * @instance\n\t */\n\tinit(view) {\n\t\tsuper.init(view);\n\t\tif (isDefined(view) && this.location !== null) {\n\t\t\tview.updateMarker(this,0,{});\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param dataSourceId\n\t * @param rec\n\t * @param view\n\t * @param options\n\t * @memberof OSH.UI.Styler.PointMarker\n\t * @instance\n\t */\n\tsetData(dataSourceId,rec,view,options) {\n\t\tif (super.setData(dataSourceId,rec,view,options)) {\n\t\t\tif (isDefined(view) && this.location !== null) {\n\t\t\t\tview.updateMarker(this, rec.timeStamp, options);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\nimport {randomUUID} from \"../../osh-Utils.js\";\nimport {assertArray, assertFunction, hasValue, isDefined} from \"../../osh-Utils.js\";\nimport EventManager from \"../../osh-EventManager.js\";\n\n/**\n * @classdesc\n * @class OSH.UI.Styler\n * @abstract\n */\nexport default class Styler {\n    constructor(jsonProperties) {\n        this.properties = jsonProperties;\n        this.id = \"styler-\" + randomUUID();\n        this.dataSourceToStylerMap = {};\n        this.initEvents();\n    }\n\n    checkFn(funcName) {\n        let func = this.properties[funcName];\n        let isSet = hasValue(func);\n        if (isSet) {\n            assertArray(func.dataSourceIds, funcName + \".dataSourceIds\");\n            assertFunction(func.handler, funcName + \".handler\");\n        }\n        return isSet;\n    }\n\n    /**\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    initEvents() {\n        var that = this;\n        EventManager.observe(EventManager.EVENT.DATASOURCE_UPDATE_TIME, (event) => that.clear());\n    }\n\n    /**\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    clear() {\n    }\n\n    /**\n     * Gets the styler id.\n     * @returns {string} the styler id\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    getId() {\n        return this.id;\n    }\n\n    /**\n     * Selects the datasource contained into the list\n     * @param {Array} dataSourceIds the list of datasources\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    select(dataSourceIds) {\n    }\n\n    /**\n     * Adds a function\n     * @param {Array} dataSourceIds the list of datasources\n     * @param {function} fn the function to apply\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    addFn(dataSourceIds, fn) {\n        for (let i = 0; i < dataSourceIds.length; i++) {\n            let dataSourceId = dataSourceIds[i];\n            if (!isDefined(this.dataSourceToStylerMap[dataSourceId])) {\n                this.dataSourceToStylerMap[dataSourceId] = [];\n            }\n            this.dataSourceToStylerMap[dataSourceId].push(fn);\n        }\n    }\n\n    /**\n     *\n     * @param dataSourceId\n     * @param rec\n     * @param view\n     * @param options\n     * @returns {boolean}\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    setData(dataSourceId, rec, view, options) {\n        if (dataSourceId in this.dataSourceToStylerMap) {\n            let fnArr = this.dataSourceToStylerMap[dataSourceId];\n            for (let i = 0; i < fnArr.length; i++) {\n                fnArr[i](rec.data, rec.timeStamp, options);\n            }\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    /**\n     *\n     * @returns {Array}\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    getDataSourcesIds() {\n        let res = [];\n        for (let i in this.dataSourceToStylerMap) {\n            res.push(i);\n        }\n        return res;\n    }\n\n    /**\n     * @memberof OSH.UI.Styler\n     * @instance\n     */\n    init() {\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n * @classdesc The DataConnector is the abstract class used to create different connectors.\n * @constructor\n * @abstract\n * @param {string} url The full url used to connect to the data stream\n */\n\nimport {randomUUID} from '../osh-Utils.js';\n\nexport default class DataConnector {\n    constructor(url) {\n        this.url = url;\n        this.id = \"DataConnector-\" + randomUUID();\n    }\n\n    /**\n     * The data connector default id.\n     * @returns {string}\n     * @memberof OSH.DataConnector.DataConnector\n     * @instance\n     */\n    getId() {\n        return this.id;\n    }\n\n    /**\n     * The stream url.\n     * @returns {string}\n     * @memberof OSH.DataConnector.DataConnector\n     * @instance\n     */\n    getUrl() {\n        return this.url;\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n * @type {OSH.DataConnector.DataConnector}\n * @classdesc Defines the AjaxConnector to connect to a remote server by making AjaxRequest.\n * @class\n * @augments OSH.DataConnector.DataConnector\n * @example\n * let url = ...;\n * let connector = new OSH.DataConnector.WebSocketDataConnector(url);\n *\n * // connect\n * connector.connect();\n *\n * // disconnect\n * connector.disconnect();\n *\n * // close\n * connector.close();\n *\n */\n\nimport DataConnector from './osh-DataConnector.js';\nimport {isWebWorker} from '../osh-Utils.js';\n\nexport default class WebSocketDataConnector extends DataConnector {\n    /**\n     * Connect to the webSocket. If the system supports WebWorker, it will automatically creates one otherwise use\n     * the main thread.\n     * @instance\n     * @memberof OSH.DataConnector.WebSocketDataConnector\n     */\n    connect() {\n        let that = this;\n        if (!this.init) {\n            //creates Web Socket\n            if (isWebWorker()) {\n                let url = this.getUrl();\n                let blobURL = URL.createObjectURL(new Blob(['(',\n\n                        function () {\n                            let ws = null;\n                            self.onmessage = (e) => {\n                                if (e.data === \"close\") {\n                                    close();\n                                } else {\n                                    // is URL\n                                    init(e.data);\n                                }\n                            };\n\n                            function init(url) {\n                                ws = new WebSocket(url);\n                                ws.binaryType = 'arraybuffer';\n                                ws.onmessage = (event) => {\n                                    //callback data on message received\n                                    if (event.data.byteLength > 0) {\n                                        self.postMessage(event.data, [event.data]);\n                                    }\n                                };\n\n                                ws.onerror = (event) => {\n                                    ws.close();\n                                };\n                            }\n\n                            function close() {\n                                ws.close();\n                            }\n                        }.toString(), ')()'],\n                    {type: 'application/javascript'}));\n\n                this.worker = new Worker(blobURL);\n\n                this.worker.postMessage(url);\n                this.worker.onmessage = (e) => that.onMessage(e.data);\n\n                // Won't be needing this anymore\n                URL.revokeObjectURL(blobURL);\n            } else {\n                this.ws = new WebSocket(this.getUrl());\n                this.ws.binaryType = 'arraybuffer';\n                this.ws.onmessage = (event) => {\n                    //callback data on message received\n                    if (event.data.byteLength > 0) {\n                        that.onMessage(event.data);\n                    }\n                };\n\n                // closes socket if any errors occur\n                this.ws.onerror = (event) => that.ws.close();\n            }\n            this.init = true;\n        }\n    }\n\n    /**\n     * Disconnects the websocket.\n     * @instance\n     * @memberof OSH.DataConnector.WebSocketDataConnector\n     */\n    disconnect() {\n        if (isWebWorker() && this.worker !== null) {\n            this.worker.postMessage(\"close\");\n            this.worker.terminate();\n            this.init = false;\n        } else if (this.ws !== null) {\n            this.ws.close();\n            this.init = false;\n        }\n    }\n\n    /**\n     * The onMessage method used by the websocket to callback the data\n     * @param data the callback data\n     * @instance\n     * @memberof OSH.DataConnector.WebSocketDataConnector\n     */\n    onMessage(data) {\n    }\n\n    /**\n     * Closes the webSocket.\n     * @instance\n     * @memberof OSH.DataConnector.WebSocketDataConnector\n     */\n    close() {\n        this.disconnect();\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n * @type {OSH.DataConnector.DataConnector}\n * @classdesc Defines the AjaxConnector to connect to a remote server by making AjaxRequest.\n * @class\n * @augments OSH.DataConnector.DataConnector\n * @example\n * let request = ...;\n * let connector = new OSH.DataConnector.AjaxConnector(url);\n *\n * // handle onSuccess\n * connector.onSuccess = function(event) {\n *  // does something\n * }\n *\n * connector.onError = function(event) {\n *  // does something\n * }\n *\n * // send request\n * connector.sendRequest(request);\n *\n */\nimport DataConnector from './osh-DataConnector.js';\nimport {isDefined} from '../osh-Utils.js';\n\nexport default class AjaxConnector extends DataConnector {\n\n    constructor(url, properties) {\n        super(url);\n\n        this.method = \"POST\";\n        this.responseType = \"arraybuffer\";\n\n        if (isDefined(properties)) {\n            if (properties.method) {\n                this.method = properties.method;\n            }\n\n            if (properties.responseType) {\n                this.responseType = properties.responseType;\n            }\n        }\n    }\n\n    /**\n     * Sends the request to the defined server.\n     * @param request The Http request (as a String format)\n     * @memberof OSH.DataConnector.AjaxConnector\n     * @instance\n     */\n    sendRequest(request, extraUrl) {\n        let self = this;\n        let xmlhttp = new XMLHttpRequest();\n        xmlhttp.timeout = 60000;\n        if (request === null) {\n            if (isDefined(extraUrl)) {\n                xmlhttp.open(\"GET\", this.getUrl() + \"?\" + extraUrl, true);\n            } else {\n                xmlhttp.open(\"GET\", this.getUrl(), true);\n            }\n            xmlhttp.responseType = this.responseType;\n            xmlhttp.onload = (oEvent) => {\n                if (xmlhttp.response) {\n                    self.onMessage(xmlhttp.response);\n                }\n            };\n            xmlhttp.ontimeout = (e) => {\n                console.log(\"Timeout\");\n            };\n\n            xmlhttp.send(null);\n        } else {\n            xmlhttp.open(\"POST\", this.getUrl(), true);\n            xmlhttp.setRequestHeader('Content-Type', 'text/xml');\n\n            xmlhttp.send(request);\n\n            xmlhttp.onreadystatechange = () => {\n                if (xmlhttp.readyState < 4) {\n                    // while waiting response from server\n                } else if (xmlhttp.readyState === 4) {                // 4 = Response from server has been completely loaded.\n                    if (xmlhttp.status === 200 && xmlhttp.status < 300) { // http status between 200 to 299 are all successful\n                        self.onSuccess(xmlhttp.responseText);\n                    } else {\n                        self.onError(\"\");\n                    }\n                }\n            };\n        }\n    }\n\n    /**\n     * This is the callback method in case of getting error connection.\n     * @param event The error details\n     * @memberof OSH.DataConnector.AjaxConnector\n     * @instance\n     */\n    onError(event) {\n\n    }\n\n    /**\n     * This is the callback method in case of getting success connection.\n     * @param event\n     * @memberof OSH.DataConnector.AjaxConnector\n     * @instance\n     */\n    onSuccess(event) {\n\n    }\n\n    connect() {\n        this.sendRequest(null);\n    }\n}\n","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\n/**\n * @classdesc The DataSource is the abstract class used to create different datasources.\n * @class\n * @abstract\n * @param {string} name the datasource name\n * @param {Object} properties the datasource properties\n * @param {boolean} properties.timeShift fix some problem with some android devices with some timestamp shift to 16 sec\n * @param {boolean} properties.syncMasterTime defines if the datasource is synchronize with the others one\n * @param {number} properties.bufferingTime defines the time during the data has to be buffered\n * @param {number} properties.timeOut defines the limit time before data has to be skipped\n * @param {string} properties.protocol defines the protocol of the datasource. @see {@link OSH.DataConnector.DataConnector}\n *\n */\nimport {randomUUID, isDefined} from '../osh-Utils.js';\nimport WebSocketDataConnector from \"../dataconnector/osh-DataConnector-Websocket.js\";\nimport AjaxConnector from \"../dataconnector/osh-DataConnector-HttpAjaxConnector.js\";\nimport EventManager from \"../osh-EventManager.js\";\n\nexport default class DataSource {\n    constructor(name, properties) {\n        this.id = \"DataSource-\" + randomUUID();\n        this.name = name;\n        this.properties = properties;\n        this.timeShift = 0;\n        this.connected = false;\n\n        this.initDataSource(properties);\n    }\n\n    /**\n     * Inits the datasource with the constructor properties.\n     * @param properties\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     */\n    initDataSource(properties) {\n\n        if (isDefined(properties.timeShift)) {\n            this.timeShift = properties.timeShift;\n        }\n\n        if (isDefined(properties.syncMasterTime)) {\n            this.syncMasterTime = properties.syncMasterTime;\n        } else {\n            this.syncMasterTime = false;\n        }\n\n        if (isDefined(properties.bufferingTime)) {\n            this.bufferingTime = properties.bufferingTime;\n        }\n\n        if (isDefined(properties.timeOut)) {\n            this.timeOut = properties.timeOut;\n        }\n\n        if (!isDefined(properties.connect)) {\n            properties.connect = true;\n        }\n\n        // checks if type is WebSocket\n        if (properties.protocol.startsWith('ws')) {\n            this.connector = new WebSocketDataConnector(this.buildUrl(properties));\n            // connects the callback\n            this.connector.onMessage = this.onMessage.bind(this);\n        } else if (properties.protocol.startsWith('http')) {\n            this.connector = new AjaxConnector(this.buildUrl(properties));\n            this.connector.responseType = 'arraybuffer';\n            // connects the callback\n            this.connector.onMessage = this.onMessage.bind(this);\n        }\n    }\n\n    /**\n     * Disconnect the dataSource then the connector will be closed as well.\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     */\n    disconnect() {\n        this.connector.disconnect();\n        this.connected = false;\n\n        // send data reset event\n        EventManager.fire(EventManager.EVENT.DATA + \"-\" + this.id, {\n            dataSourceId: this.id,\n            reset: true\n        });\n    }\n\n    /**\n     * Connect the dataSource then the connector will be opened as well.\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     */\n    connect() {\n        this.connector.connect();\n        this.connected = true;\n    }\n\n    /**\n     * The callback which receives data.\n     * @callback\n     * @param data\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     */\n    onMessage(data) {\n        this.onData({\n            timeStamp: this.parseTimeStamp(data) + this.timeShift,\n            data: this.parseData(data)\n        });\n    }\n\n    /**\n     * The default timestamp parser\n     * @param data the full data message returned by the connector\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     * @returns {number} the formatted timestamp\n     */\n    parseTimeStamp(data) {\n        return new Date().getTime();\n    }\n\n    /**\n     * The default timestamp parser\n     * @param data the full data message returned by the connector\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     * @returns {String|Object|number|ArrayBuffer|*} data the formatted data\n     */\n    parseData(data) {\n        return data;\n    }\n\n    /**\n     * @param {Object} data the data object\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     * @example\n     * data is represented as\n     * data = {\n     *    timeStamp: timeStamp // number\n     *    data: data // data to render\n     * };\n     */\n    onData(data) {\n        EventManager.fire(EventManager.EVENT.DATA + \"-\" + this.id, {data: data});\n    }\n\n    /**\n     * Gets the datasource id.\n     * @returns {string} the datasource id\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     */\n    getId() {\n        return this.id;\n    }\n\n    /**\n     * Gets the datasource name.\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     * @returns {*}\n     */\n    getName() {\n        return this.name;\n    }\n\n    /**\n     * Builds the full url.\n     * @param {object} properties\n     * @param {string} properties.protocol the connector protocol\n     * @param {string} properties.endpointUrl the endpoint url\n     * @param {string} properties.service the service\n     * @param {string} properties.offeringID the offeringID\n     * @param {string} properties.observedProperty the observed property\n     * @param {string} properties.startTime the start time (ISO format)\n     * @param {string} properties.endTime the end time (ISO format)\n     * @param {number} properties.replaySpeed the replay factor\n     * @param {number} properties.responseFormat the response format (e.g video/mp4)\n     * @instance\n     * @memberof OSH.DataReceiver.DataSource\n     * @returns {string} the full url\n     */\n    buildUrl(properties) {\n        let url = \"\";\n\n        // adds protocol\n        url += properties.protocol + \"://\";\n\n        // adds endpoint url\n        url += properties.endpointUrl + \"?\";\n\n        // adds service\n        url += \"service=\" + properties.service + \"&\";\n\n        // adds version\n        url += \"version=2.0&\";\n\n        // adds request\n        url += \"request=GetResult&\";\n\n        // adds offering\n        url += \"offering=\" + properties.offeringID + \"&\";\n\n        // adds feature of interest urn\n        if (properties.foiURN && properties.foiURN !== '') {\n            url += 'featureOfInterest=' + properties.foiURN + '&';\n        }\n\n        // adds observedProperty\n        url += \"observedProperty=\" + properties.observedProperty + \"&\";\n\n        // adds temporalFilter\n        let startTime = properties.startTime;\n        let endTime = properties.endTime;\n        url += \"temporalFilter=phenomenonTime,\" + startTime + \"/\" + endTime + \"&\";\n\n        if (properties.replaySpeed) {\n            // adds replaySpeed\n            url += \"replaySpeed=\" + properties.replaySpeed;\n        }\n\n        // adds responseFormat (optional)\n        if (properties.responseFormat) {\n            url += \"&responseFormat=\" + properties.responseFormat;\n        }\n\n        return url;\n    }\n}\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = url && url.__esModule ? url.default : url;\n\n  if (typeof url !== 'string') {\n    return url;\n  } // If url is already wrapped in quotes, remove them\n\n\n  if (/^['\"].*['\"]$/.test(url)) {\n    // eslint-disable-next-line no-param-reassign\n    url = url.slice(1, -1);\n  }\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  } // Should url be wrapped?\n  // See https://drafts.csswg.org/css-values-3/#urls\n\n\n  if (/[\"'() \\t\\n]/.test(url) || options.needQuotes) {\n    return \"\\\"\".concat(url.replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n'), \"\\\"\");\n  }\n\n  return url;\n};","/***************************** BEGIN LICENSE BLOCK ***************************\n\n The contents of this file are subject to the Mozilla Public License, v. 2.0.\n If a copy of the MPL was not distributed with this file, You can obtain one\n at http://mozilla.org/MPL/2.0/.\n\n Software distributed under the License is distributed on an \"AS IS\" basis,\n WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n for the specific language governing rights and limitations under the License.\n\n Copyright (C) 2015-2017 Mathieu Dhainaut. All Rights Reserved.\n\n Author: Mathieu Dhainaut <mathieu.dhainaut@gmail.com>\n\n ******************************* END LICENSE BLOCK ***************************/\n\nexport const MAX_LONG = Math.pow(2, 53) + 1;\n\n\n/**\n *\n * @constructor\n */\n\n/**\n Global helper method to test if a letiable or object attribute is defined\n */\nexport function isDefined(v) {\n    return typeof (v) !== 'undefined';\n}\n\n\n/**\n Global helper method to test if a letiable or object attribute has a value,\n that is it is defined and non null\n */\nexport function hasValue(v) {\n    return isDefined(v) && v !== null;\n}\n\n/**\n Global helper method to test if a letiable or object attribute is of a particular type\n */\nexport function hasType(v, expectedType) {\n    let hasVal = hasValue(v);\n    return hasVal && typeof (v) === expectedType;\n}\n\n/**\n Global helper method to test if a letiable or object attribute is an object\n */\nexport function isObject(v, letName) {\n    return hasType(v, 'object', letName);\n}\n\n/**\n Global helper method to test if a letiable or object attribute is an array\n */\nexport function isArray(v) {\n    return isDefined(v) && Array.isArray(v);\n}\n\n/**\n Global helper method to test if a letiable or object attribute is a function\n */\nexport function isFunction(v, letName) {\n    return hasType(v, 'function', letName);\n}\n\n/**\n Assert that a letiable or object attribute is defined\n **/\nexport function assertDefined(v, letName = 'letiable') {\n    if (!isDefined(v)) {\n        throw letName + \" must be defined\";\n    }\n    return v;\n}\n\n/**\n Assert that a letiable or object attribute is defined and non-null\n **/\nexport function assertType(v, expectedType, letName = 'letiable') {\n    assertDefined(v, letName);\n    if (typeof (v) !== expectedType) {\n        throw letName + \" must be of type \" + expectedType;\n    }\n    return v;\n}\n\n/**\n Assert that a letiable or object attribute is a string\n **/\nexport function assertBoolean(v, letName) {\n    return assertType(v, 'boolean', letName);\n}\n\n/**\n Assert that a letiable or object attribute is a string\n **/\nexport function assertString(v, letName) {\n    return assertType(v, 'string', letName);\n}\n\n/**\n Assert that a letiable or object attribute is a number\n **/\nexport function assertNumber(v, letName) {\n    return assertType(v, 'number', letName);\n}\n\n/**\n Assert that a letiable or object attribute is a number\n **/\nexport function assertPositive(v, letName) {\n    assertNumber(v, letName);\n    if (v <= 0) {\n        throw letName + \" must be a positive number\";\n    }\n}\n\n/**\n Assert that a letiable or object attribute is an object\n **/\nexport function assertObject(v, letName) {\n    return assertType(v, 'object', letName);\n}\n\n/**\n Assert that a letiable or object attribute is an object\n **/\nexport function assertArray(v, letName = 'letiable') {\n    assertDefined(v, letName);\n    if (!Array.isArray(v)) {\n        throw letName + \" must be an array\";\n    }\n    return v;\n}\n\n/**\n Assert that a letiable or object attribute is a function\n **/\nexport function assertFunction(v, letName) {\n    return assertType(v, 'function', letName);\n}\n\n/**\n Assert that a letiable or object attribute is defined and non-null\n **/\nexport function assertHasValue(v, letName = 'letiable') {\n    assertDefined(v, letName);\n    if (!hasValue(v)) {\n        throw letName + \" must not be null\";\n    }\n    return v;\n}\n\n/**\n *\n * @returns {string}\n * @instance\n * @memberof OSH.Utils\n */\nexport function randomUUID() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        let r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n        return v.toString(16);\n    });\n}\n\n/**\n * This function stamps/embeds a UUID into an object and returns the UUID generated for it\n * @returns {string}\n * @instance\n * @memberof OSH.Utils\n */\nexport function stampUUID(obj) {\n    obj._osh_id = obj._osh_id || randomUUID();\n    return obj._osh_id;\n}\n\n//buffer is an ArrayBuffer object, the offset if specified in bytes, and the type is a string\n//corresponding to an OGC data type.\n//See http://def.seegrid.csiro.au/sissvoc/ogc-def/resource?uri=http://www.opengis.net/def/dataType/OGC/0/\n/**\n *\n * @param buffer\n * @param offset\n * @param type\n * @returns {*}\n * @instance\n * @memberof OSH.Utils\n */\nexport function ParseBytes(buffer, offset, type) {\n    let view = new DataView(buffer);\n\n    //Note: There exist types not listed in the map below that have OGC definitions, but no appropriate\n    //methods or corresponding types available for parsing in javascript. They are float128, float16, signedLong,\n    //and unsignedLong\n    let typeMap = {\n        double: function (offset) {\n            return {val: view.getFloat64(offset), bytes: 8};\n        },\n        float64: function (offset) {\n            return {val: view.getFloat64(offset), bytes: 8};\n        },\n        float32: function (offset) {\n            return {val: view.getFloat32(offset), bytes: 4};\n        },\n        signedByte: function (offset) {\n            return {val: view.getInt8(offset), bytes: 1};\n        },\n        signedInt: function (offset) {\n            return {val: view.getInt32(offset), bytes: 4};\n        },\n        signedShort: function (offset) {\n            return {val: view.getInt16(offset), bytes: 2};\n        },\n        unsignedByte: function (offset) {\n            return {val: view.getUint8(offset), bytes: 1};\n        },\n        unsignedInt: function (offset) {\n            return {val: view.getUint32(offset), bytes: 4};\n        },\n        unsignedShort: function (offset) {\n            return {val: view.getUint16(offset), bytes: 2};\n        },\n        //TODO: string-utf-8:\n    };\n    return typeMap[type](offset);\n}\n\n//This function recursivley iterates over the resultStructure to fill in\n//values read from data which should be an ArrayBuffer containing the payload from a websocket\n/**\n *\n * @param struct\n * @param data\n * @param offsetBytes\n * @returns {*}\n * @instance\n * @memberof OSH.Utils\n */\nexport function ReadData(struct, data, offsetBytes) {\n    let offset = offsetBytes;\n    for (let i = 0; i < struct.fields.length; i++) {\n        let currFieldStruct = struct.fields[i];\n        if (isDefined(currFieldStruct.type) && currFieldStruct.type !== null) {\n            let ret = ParseBytes(data, offset, currFieldStruct.type);\n            currFieldStruct.val = ret.val;\n            offset += ret.bytes;\n        } else if (isDefined(currFieldStruct.count) && currFieldStruct.count !== null) {\n            //check if count is a reference to another letiable\n            if (isNaN(currFieldStruct.count)) {\n                let id = currFieldStruct.count;\n                let fieldName = struct.id2FieldMap[id];\n                currFieldStruct.count = struct.findFieldByName(fieldName).val;\n            }\n            for (let c = 0; c < currFieldStruct.count; c++) {\n                for (let j = 0; j < currFieldStruct.fields.length; j++) {\n                    let field = JSON.parse(JSON.stringify(currFieldStruct.fields[j]));\n                    offset = ReadData(field, data, offset);\n                    currFieldStruct.val.push(field);\n                }\n            }\n        }\n    }\n    return offset;\n}\n\n/**\n *\n * @param resultStructure\n * @returns {{}}\n * @instance\n * @memberof OSH.Utils\n */\nexport function GetResultObject(resultStructure) {\n    //TODO: handle cases for nested arrays / matrix data types\n    let result = {};\n    for (let i = 0; i < resultStructure.fields.length; i++) {\n        if (isDefined(resultStructure.fields[i].count)) {\n            result[resultStructure.fields[i].name] = [];\n            for (let c = 0; c < resultStructure.fields[i].count; c++) {\n                let item = {};\n                for (let k = 0; k < resultStructure.fields[i].val[c].fields.length; k++) {\n                    item[resultStructure.fields[i].val[c].fields[k].name] = resultStructure.fields[i].val[c].fields[k].val;\n                }\n                result[resultStructure.fields[i].name].push(item);\n            }\n        } else {\n            result[resultStructure.fields[i].name] = resultStructure.fields[i].val;\n        }\n    }\n    return result;\n}\n\n/**\n *\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isOpera() {\n    return (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;\n}\n\n/**\n *\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isFirefox() {\n    return typeof InstallTrigger !== 'undefined';\n}\n\n/**\n *\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isSafari() {\n    return Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor') > 0;\n}\n\n/**\n *\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isIE() {\n    return /*@cc_on!@*/false || !!document.documentMode;\n}\n\n/**\n *\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isChrome() {\n    return !!window.chrome && !!window.chrome.webstore;\n}\n\n/**\n *\n * @returns {*|boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isBlink() {\n    return (isChrome || isOpera) && !!window.CSS;\n}\n\n//------- GET X,Y absolute cursor position ---//\nlet absoluteXposition = null;\nlet absoluteYposition = null;\n\ndocument.addEventListener('mousemove', onMouseUpdate, false);\ndocument.addEventListener('mouseenter', onMouseUpdate, false);\n\nfunction onMouseUpdate(e) {\n    absoluteXposition = e.pageX;\n    absoluteYposition = e.pageY;\n}\n\n/**\n *\n * @returns {*}\n * @instance\n * @memberof OSH.Utils\n */\nexport function getXCursorPosition() {\n    return absoluteXposition;\n}\n\n/**\n *\n * @returns {*}\n * @instance\n * @memberof OSH.Utils\n */\nexport function getYCursorPosition() {\n    return absoluteYposition;\n}\n\n/**\n *\n * @param a\n * @param b\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isArrayIntersect(a, b) {\n    return a.filter(function (element) {\n        return b.indexOf(element) > -1;\n    }).length > 0;\n}\n\n\n/**\n *\n * @param o\n * @returns {boolean}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isElement(o) {\n    return (\n        typeof HTMLElement === \"object\" ? o instanceof HTMLElement : //DOM2\n            o && typeof o === \"object\" && o !== null && o.nodeType === 1 && typeof o.nodeName === \"string\"\n    );\n}\n\n/**\n *\n * @returns {*}\n * @instance\n * @memberof OSH.Utils\n */\nexport function isWebWorker() {\n    return isDefined(Worker);\n}\n\n/**\n *\n * @param div\n * @instance\n * @memberof OSH.Utils\n */\nexport function takeScreenShot(div) {\n}\n\n/**\n * Remove a css class from a the div given as argument.\n * @param div the div to remove the class from\n * @param css the css class to remove\n * @instance\n * @memberof OSH.Utils\n */\nexport function removeCss(div, css) {\n    let divCss = div.className;\n    css = divCss.replace(css, \"\");\n    div.className = css;\n}\n\n\n/**\n * Add a css class to a the div given as argument.\n * @param div the div to add the class to\n * @param css the css class to add\n * @instance\n * @memberof OSH.Utils\n */\nexport function addCss(div, css) {\n    div.setAttribute(\"class\", div.className + \" \" + css);\n}\n\nexport function removeLastCharIfExist(value) {\n    if (!isDefined(undefined) || value === null || value.length === 0 || !value.endsWith(\"/\")) {\n        return value;\n    }\n\n    return value.substring(0, value.length - 1);\n}\n\n"],"sourceRoot":""}